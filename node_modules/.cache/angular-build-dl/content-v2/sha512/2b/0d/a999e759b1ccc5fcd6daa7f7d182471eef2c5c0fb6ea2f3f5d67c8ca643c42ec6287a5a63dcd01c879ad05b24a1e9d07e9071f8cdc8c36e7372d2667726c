!function(){"use strict";function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(s=i.key,r=void 0,"symbol"==typeof(r=function(t,e){if("object"!=typeof t||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s,"string"))?r:String(r)),i)}var s,r}(self.webpackChunkcalix=self.webpackChunkcalix||[]).push([[6628],{16628:function(e,a,i){i.d(a,{Q:function(){return w}});var s=i(11067),r=i(65424),n=i.n(r),o=i(40006),l=i.n(o),h=i(37716),c=i(7450),p=i(48483),d=i(51071),u=i(89097),g=i(38583),b=i(25317);function m(t,e){if(1&t&&(h.TgZ(0,"span",16),h._UZ(1,"i",17),h._uU(2),h.qZA()),2&t){var a=h.oxw(2);h.xp6(2),h.hij(" ",a.upRate," ")}}function f(t,e){if(1&t&&(h.TgZ(0,"span",18),h._UZ(1,"i",19),h._uU(2),h.qZA()),2&t){var a=h.oxw(2);h.xp6(2),h.hij(" ",a.downRate,"")}}function v(t,e){if(1&t&&h._UZ(0,"highcharts-chart",20),2&t){var a=h.oxw(2);h.Q6J("Highcharts",a.highcharts)("options",a.streamOptions)("callbackFunction",a.chartCallback)}}var C=function(t){return{"background-color":t}};function x(t,e){if(1&t){var a=h.EpF();h.TgZ(0,"div",1),h.TgZ(1,"div",2),h.TgZ(2,"div",3),h.TgZ(3,"div",4),h.TgZ(4,"span",5),h._uU(5),h.qZA(),h.TgZ(6,"a",6),h.NdJ("click",function(){return h.CHM(a),h.oxw().toggleUpStream()}),h._UZ(7,"span",7),h._uU(8),h.qZA(),h.TgZ(9,"a",8),h.NdJ("click",function(){return h.CHM(a),h.oxw().toggleDownStream()}),h._UZ(10,"span",7),h._uU(11),h.qZA(),h.TgZ(12,"span",9),h._uU(13),h.qZA(),h.qZA(),h.TgZ(14,"div",10),h.TgZ(15,"span",11),h.YNc(16,m,3,1,"span",12),h.YNc(17,f,3,1,"span",13),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(18,"div",14),h.YNc(19,v,1,3,"highcharts-chart",15),h.qZA(),h.qZA()}if(2&t){var i=h.oxw();h.xp6(4),h.s9C("title",i.chartName),h.xp6(1),h.hij(" ",i.chartName," "),h.xp6(2),h.Q6J("ngStyle",h.VKq(10,C,!0===i.isUpStreamVisible?"#0027FF":"grey")),h.xp6(1),h.hij(" ",i.language.up," "),h.xp6(2),h.Q6J("ngStyle",h.VKq(12,C,!0===i.isDownStreamVisible?"#00d0ff":"grey")),h.xp6(1),h.hij(" ",i.language.down," "),h.xp6(2),h.hij("",i.language.interval," 1 sec"),h.xp6(3),h.Q6J("ngIf",i.isUpStreamVisible),h.xp6(1),h.Q6J("ngIf",i.isDownStreamVisible),h.xp6(2),h.Q6J("ngIf",i.load)}}n()(s),l()(s);var y,w=((y=function(){function e(t,a,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.customTranslateService=t,this.dateUtilsService=a,this.websocketService=i,this.sso=r,this.load=!0,this.title="myHighchart",this.highcharts=s,this.yAxixTitle="",this.pageAvailable=!1,this.windowLen=5,this.selectedFilter=1,this.selectedLocation=[],this.selectedApplication=[],this.selectedRegion=[],this.selectedSystem=[],this.lastData=[0,0],this.chartData=[0,0],this.lastChartDataObj={},this.triggerReloadChart=!1,this.minutes=[5,10,15,20,25,30],this.msgLen=0,this.inc=0,this.isDownStreamVisible=!0,this.isUpStreamVisible=!0,this.conversions={bps:1,Kbps:1e3,Mbps:1e6,Gbps:1e9,Tbps:1e12,pps:1,Kpps:1e3,Mpps:1e6,Gpps:1e9,Tpps:1e12},this.reloadChart=!1,this.sizes={bps:1,Kbps:1e3,Mbps:1e6,Gbps:1e9,Tbps:1e12,pps:1,Kpps:1e3,Mpps:1e6,Gpps:1e9,Tpps:1e12}}var a,i,r;return a=e,(i=[{key:"ngOnInit",value:function(){var t=this;this.language=this.customTranslateService.defualtLanguage,this.language&&(this.pageAvailable=!0),this.customTranslateService.selectedLanguage.subscribe(function(e){t.language=e,s.setOptions({lang:{resetZoom:t.language.resetButton}})})}},{key:"ngOnChanges",value:function(t){this.chartName.toLowerCase(),t.data&&t.data.currentValue&&this.data&&(this.msgLen++,this.yAxixTitle=this.getYAxisTitle(t.data.currentValue),this.originalData=t.data.currentValue,this.bitsToSize(this.data[0]),this.bitsToSize(this.data[1]),this.chartName.toLowerCase(),this.currentData?(this.lastData=this.currentData,this.chartData=this.currentData):(this.lastData=[0,0],this.chartData=[0,0]),this.currentData=this.data),t.monitorId&&t.monitorId.currentValue&&(this.lastChartDataObj={},this.lastData=[0,0],this.currentData=[0,0],this.buildNewChart()),t.selectedFilter&&t.selectedFilter.currentValue&&(this.selectedFilter=t.selectedFilter.currentValue,"/cco/health/pon-utilization/realtime/realtime-basic"!=window.location.pathname&&this.websocketService.setWindowLen(this.selectedFilter),this.buildNewChart()),t.selectedLocation&&t.selectedLocation.currentValue&&(this.selectedLocation=t.selectedLocation.currentValue,this.buildNewChart()),t.selectedApplication&&t.selectedApplication.currentValue&&(this.selectedApplication=t.selectedApplication.currentValue,this.buildNewChart()),t.selectedRegion&&t.selectedRegion.currentValue&&(this.selectedRegion=t.selectedRegion.currentValue,this.buildNewChart()),t.selectedSystem&&t.selectedSystem.currentValue&&(this.selectedSystem=t.selectedSystem.currentValue,this.buildNewChart()),t.windowLen&&t.windowLen.currentValue&&this.data&&(this.time=1e3*this.dateUtilsService.getCurrentUtcTime(),this.triggerReloadChart=!1,this.load=!0,this.yAxixTitle="rate"===this.chartName.toLowerCase()?"bps":"pps",this.lastChartDataObj=this.history?this.history:{},Object.keys(this.lastChartDataObj).length?(this.lastData=this.data,this.chartData=this.data,this.rebuildData()):this.buildNewChart()),t.history&&t.history.currentValue&&(this.lastChartDataObj=this.history?this.history:{},Object.keys(this.lastChartDataObj).length?(this.lastData=this.data,this.chartData=this.data,this.rebuildData()):this.buildNewChart())}},{key:"chartCallback",value:function(t){}},{key:"toggleDownStream",value:function(){this.streamOptions.series[1].visible?(this.streamOptions.series[1].visible=!1,this.isDownStreamVisible=!1):(this.streamOptions.series[1].visible=!0,this.isDownStreamVisible=!0),this.rebuildData()}},{key:"toggleUpStream",value:function(){this.streamOptions.series[0].visible?(this.streamOptions.series[0].visible=!1,this.isUpStreamVisible=!1):(this.streamOptions.series[0].visible=!0,this.isUpStreamVisible=!0),this.rebuildData()}},{key:"ngOnDestroy",value:function(){this.streamOptions={},clearInterval(this.interval),clearInterval(this.interval2),this.interval=null,this.interval2=null}},{key:"transformData",value:function(t,e,a){this.chartName.toLowerCase(),(!e||!e.length)&&(e=[0,0]);for(var i=[],s=0;s<t.length;s++){var r=parseFloat(t[s])-parseFloat(e[s]);!parseFloat(t[s])&&!parseFloat(e[s])&&(a[s]=0);var n=r/15,o=parseFloat(a[s])+n;i.push(o)}return!i[0]&&!i[1]&&(t[0]||t[1])&&this.msgLen>2&&(i=t),i}},{key:"bitsToSize",value:function(t){var e=parseFloat(t),a="rate"===this.chartName.toLowerCase()?["bps","Kbps","Mbps","Gbps","Tbps"]:["pps","Kpps","Mpps","Gpps","Tpps"];if(0==e&&"rate"===this.chartName.toLowerCase())return"0 bps";if(0==e&&"packet"===this.chartName.toLowerCase())return"0 pps";var i=Math.floor(Math.log(e)/Math.log(1e3));return s.numberFormat(Math.abs(e/Math.pow(1e3,i)),2)+" "+a[i]}},{key:"removeLast3Chars",value:function(t){return t=(t=t.toString()).slice(0,-3),parseInt(t)}},{key:"removeOldKeys",value:function(){var t=Object.keys(this.lastChartDataObj),e=t.length;if(e>1800){for(var a=this.lastChartDataObj,i=e-1800,s=0;s<i;s++)delete a[t[s]];this.lastChartDataObj=a}}},{key:"getPacketRate",value:function(t){var e=t,a="rate"===this.chartName.toLowerCase()?["bps","Kbps","Mbps","Gbps","Tbps"]:["pps","Kpps","Mpps","Gpps","Tpps"];if(0==e&&"rate"===this.chartName.toLowerCase())return"0 bps";if(0==e&&"packet"===this.chartName.toLowerCase())return"0 pps";var i=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1e3,i))+" "+a[i]}},{key:"timezoneDetected",value:function(){var t,e=new Date("1/1/"+(new Date).getUTCFullYear()),a=1e4;for(t=0;t<12;t++)e.setUTCMonth(e.getUTCMonth()+1),a>-1*e.getTimezoneOffset()&&(a=-1*e.getTimezoneOffset());return parseInt(this.sso.getRealtimeDelay())}},{key:"rebuildData",value:function(){if(this.chartName.toLowerCase(),Object.keys(this.lastChartDataObj).length){var t,e=(new Date).getTime()+this.timezoneDetected();for(t=-299;t<=0;t+=1){var a=this.removeLast3Chars(e+1e3*t);void 0===this.lastChartDataObj[a]&&void 0!==this.lastChartDataObj[a-1]?this.lastChartDataObj[a]=this.lastChartDataObj[a-1]:void 0===this.lastChartDataObj[a]&&void 0!==this.lastChartDataObj[a-2]&&(this.lastChartDataObj[a]=this.lastChartDataObj[a-2])}this.reloadChart=!0,this.buildNewChart()}}},{key:"buildNewChart",value:function(){var t,e;this.time=1e3*this.dateUtilsService.getCurrentUtcTime(),this.streamOptions={};var a=this.timezoneDetected();(new Date).getTime();var i=this;this.streamOptions={chart:{type:"areaspline",zoomType:"x",height:200,events:{load:function(){var t="rate"===i.chartName.toLowerCase()?["bps","Kbps","Mbps","Gbps","Tbps"]:["pps","Kpps","Mpps","Gpps","Tpps"],e=this.series;i.interval=setInterval(function(){i.inc++;var r=i.transformData(i.currentData,i.lastData,i.chartData);i.chartData=r,r[0]||(r[0]=0),r[1]||(r[1]=0);var n=i.bitsToSize(r[0]),o=i.bitsToSize(r[1]),l=n.split(" "),h=o.split(" "),c=l[0],p=h[0],d=l[1]?l[1]:"rate"===i.chartName.toLowerCase()?"bps":"pps",u=h[1]?h[1]:"rate"===i.chartName.toLowerCase()?"bps":"pps",g="";if(d="undefined"==d?"rate"===i.chartName.toLowerCase()?"bps":"pps":d,u="undefined"==u?"rate"===i.chartName.toLowerCase()?"bps":"pps":u,"undefined"==(g=r[0]||r[1]?r[0]>r[1]?l[1]:h[1]:i.yAxixTitle?i.yAxixTitle:"rate"===i.chartName.toLowerCase()?"bps":"pps")&&(g=i.yAxixTitle?i.yAxixTitle:"rate"===i.chartName.toLowerCase()?"bps":"pps"),null!=g&&i.yAxixTitle!=g&&(r[0]||r[1]))return i.yAxixTitle=g,i.streamOptions.yAxis.title.text=i.yAxixTitle,void i.rebuildData();"string"==typeof g&&(i.yAxixTitle=g);var b=parseFloat(l[0]),m=parseFloat(h[0]);if((r[0]||r[1])&&r[0]<r[1]&&l[1]!==h[1]){var f=t.indexOf(l[1]),v=t.indexOf(h[1])-f;if(v)for(var C=v;C>0;C--)b/=1e3}if((r[0]||r[1])&&r[0]>r[1]&&l[1]!==h[1]){var x=t.indexOf(l[1])-t.indexOf(h[1]);if(x)for(var y=x;y>0;y--)m/=1e3}if(r){var w=(new Date).getTime()+a;parseFloat(s.numberFormat(Math.abs(b),2)),i.upRate="".concat(c," ").concat(d||("rate"===i.chartName.toLowerCase()?"bps":"pps")),parseFloat(s.numberFormat(Math.abs(m),2)),i.removeOldKeys(),i.downRate="".concat(p," ").concat(u||("rate"===i.chartName.toLowerCase()?"bps":"pps")),e[0].addPoint([w,b],!0,!0),e[1].addPoint([w,-m],!0,!0);var O=i.removeLast3Chars(w);if(i.lastChartDataObj[O]=[r[0],r[1],i.yAxixTitle,d,u],i.lastChartDataObj[O+1]=[r[0],r[1],i.yAxixTitle,d,u],e[0].chart.resetZoomButton&&e[0].xData.length){var D=e[0].chart.xAxis[0].getExtremes();e[0].chart.xAxis[0].setExtremes(D.min+1200,D.max+1200)}i.websocketService.shouldReflow&&e[0].chart.reflow()}},1e3)}}},time:{useUTC:!1},title:{text:""},colors:["#0027FF","#5ACFEA"],xAxis:{type:"datetime",tickPixelInterval:120},yAxis:{gridLineDashStyle:"longdash",opposite:!1,startOnTick:!1,endOnTick:!1,title:{text:this.yAxixTitle,margin:40},labels:{align:"left",x:-35,formatter:function(){return Math.abs(this.value)}}},credits:{enabled:!1},plotOptions:{areaspline:{lineWidth:1,marker:{enabled:!1},fillOpacity:.75},spline:{animation:!1,marker:{enabled:!1,radius:.9,lineWidth:.7}},series:{turboThreshold:1e6}},tooltip:{formatter:function(){var t=i.dateUtilsService.getLocalRealtimeDateFormat(this.point.x);return i.removeLast3Chars(this.point.x),"up"==this.series.name?"<b> ".concat(t,"  </b><br/>\n            ").concat(i.language.Upstream,": ").concat(s.numberFormat(Math.abs(this.point.y),2)," ").concat(i.yAxixTitle):"down"==this.series.name?"<b> ".concat(t,"  </b><br/>\n            ").concat(i.language.Downstream,": ").concat(s.numberFormat(Math.abs(this.point.y),2)," ").concat(i.yAxixTitle):void 0}},legend:{enabled:!1},exporting:{enabled:!1},series:[{name:(null===(t=null==i?void 0:i.language)||void 0===t?void 0:t.upStream)?i.language.upStream:"up",data:function(){var t,e=[],s=(new Date).getTime()+a;for(t=-299*i.selectedFilter;t<=0;t+=1){var r=s+1e3*t,n=i.removeLast3Chars(r),o=void 0!==i.lastChartDataObj[n]?i.lastChartDataObj[n][0]:i.lastChartDataObj[n-1]&&i.lastChartDataObj[n-1][0]?i.lastChartDataObj[n-1][0]:0;i.reloadChart&&!o&&(o=void 0!==i.lastChartDataObj[n-1]?i.lastChartDataObj[n-1][0]:i.lastChartDataObj[n-2]&&i.lastChartDataObj[n-2][0]?i.lastChartDataObj[n-2][0]:0),o&&(o/=i.sizes[i.yAxixTitle]),e.push({x:r,y:o})}return e}()},{name:(null===(e=null==i?void 0:i.language)||void 0===e?void 0:e.downStream)?i.language.downStream:"down",data:function(){var t,e=[],s=(new Date).getTime()+a;for(t=-299*i.selectedFilter;t<=0;t+=1){var r=s+1e3*t,n=i.removeLast3Chars(r),o=void 0!==i.lastChartDataObj[n]?i.lastChartDataObj[n][1]:i.lastChartDataObj[n-1]&&i.lastChartDataObj[n-1][1]?i.lastChartDataObj[n-1][1]:0;i.reloadChart&&!o&&(o=void 0!==i.lastChartDataObj[n-1]?i.lastChartDataObj[n-1][1]:i.lastChartDataObj[n-2]&&i.lastChartDataObj[n-2][1]?i.lastChartDataObj[n-2][1]:0),i.lastChartDataObj[n]&&(i.lastChartDataObj[n][1]=o),o&&(o/=i.sizes[i.yAxixTitle]),o*=-1,e.push({x:r,y:o})}return e}()}]},this.streamOptions.series[0].visible=this.isUpStreamVisible,this.streamOptions.series[1].visible=this.isDownStreamVisible,this.streamOptions=Object.assign({},this.streamOptions)}},{key:"bitsConversion",value:function(t){var e=!1;t<0&&(t=-t,e=!0);var a=parseFloat(t);if(0==a)return 0;var i=Math.floor(Math.log(a)/Math.log(1e3)),r=parseInt(s.numberFormat(Math.abs(a/Math.pow(1e3,i)),2));return e?-1*r:r}},{key:"getYAxisTitle",value:function(t){var e=t;return("rate"===this.chartName.toLowerCase()?["bps","Kbps","Mbps","Gbps","Tbps","pbps","ebps"]:["pps","Kpps","Mpps","Gpps","Tpps","ppps","epps"])[Math.floor(Math.log(e)/Math.log(1024))]}},{key:"removePrevious",value:function(){this.lastChartDataObj=Object.keys(this.lastChartDataObj).reduce(function(t,e){return t[e]=[0,0,"bps","bps","bps"],t},{}),this.lastData=[0,0],this.currentData=[0,0],this.rebuildData()}}])&&t(a.prototype,i),r&&t(a,r),Object.defineProperty(a,"prototype",{writable:!1}),e}()).\u0275fac=function(t){return new(t||y)(h.Y36(c.s),h.Y36(p.s),h.Y36(d.i),h.Y36(u.t6))},y.\u0275cmp=h.Xpm({type:y,selectors:[["app-stream-chart"]],inputs:{chartName:"chartName",yAxixTitle:"yAxixTitle",xAxix:"xAxix",data:"data",windowLen:"windowLen",selectedFilter:"selectedFilter",selectedLocation:"selectedLocation",selectedApplication:"selectedApplication",selectedRegion:"selectedRegion",selectedSystem:"selectedSystem",monitorId:"monitorId",time:"time",history:"history"},features:[h.TTD],decls:1,vars:1,consts:[["class","analytic-widget",4,"ngIf"],[1,"analytic-widget"],[1,"analytic-widget-header"],[1,"d-flex","justify-content-between"],[1,"mx-2"],[1,"widget-title",3,"title"],[1,"legend-label","toggle-up",3,"click"],[1,"legend-glyph",3,"ngStyle"],[1,"legend-label","toggle-down",3,"click"],[1,"interval"],[1,"mr-2",2,"text-align","right"],[1,"traffic-volume","monitor-status-normal"],["style","color: #0027FF;",4,"ngIf"],["style","color: #5ACFEA;",4,"ngIf"],[1,"analytic-widget-body"],["id","custom-mirrot-chart","style","width: 100%; display: block;",3,"Highcharts","options","callbackFunction",4,"ngIf"],[2,"color","#0027FF"],["aria-hidden","true",1,"fa","fa-arrow-up"],[2,"color","#5ACFEA"],["aria-hidden","true",1,"fa","fa-arrow-down"],["id","custom-mirrot-chart",2,"width","100%","display","block",3,"Highcharts","options","callbackFunction"]],template:function(t,e){1&t&&h.YNc(0,x,20,14,"div",0),2&t&&h.Q6J("ngIf",e.pageAvailable)},directives:[g.O5,g.PC,b.x],styles:[".highcharts-data-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{min-width:320px;max-width:800px;margin:1em auto}.highcharts-data-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{font-family:Verdana,sans-serif;border-collapse:collapse;border:1px solid #EBEBEB;margin:10px auto;text-align:center;width:100%;max-width:500px}.highcharts-data-table[_ngcontent-%COMP%]   caption[_ngcontent-%COMP%]{padding:1em 0;font-size:1.2em;color:#555}.highcharts-data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;padding:.5em}.highcharts-data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .highcharts-data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .highcharts-data-table[_ngcontent-%COMP%]   caption[_ngcontent-%COMP%]{padding:.5em}.highcharts-data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%], .highcharts-data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background:#f8f8f8}.highcharts-data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f1f7ff}.analytic-widget[_ngcontent-%COMP%]   .analytic-widget-header[_ngcontent-%COMP%]{display:block}.analytic-widget[_ngcontent-%COMP%]   .analytic-widget-header-cell[_ngcontent-%COMP%]{display:block;padding:5px 5px 5px 10px;position:relative}.analytic-widget[_ngcontent-%COMP%]   .legend-glyph[_ngcontent-%COMP%]{display:inline-block;margin-left:4px;margin-right:4px;width:10px;height:10px;border-radius:6px}.analytic-widget[_ngcontent-%COMP%]   .legend-label[_ngcontent-%COMP%]{display:inline-block;font-size:12px;padding-right:8px;margin-right:4px;border-color:#e1dfec;background-color:#eae8f3;border-width:1px;text-decoration:none;cursor:pointer}.analytic-widget[_ngcontent-%COMP%]   .interval[_ngcontent-%COMP%]{background:#efefef;padding:2px 6px;font-size:11px;border-radius:2px;color:#666;margin-right:15px}.analytic-widget[_ngcontent-%COMP%]   .traffic-volume.monitor-status-normal[_ngcontent-%COMP%]{margin-top:0;background-color:#eae8f3;border-color:#e1dfec;border-width:1px;font-size:12px}"]}),y)}}])}();