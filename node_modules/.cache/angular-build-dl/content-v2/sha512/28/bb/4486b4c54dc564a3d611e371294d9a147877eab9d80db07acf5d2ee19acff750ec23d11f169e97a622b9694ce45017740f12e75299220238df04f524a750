!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(a=i.key,s=void 0,"symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?s:String(s)),i)}var a,s}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkcalix=self.webpackChunkcalix||[]).push([[3771],{33771:function(t,i,a){a.r(i),a.d(i,{OrgAccessModule:function(){return E}});var s,r=a(38583),o=a(39895),c=a(37716),l=a(81100),g=a(83249),u=((s=function(){function t(n){e(this,t),this.router=n}return n(t,[{key:"ngOnInit",value:function(){}},{key:"reloadCurrentRoute",value:function(){var e=this,t=this.router.url;this.router.navigateByUrl("/",{skipLocationChange:!0}).then(function(){e.router.navigate([t])})}}]),t}()).\u0275fac=function(e){return new(e||s)(c.Y36(o.F0))},s.\u0275cmp=c.Xpm({type:s,selectors:[["app-org-access-header"]],decls:10,vars:0,consts:[[1,"row","my-3","px-0"],[1,"col-md-6"],["href","javascript:void(0)",3,"click"],["src","../../../assets/img/calix-Cloud-logo.svg"],[1,"d-flex","justify-content-end"],[1,"mx-3","pt-2"],[1,""]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"a",2),c.NdJ("click",function(){return t.reloadCurrentRoute()}),c._UZ(3,"img",3),c.qZA(),c.qZA(),c.TgZ(4,"div",1),c.TgZ(5,"div",4),c.TgZ(6,"div",5),c._UZ(7,"app-grid"),c.qZA(),c.TgZ(8,"div",6),c._UZ(9,"app-dd-menu"),c.qZA(),c.qZA(),c.qZA(),c.qZA())},directives:[l.M,g.z],styles:[""]}),s),d=a(30900),h=function(){var t=function(){function t(n){var i=this;e(this,t),this.customTranslateService=n,this.pageAvailable=!1,this.language=this.customTranslateService.defualtLanguage,this.language&&(this.pageAvailable=!0),this.customTranslateService.selectedLanguage.subscribe(function(e){i.language=e})}return n(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Y36(d.d))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-org-access-side-menu"]],decls:5,vars:1,consts:[[1,""],[1,"nav","flex-column","left-menu"],[1,"nav-item"],[1,"list-group-item","list-group-item-action","active"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"ul",1),c.TgZ(2,"li",2),c.TgZ(3,"a",3),c._uU(4),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(4),c.Oqu(t.language.orgsList))},styles:[".left-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{border-left:inherit!important;border-right:inherit!important;border-top:inherit!important;word-break:break-word;padding-right:10px}"]}),t}(),p=a(93702),f=function(){var t=function(){function t(){e(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-org-access-layout"]],decls:9,vars:0,consts:[[1,"maximus","sys-admin-cont"],[1,"row"],[1,"col-md-2","col-sm-3","col-xs-12","pr-2"],[1,"col-md-10","col-sm-9","col-xs-12"],["scrollTopId",""]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c._UZ(1,"app-org-access-header"),c.TgZ(2,"div",1),c.TgZ(3,"div",2),c._UZ(4,"app-org-access-side-menu"),c.qZA(),c.TgZ(5,"div",3,4),c._UZ(7,"router-outlet"),c.qZA(),c.qZA(),c.qZA(),c._UZ(8,"app-admin-footer"))},directives:[u,h,o.lC,p.c],styles:[""]}),t}(),v=a(23771),m=a(79765),b=a(92340),T=a(91841),Z=a(89097),A=a(5826),y=a(49342),O=a(39075);function q(e,t){1&e&&(c.TgZ(0,"div",18),c.TgZ(1,"div",19),c.TgZ(2,"div",20),c.TgZ(3,"span",21),c._uU(4,"Loading..."),c.qZA(),c.qZA(),c.qZA(),c.qZA())}function C(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"div",22),c.TgZ(1,"span",23),c._UZ(2,"img",24),c.qZA(),c.TgZ(3,"button",25),c.NdJ("click",function(){return c.CHM(n),c.oxw().closeAlert()}),c._UZ(4,"span"),c.qZA(),c._UZ(5,"div",26),c.qZA()}if(2&e){var i=c.oxw();c.xp6(5),c.Q6J("innerHtml",i.errorInfo,c.oJD)}}function _(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"div",27),c.TgZ(1,"span",28),c._UZ(2,"img",29),c.qZA(),c.TgZ(3,"button",25),c.NdJ("click",function(){return c.CHM(n),c.oxw().closeAlert()}),c._UZ(4,"span"),c.qZA(),c._UZ(5,"div",30),c.qZA()}if(2&e){var i=c.oxw();c.xp6(5),c.Q6J("innerHtml",i.successInfo,c.oJD)}}function w(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"tr",31),c.TgZ(1,"td"),c._uU(2),c.qZA(),c.TgZ(3,"td"),c._uU(4),c.qZA(),c.TgZ(5,"td"),c._uU(6),c.qZA(),c.TgZ(7,"td"),c._uU(8),c.qZA(),c.TgZ(9,"td",32),c.TgZ(10,"button",33),c.NdJ("click",function(){var e=c.CHM(n).$implicit;return c.oxw().gotoSecureAcccess(e.orgId)}),c.TgZ(11,"div",34),c.TgZ(12,"span"),c._UZ(13,"i",35),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&e){var i=t.$implicit,a=c.oxw();c.s9C("id",i._id),c.xp6(2),c.hij(" ",i.orgName?i.orgName:""," "),c.xp6(2),c.hij(" ",i.orgId?i.orgId:""," "),c.xp6(2),c.hij(" ","Read and Write"==a.checkType(i.type)?a.language["Read and Write"]:a.language["Read only"]," "),c.xp6(2),c.hij(" ",a.checkExpiry(i)," "),c.xp6(2),c.s9C("title",a.language.secureAccess)}}var x=a(91704),k=[{path:"",component:f,children:[{path:"",component:function(){var t=function(){function t(n,i,a,s,r,o,c){var l=this;e(this,t),this.http=n,this.router=i,this.customTranslateService=a,this.sso=s,this.service=r,this.commonOrgService=o,this.titleService=c,this.pageAvailable=!1,this.tableOptions={pagingType:"full_numbers",rowId:"id",lengthChange:!1,columnDefs:[{targets:[1,2,3,4],orderable:!1},{targets:[0],orderable:!0}],dom:"tipr",order:[0,"asc"],drawCallback:function(e){e.aoData.length<=e._iDisplayLength&&x(e.nTableWrapper).find("#".concat(e.sTableId,"_last")).addClass("disabled")}},this.orgsTableData=[],this.dtTrigger=new m.xQ,this.isRerender=!1,this.loading=!0,this.apps={cmc:!1,csc:!1,cco:!1,foundation:!1,orgAdmin:!1,calixAdmin:!1},this.errorInfo="",this.successInfo="",this.searchClearable=!1,this.isCSCLoggedOut=!1,this.language=this.customTranslateService.defualtLanguage,this.language&&(this.pageAvailable=!0),this.translateSubscribe=this.customTranslateService.selectedLanguage.subscribe(function(e){l.language=e,l.titleService.setTitle("".concat(l.language["Secured Access Organizations"]," - ").concat("systemAdministration"===g?l.language["System Administration"]:l.language.administration," - ").concat(l.language["Calix Cloud"])),l.dataAvailable=!1,l.loading=!0,l.isRerender=!0,l.setTableOptions("language")}),this.frTable=this.customTranslateService.fr;var g=this.sso.getRedirectModule(this.router.url);this.titleService.setTitle("".concat(this.language["Secured Access Organizations"]," - ").concat("systemAdministration"===g?this.language["System Administration"]:this.language.administration," - ").concat(this.language["Calix Cloud"]))}return n(t,[{key:"ngOnInit",value:function(){this.isCSCLoggedOut=this.sso.isCscLoggedOut(),this.isCSCLoggedOut&&(this.loading=!0,this.sso.setCscLoggedOut(!1)),this.tableLanguageOptions(),this.getOrgsData()}},{key:"ngOnDestroy",value:function(){this.dtTrigger.unsubscribe(),this.doSub&&this.doSub.unsubscribe(),this.dataSubscribe&&this.dataSubscribe.unsubscribe(),this.orgsDataSubscribe&&this.orgsDataSubscribe.unsubscribe(),this.translateSubscribe&&this.translateSubscribe.unsubscribe()}},{key:"getOrgsData",value:function(){var e=this,t="".concat(b.N.CALIX_ADMIN_BASE_URL,"org-access/username/").concat(this.sso.getUsername());this.dataSubscribe=this.http.get(t).subscribe(function(t){t&&(1==t.length&&"*"==t[0].orgId?e.getAllOrgsData(t[0]):(e.orgsTableData=t,e.setTableOptions(),e.renderTable(),e.loading=!1))},function(t){e.pageErrorHandle(t),e.setTableOptions(),e.renderTable(),e.loading=!1})}},{key:"getAllOrgsData",value:function(e){var t=this,n="".concat(b.N.CALIX_ADMIN_BASE_URL,"org-access/username/").concat(this.sso.getUsername(),"/_expand");this.orgsDataSubscribe=this.http.get(n).subscribe(function(e){e&&(t.orgsTableData=e,t.setTableOptions(),t.renderTable(),setTimeout(function(){t.loading=!1},1e3))},function(e){t.pageErrorHandle(e),t.setTableOptions(),t.renderTable(),t.loading=!1})}},{key:"renderTable",value:function(){this.isRerender?(this.rerender(),this.isRerender=!1):this.dtTrigger.next()}},{key:"rerender",value:function(){var e=this;this.dtElement.dtInstance.then(function(t){t.destroy(),e.dtTrigger.next()})}},{key:"setTableOptions",value:function(e){var t=this;this.tableOptions={pagingType:"full_numbers",rowId:"id",lengthChange:!1,dom:"tipr",columnDefs:[{targets:[1,2,3,4],orderable:!1},{targets:[0],orderable:!0}],order:[0,"asc"],drawCallback:function(e){e.aoData.length<=e._iDisplayLength&&x(e.nTableWrapper).find("#".concat(e.sTableId,"_last")).addClass("disabled")}},this.tableLanguageOptions(),e&&"language"==e?setTimeout(function(){t.dataAvailable=!0,t.renderTable(),setTimeout(function(){t.loading=!1},100)},100):setTimeout(function(){t.dataAvailable=!0},500)}},{key:"gotoSecureAcccess",value:function(e){var t=this;this.loading=!0,this.doSub=this.sso.getAuthToken({client_secret:b.N.X_CALIX_SECURE_CLIENTID,orgId:e},"secure_access").subscribe(function(e){if(t.loading=!1,e.access_token){if(!e.entitlements.length&&"grantor_orgs"!==e.landingPage)return void t.showErrorMessage(t.language["Error: No Valid Entitlement"]);if(!t.checkAccessTime(e))return void t.showErrorMessage(t.language["Access Denied"]);t.sso.setSecureAccessStartTime(e.beginTime),t.sso.setSecureAccessEndTime(e.endTime),t.sso.setCSCLoggedIn(!1),t.sso.setLoginInfo(e),t.sso.setSecureAccess(!0),t.sso.setSecureAccessLoginData(e),t.showApps(),e.landingPage&&"grantor_orgs"==e.landingPage.toLowerCase()?t.router.navigate(["federated-dashboard"]):e.landingPage&&"cco"==e.landingPage.toLowerCase()&&t.apps.cco?t.router.navigate(["/cco"]):e.landingPage&&"cmc"==e.landingPage.toLowerCase()&&t.apps.cmc?t.router.navigate(["/marketing"]):e.landingPage&&("csc"==e.landingPage.toLowerCase()||"main page"==e.landingPage.toLowerCase())&&t.apps.csc?t.router.navigate(["/support"]):e.landingPage&&"DC"==e.landingPage.toLowerCase()&&t.apps.foundation?t.router.navigate(["/cco-foundation"]):t.gotoDP()}},function(e){t.loading=!0})}},{key:"showApps",value:function(){this.apps=this.sso.showApps()}},{key:"gotoDP",value:function(){var e=this.sso.getEntitlementsArr(),t=this.sso.getValidEntitlements(),n="";if(e)for(var i=0;i<e.length;i++)if(t[e[i]]){n=t[e[i]];break}this.router.navigate(n?[n]:["/no-entitlements"])}},{key:"checkType",value:function(e){return this.service.checkType(e)}},{key:"checkExpiry",value:function(e){return this.service.checkExpiryOrgAccess(e)}},{key:"processAllOrgs",value:function(e,t){return e.forEach(function(e){e.beginTime=t.beginTime,e.endTime=t.endTime,e.orgId=e.id,e.orgName=e.name,e.type=t.type}),e}},{key:"hideSearch",value:function(){setTimeout(function(){x("#organizations-list .dataTables_wrapper .dataTables_filter").css("display","none"),x("#organizations-list .dataTables_wrapper .dataTables_length").css("display","none")},100)}},{key:"search",value:function(e){this.searchClearable=!!e.length,this.dtElement.dtInstance.then(function(t){t.search(e).draw()})}},{key:"onSearchClearing",value:function(e){this.searchClearable=!1,e.value="",this.dtElement.dtInstance.then(function(t){t.search(e.value).draw()})}},{key:"checkAccessTime",value:function(e){if(!e.beginTime&&!e.endTime)return!1;var t=this.service.roundOffTimestamp(e.beginTime),n=(new Date).getTime();if(-1==e.endTime){if(n>=t)return!0}else{var i=this.service.roundOffTimestamp(e.endTime);if(n>=t&&n<i)return!0}return!1}},{key:"tableLanguageOptions",value:function(){"fr"==this.language.fileLanguage?this.tableOptions.language=this.frTable:"es"==this.language.fileLanguage?this.tableOptions.language=this.customTranslateService.es:"de_DE"==this.language.fileLanguage?this.tableOptions.language=this.customTranslateService.de_DE:"en"==this.language.fileLanguage&&this.tableOptions.language&&delete this.tableOptions.language}},{key:"closeAlert",value:function(){this.error=!1,this.success=!1}},{key:"showErrorMessage",value:function(e){this.closeAlert(),this.errorInfo=e,this.error=!0,this.commonOrgService.pageScrollTop()}},{key:"pageErrorHandle",value:function(e){this.errorInfo=401==e.status?this.language["Access Denied"]:this.commonOrgService.pageErrorHandle(e),this.closeAlert(),this.error=!0,this.commonOrgService.pageScrollTop()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Y36(T.eN),c.Y36(o.F0),c.Y36(d.d),c.Y36(Z.t6),c.Y36(A.q),c.Y36(y.v),c.Y36(O.Dx))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-org-access"]],viewQuery:function(e,t){var n;(1&e&&c.Gf(v.G,5),2&e)&&(c.iGM(n=c.CRH())&&(t.dtElement=n.first))},decls:35,vars:15,consts:[[1,"container","position-relative","mh-65"],["class","loader",4,"ngIf"],["class","w-100 alert alert-danger  fade show",4,"ngIf"],["class","w-100 alert alert-success fade show",4,"ngIf"],[1,"row","my-3"],[1,"col-md-12"],[1,"ccl-title"],[1,"col-md-4","offset-md-8","pr-0"],[1,"text-right","flat-right"],[1,"row"],[1,"ccl-form"],["type","text","id","exampleInputEmail1","aria-describedby","emailHelp",1,"ccl-input",3,"placeholder","keyup","search"],["searchBar",""],[1,"clear-icon",3,"hidden","click"],["src","assets/img/close-icon.svg"],[1,"col-md-12",3,"hidden"],["id","org-secure-access","width","100%","datatable","",1,"row-border","hover","table-alter",3,"dtOptions","dtTrigger"],[3,"id",4,"ngFor","ngForOf"],[1,"loader"],[1,"d-flex","justify-content-center"],[1,"spinner-border","text-primary"],[1,"sr-only"],[1,"w-100","alert","alert-danger","fade","show"],[1,"error-img"],["src","./assets/img/ic_error-36px.svg"],["type","button",1,"close",3,"click"],[1,"d-inline-flex",3,"innerHtml"],[1,"w-100","alert","alert-success","fade","show"],[1,"success-img"],["src","./assets/img/success-icon.svg"],[3,"innerHtml"],[3,"id"],[1,"actions"],["id","org-detail-btn",3,"title","click"],[1,"org-profile-icon"],[1,"fas","fa-user"]],template:function(e,t){if(1&e){var n=c.EpF();c.TgZ(0,"div",0),c.YNc(1,q,5,0,"div",1),c.YNc(2,C,6,1,"div",2),c.YNc(3,_,6,1,"div",3),c.TgZ(4,"div",4),c.TgZ(5,"div",5),c.TgZ(6,"div",6),c._uU(7),c.qZA(),c.qZA(),c.qZA(),c.TgZ(8,"div",4),c.TgZ(9,"div",7),c.TgZ(10,"div",8),c.TgZ(11,"div",9),c.TgZ(12,"div",5),c.TgZ(13,"div",10),c.TgZ(14,"input",11,12),c.NdJ("keyup",function(e){return t.search(e.target.value)})("search",function(e){return t.search(e.target.value)}),c.qZA(),c.TgZ(16,"span",13),c.NdJ("click",function(){c.CHM(n);var e=c.MAs(15);return t.onSearchClearing(e)}),c._UZ(17,"img",14),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(18,"div",4),c.TgZ(19,"div",15),c.TgZ(20,"table",16),c.TgZ(21,"thead"),c.TgZ(22,"tr"),c.TgZ(23,"th"),c._uU(24),c.qZA(),c.TgZ(25,"th"),c._uU(26),c.qZA(),c.TgZ(27,"th"),c._uU(28),c.qZA(),c.TgZ(29,"th"),c._uU(30),c.qZA(),c.TgZ(31,"th"),c._uU(32),c.qZA(),c.qZA(),c.qZA(),c.TgZ(33,"tbody"),c.YNc(34,w,14,6,"tr",17),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}2&e&&(c.xp6(1),c.Q6J("ngIf",t.loading),c.xp6(1),c.Q6J("ngIf",t.error),c.xp6(1),c.Q6J("ngIf",t.success),c.xp6(4),c.Oqu(t.language.secureAccessOrganizationList),c.xp6(7),c.s9C("placeholder",t.language.searchOrganizations),c.xp6(2),c.Q6J("hidden",!t.searchClearable),c.xp6(3),c.Q6J("hidden",!t.dataAvailable),c.xp6(1),c.Q6J("dtOptions",t.tableOptions)("dtTrigger",t.dtTrigger),c.xp6(4),c.Oqu(t.language.organizationName),c.xp6(2),c.Oqu(t.language.orgId),c.xp6(2),c.Oqu(t.language.accesstype),c.xp6(2),c.Oqu(t.language.duration),c.xp6(2),c.Oqu(t.language.Action),c.xp6(2),c.Q6J("ngForOf",t.orgsTableData))},directives:[r.O5,v.G,r.sg],styles:[".org-profile-icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:#ff8066}.clear-icon[_ngcontent-%COMP%]{position:absolute;right:30px;top:5px;cursor:pointer;width:12px}#org-detail-btn[_ngcontent-%COMP%]{background-color:transparent;font-size:13.5px;border:none}td.actions[_ngcontent-%COMP%]{white-space:nowrap}"]}),t}(),pathMatch:"full",data:{title:"Calix Cloud - Secure Access"}}]}],S=function(){var t=n(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[o.Bz.forChild(k)],o.Bz]}),t}(),I=a(23830),L=a(35555),E=function(){var t=n(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[r.ez,S,v.T,I.o,L.SysAdminModule]]}),t}()}}])}();