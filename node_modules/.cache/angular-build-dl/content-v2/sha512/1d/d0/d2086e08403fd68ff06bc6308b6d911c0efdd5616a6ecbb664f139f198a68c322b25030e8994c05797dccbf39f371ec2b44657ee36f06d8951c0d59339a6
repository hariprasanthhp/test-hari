"use strict";(self.webpackChunkcalix=self.webpackChunkcalix||[]).push([[5634],{55634:function(o,l,n){n.d(l,{C:function(){return y}});var i=n(25917),t=n(35758),e=n(5304),s=n(92340),r=n(37716),d=n(7450),u=n(91841),a=n(39895),g=n(49342),c=n(21693),v=n(39075),f=n(38583),h=n(1570);function m(o,l){if(1&o&&(r.TgZ(0,"div",15),r.TgZ(1,"div",16),r.TgZ(2,"div",17),r._uU(3),r.qZA(),r.TgZ(4,"div",18),r.TgZ(5,"a",19),r._UZ(6,"img",20),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&o){const o=r.oxw(2);r.xp6(2),r.s9C("title",null==o.workflowObj?null:o.workflowObj.name),r.xp6(1),r.hij(" ",null==o.workflowObj?null:o.workflowObj.name," ")}}function p(o,l){if(1&o&&(r.TgZ(0,"div",6),r.TgZ(1,"div",7),r.TgZ(2,"span",8),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",7),r.TgZ(5,"span",8),r._uU(6),r.qZA(),r.qZA(),r.TgZ(7,"div",7),r.TgZ(8,"span",8),r._uU(9),r.qZA(),r.qZA(),r.qZA()),2&o){const o=r.oxw(2);r.xp6(3),r.Oqu(o.language["All Regions"]),r.xp6(3),r.Oqu(o.language["All Locations"]),r.xp6(3),r.Oqu(o.language["All Systems"]?o.language["All Systems"]:"All Systems")}}function O(o,l){if(1&o&&(r.TgZ(0,"div"),r.TgZ(1,"span",8),r._uU(2),r.qZA(),r.qZA()),2&o){const o=r.oxw().$implicit,l=r.oxw().$implicit,n=r.oxw(2);r.xp6(2),r.hij("",null==n.geoInfo[null==l?null:l.key][null==o?null:o.key]?null:n.geoInfo[null==l?null:l.key][null==o?null:o.key].length," System(s)")}}function w(o,l){if(1&o&&(r.TgZ(0,"div"),r.TgZ(1,"span",8),r._uU(2),r.qZA(),r.qZA()),2&o){const o=l.$implicit;r.xp6(2),r.Oqu(o)}}function b(o,l){if(1&o&&(r.TgZ(0,"div",9),r.TgZ(1,"div",10),r.TgZ(2,"div"),r.TgZ(3,"span",8),r._uU(4),r.qZA(),r.qZA(),r.qZA(),r.TgZ(5,"div",10),r.YNc(6,O,3,1,"div",0),r.YNc(7,w,3,1,"div",22),r.qZA(),r.qZA()),2&o){const o=l.$implicit,n=r.oxw().$implicit,i=r.oxw(2);r.xp6(4),r.Oqu(i.loctionsObj[null==o?null:o.key]),r.xp6(2),r.Q6J("ngIf",-1==(null==i.geoInfo[null==n?null:n.key][null==o?null:o.key]?null:i.geoInfo[null==n?null:n.key][null==o?null:o.key].indexOf("All Systems"))),r.xp6(1),r.Q6J("ngForOf",i.geoInfo[null==n?null:n.key][null==o?null:o.key])}}function Z(o,l){if(1&o&&(r.TgZ(0,"div",6),r.TgZ(1,"div",7),r.TgZ(2,"span",8),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",3),r.YNc(5,b,8,3,"div",21),r.ALo(6,"keyvalue"),r.qZA(),r.qZA()),2&o){const o=l.$implicit,n=r.oxw(2);r.xp6(3),r.Oqu(n.regionsObj[null==o?null:o.key]),r.xp6(2),r.Q6J("ngForOf",r.lcZ(6,2,n.geoInfo[null==o?null:o.key]))}}function x(o,l){if(1&o&&(r.TgZ(0,"section"),r.YNc(1,m,7,2,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"div",3),r.TgZ(4,"div",4),r._uU(5),r.qZA(),r.TgZ(6,"div",5),r.TgZ(7,"div",6),r.TgZ(8,"div",7),r.TgZ(9,"span",8),r._uU(10),r.qZA(),r.qZA(),r.TgZ(11,"div",3),r.TgZ(12,"div",9),r.TgZ(13,"div",10),r.TgZ(14,"span",8),r._uU(15),r.qZA(),r.qZA(),r.TgZ(16,"div",10),r.TgZ(17,"span",8),r._uU(18),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.YNc(19,p,10,3,"div",11),r.YNc(20,Z,7,4,"div",12),r.ALo(21,"keyvalue"),r.qZA(),r.qZA(),r.TgZ(22,"div",7),r.TgZ(23,"div",4),r._uU(24),r.qZA(),r.TgZ(25,"div",13),r._UZ(26,"app-summary-recepients",14),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&o){const o=r.oxw();r.xp6(1),r.Q6J("ngIf",o.showTitle),r.xp6(4),r.Oqu(o.language["OLT System"]),r.xp6(5),r.Oqu(o.language["Region(s)"]),r.xp6(5),r.Oqu(o.language["Location(s)"]),r.xp6(3),r.Oqu(o.language["System(s)"]),r.xp6(1),r.Q6J("ngIf",-1!==(null==o.workflowObj||null==o.workflowObj.regions?null:o.workflowObj.regions.indexOf("All"))||!(null!=o.workflowObj&&null!=o.workflowObj.regions&&o.workflowObj.regions.length)),r.xp6(1),r.Q6J("ngForOf",r.lcZ(21,9,o.geoInfo)),r.xp6(4),r.Oqu(o.language.Recipients),r.xp6(2),r.Q6J("workflowObj",o.workflowObj)}}function A(o,l){if(1&o&&(r.TgZ(0,"section"),r.TgZ(1,"div",23),r.TgZ(2,"div",24),r.TgZ(3,"div",25),r.TgZ(4,"div",26),r.TgZ(5,"div",27),r.TgZ(6,"div",28),r.TgZ(7,"span",29),r._uU(8),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&o){const o=r.oxw();r.xp6(8),r.Oqu(o.language.Loading)}}let y=(()=>{class o{constructor(o,l,n,i,t,e){this.translateService=o,this.http=l,this.route=n,this.commonOrgService=i,this.issueService=t,this.titleService=e,this.regionsObj={},this.loctionsObj={All:"All Locations"},this.geoInfo={},this.showAllRegions=!1,this.regLocSysMapInfo=[]}set workflowObj(o){var l;console.log(o),-1!==(null===(l=null==o?void 0:o.regions)||void 0===l?void 0:l.indexOf("All"))&&(this.showAllRegions=!0),this._workflowObj=o}get workflowObj(){return this._workflowObj}ngOnInit(){this.loader=!0,this.language=this.translateService.defualtLanguage,this.languageSubject=this.translateService.selectedLanguage.subscribe(o=>{this.language=o});let o=this.route.snapshot.paramMap.get("notificationId");o?(this.titleService.setTitle("Optical Outliers Notifications - Email Notifications - Network Operations - Operations - Operations - Calix Cloud"),this.showTitle=!0,this.getRecordById(o)):this.getRegions()}getRegions(){this.regionsSubject=this.issueService.getRegions().subscribe(o=>{var l,n;if(o){o=this.issueService.appendFqn(o);let i={};null==o||o.forEach(o=>{var l,n,t,e,s,r,d,u;if(i[null==o?void 0:o.id]=null==o?void 0:o.name,(null===(n=null===(l=this.workflowObj)||void 0===l?void 0:l.regions)||void 0===n?void 0:n.length)&&-1!==(null===(e=null===(t=this.workflowObj)||void 0===t?void 0:t.regions)||void 0===e?void 0:e.indexOf(null==o?void 0:o.id))&&(this.geoInfo[null==o?void 0:o.id]={}),(null===(r=null===(s=this.workflowObj)||void 0===s?void 0:s.locations)||void 0===r?void 0:r.length)&&-1!==(null===(u=null===(d=this.workflowObj)||void 0===d?void 0:d.locations)||void 0===u?void 0:u.indexOf("All"))){let o=this.geoInfo;for(let l in o)this.geoInfo[l].All=["All Systems"]}}),this.regionsObj=i,(null===(n=null===(l=this.workflowObj)||void 0===l?void 0:l.regions)||void 0===n?void 0:n.length)?this.loadLocationSystem():this.loader=!1}},o=>{console.log(o)})}loadLocationValue(){let o=this.workflowObj.regions;if(null==o?void 0:o.length){let l="";if(o.length){if(-1!==o.indexOf("All"))return;o.forEach(o=>{"All"!=o&&(l+=`&region=${o}`)}),this.locationsSubject=this.http.get(`${s.N.API_BASE_URL}nfa/locations?${l}`).subscribe(o=>{var l,n;if(null===(n=null===(l=this.workflowObj)||void 0===l?void 0:l.location)||void 0===n?void 0:n.length){let l=this.geoInfo;null==o||o.forEach(o=>{var n,i;-1!==(null===(i=null===(n=this.workflowObj)||void 0===n?void 0:n.location)||void 0===i?void 0:i.indexOf(null==o?void 0:o.id))&&(l[null==o?void 0:o.regionId]?l[null==o?void 0:o.regionId].push(null==o?void 0:o.name):l[null==o?void 0:o.regionId]=[null==o?void 0:o.name])}),console.log(l),this.geoInfo=l}},o=>{})}}}generateSystemDetails(){let o=this.workflowObj.regions,l=this.workflowObj.locations,n="";null==o||o.forEach(o=>{"All"!=o&&(n&&(n+="&"),n+=`region=${o}`)});let t="";return null==l||l.forEach(o=>{"All"!=o&&(t+=`&location=${o}`)}),this.http.get(`${s.N.API_BASE_URL}nfa/systems/details?${n}${t}&includeDeleted=true`).pipe((0,e.K)(o=>(o["api-error"]=!0,(0,i.of)(o))))}mapRegLocSysInfo(o){var l,n,i,t;console.log(o);let e={},s={},r={};return(null===(l=null==o?void 0:o.devices)||void 0===l?void 0:l.length)&&(o.devices=null===(n=null==o?void 0:o.devices)||void 0===n?void 0:n.filter(o=>{var l;return-1!==(null===(l=this.workflowObj.systems)||void 0===l?void 0:l.indexOf(null==o?void 0:o.uuid))})),null===(i=null==o?void 0:o.devices)||void 0===i||i.sort((o,l)=>{var n;return null===(n=null==o?void 0:o.regionName)||void 0===n?void 0:n.localeCompare(null==l?void 0:l.regionName)}),null===(t=null==o?void 0:o.devices)||void 0===t||t.forEach(o=>{void 0===e[null==o?void 0:o.regionuuid]&&(e[null==o?void 0:o.regionuuid]={},s[null==o?void 0:o.regionuuid]=null==o?void 0:o.regionName),void 0===e[null==o?void 0:o.regionuuid][null==o?void 0:o.locationuuid]&&(e[null==o?void 0:o.regionuuid][null==o?void 0:o.locationuuid]=[],r[null==o?void 0:o.locationuuid]=null==o?void 0:o.locationName),"object"==typeof e[null==o?void 0:o.regionuuid][null==o?void 0:o.locationuuid]&&e[null==o?void 0:o.regionuuid][null==o?void 0:o.locationuuid].push(null==o?void 0:o.name)}),e}mapRegLocSysInfoOld(o){var l,n,i;console.log(o);let t={},e={},s={};null===(l=null==o?void 0:o.devices)||void 0===l||l.sort((o,l)=>{var n;return null===(n=null==o?void 0:o.regionName)||void 0===n?void 0:n.localeCompare(null==l?void 0:l.regionName)}),null===(n=null==o?void 0:o.devices)||void 0===n||n.forEach(o=>{void 0===t[null==o?void 0:o.regionuuid]&&(t[null==o?void 0:o.regionuuid]={},e[null==o?void 0:o.regionuuid]=null==o?void 0:o.regionName),void 0===t[null==o?void 0:o.regionuuid][null==o?void 0:o.locationuuid]&&(t[null==o?void 0:o.regionuuid][null==o?void 0:o.locationuuid]=[],s[null==o?void 0:o.locationuuid]=null==o?void 0:o.locationName),"object"==typeof t[null==o?void 0:o.regionuuid][null==o?void 0:o.locationuuid]&&t[null==o?void 0:o.regionuuid][null==o?void 0:o.locationuuid].push({id:null==o?void 0:o.uuid,name:null==o?void 0:o.name})}),console.log(t);let r=[],d=[];for(let u in t){let o={};o={name:e[u]?e[u]:u,locations:[]};for(let l in t[u]){let n={};t[u][l]&&(n={name:s[l]?s[l]:l,systems:[]},null===(i=t[u][l])||void 0===i||i.forEach(o=>{n.systems.push(o)})),o.locations.push(n)}r.push(o)}console.log(r),null==r||r.forEach((o,l)=>{var n,i;o.locations=null===(n=null==o?void 0:o.locations)||void 0===n?void 0:n.sort((o,l)=>{var n;return null===(n=null==o?void 0:o.name)||void 0===n?void 0:n.localeCompare(null==l?void 0:l.name)}),null===(i=null==o?void 0:o.locations)||void 0===i||i.forEach((o,l)=>{var n,i;o.systems=null===(n=null==o?void 0:o.systems)||void 0===n?void 0:n.sort((o,l)=>{var n;return null===(n=null==o?void 0:o.name)||void 0===n?void 0:n.localeCompare(null==l?void 0:l.name)});let t=[];null===(i=null==o?void 0:o.systems)||void 0===i||i.forEach(o=>{d.push(o.id),t.push(o.name)}),o.systems=t})}),console.log(r),this.regLocSysMapInfo=r}loadLocationSystem(){var o,l,n,r;let d=this.workflowObj.regions;if(null==d?void 0:d.length){let u="";if(d.length){if(-1!==d.indexOf("All"))return;d.forEach(o=>{"All"!=o&&(u&&(u+="&"),u+=`region=${o}`)});const a={};a.locations=this.http.get(`${s.N.API_BASE_URL}nfa/locations?${u}`).pipe((0,e.K)(o=>(o["api-error"]=!0,(0,i.of)(o)))),(null===(l=null===(o=this.workflowObj)||void 0===o?void 0:o.systems)||void 0===l?void 0:l.length)&&-1==(null===(r=null===(n=this.workflowObj)||void 0===n?void 0:n.systems)||void 0===r?void 0:r.indexOf())&&(a.systems=this.generateSystemDetails()),(0,t.D)(a).subscribe(o=>{var l,n,i,t,e;let s;o.systems&&(s=this.mapRegLocSysInfo(o.systems),console.log(s));let r=this.geoInfo;(null===(n=null===(l=this.workflowObj)||void 0===l?void 0:l.locations)||void 0===n?void 0:n.length)&&(o.locations=this.issueService.appendFqn(o.locations),null===(i=o.locations)||void 0===i||i.forEach(o=>{var l,n,i;this.loctionsObj[null==o?void 0:o.id]=null==o?void 0:o.name,-1!==(null===(n=null===(l=this.workflowObj)||void 0===l?void 0:l.locations)||void 0===n?void 0:n.indexOf(null==o?void 0:o.id))?(r[null==o?void 0:o.regionId][null==o?void 0:o.id]=[],r[null==o?void 0:o.regionId][null==o?void 0:o.id]=s&&s[null==o?void 0:o.regionId]&&s[null==o?void 0:o.regionId][null==o?void 0:o.id]?s[null==o?void 0:o.regionId][null==o?void 0:o.id]:["All Systems"]):null===(i=this.workflowObj.regions)||void 0===i||i.indexOf(null==o?void 0:o.regionId)})),null===(t=o.locations)||void 0===t||t.forEach(o=>{var l,n,i,t;this.loctionsObj[null==o?void 0:o.id]=null==o?void 0:o.name,-1===(null===(n=null===(l=this.workflowObj)||void 0===l?void 0:l.locations)||void 0===n?void 0:n.indexOf(null==o?void 0:o.id))&&-1!==(null===(i=this.workflowObj.regions)||void 0===i?void 0:i.indexOf(null==o?void 0:o.regionId))&&!(null===(t=Object.keys(r[null==o?void 0:o.regionId]))||void 0===t?void 0:t.length)&&(r[null==o?void 0:o.regionId].All=["All Systems"])});for(let d in r)(null===(e=Object.keys(r[d]))||void 0===e?void 0:e.length)||(r[d].All=["All Systems"]);console.log(r),this.geoInfo=r,this.loader=!1})}}}getRecordById(o){this.loader=!0;let l=`${s.N.API_BASE_URL}health/config/notifications/${encodeURIComponent(o)}`;this.http.get(l).subscribe(o=>{o&&Object.keys(o).length&&(this.workflowObj=Object.assign(Object.assign({},this.workflowObj),o)),this.getRegions(),this.loader=!1},o=>{console.log(o),this.pageErrorHandle(o)})}pageErrorHandle(o){this.errorInfo=401==o.status?this.language["Access Denied"]:this.commonOrgService.pageErrorHandle(o),this.error=!0,this.loader=!1}}return o.\u0275fac=function(l){return new(l||o)(r.Y36(d.s),r.Y36(u.eN),r.Y36(a.gz),r.Y36(g.v),r.Y36(c.v),r.Y36(v.Dx))},o.\u0275cmp=r.Xpm({type:o,selectors:[["app-summary"]],inputs:{workflowObj:"workflowObj"},decls:2,vars:2,consts:[[4,"ngIf"],["class","row mb-2",4,"ngIf"],[1,"row","mt-3"],[1,"col-md-8"],[1,"border-bottom","cco-secondary-title","pb-1"],[1,"summary-info-table","summary-olt-table","px-3"],[1,"row","border-bottom"],[1,"col-md-4"],[1,"summary-label"],[1,"row"],[1,"col-md-6"],["class","row border-bottom",4,"ngIf"],["class","row border-bottom",4,"ngFor","ngForOf"],[1,"summary-info-table"],[3,"workflowObj"],[1,"row","mb-2"],[1,"col-md-12","pb-1","position-relative"],[1,"ccl-admin-title","text-truncate","pr-3",3,"title"],[1,"close-page"],["routerLink","/cco/operations/alarms/health-alarm-notifications","routerLinkActive","active",1,"cursor-pointer"],["src","assets/img/ic_close-44px.svg","alt",""],["class","row",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"container"],[1,"row","mb-3"],[1,"col-md-12"],[1,"loader","mt-5"],[1,"d-flex","justify-content-center"],[1,"spinner-border","text-primary"],[1,"sr-only"]],template:function(o,l){1&o&&(r.YNc(0,x,27,11,"section",0),r.YNc(1,A,9,1,"section",0)),2&o&&(r.Q6J("ngIf",!l.loader),r.xp6(1),r.Q6J("ngIf",l.loader))},directives:[f.O5,f.sg,h.f,a.yS,a.Od],pipes:[f.Nd],styles:[".summary-info-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;margin-bottom:0}.summary-info-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #EBEAEF!important}.summary-info-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:15px;font-style:normal;font-weight:400!important;line-height:24px;letter-spacing:0em;text-align:left;color:#4c4c4c;border:none!important;padding:0 10px 0 0}.summary-info-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #EBEAEF!important}.summary-info-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:15px;font-style:normal;font-weight:400!important;line-height:24px;letter-spacing:0em;text-align:left;color:gray;width:50%;border:none!important;padding:0 10px;word-break:break-word!important}.monitored[_ngcontent-%COMP%]{max-height:300px;overflow:auto}.monitored[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:50%}.alarm-title[_ngcontent-%COMP%]{font-family:Source Sans Pro;font-size:42px;font-style:normal;font-weight:300;line-height:53px;letter-spacing:0em;text-align:left;overflow:hidden;text-overflow:ellipsis}.subgroups-but[_ngcontent-%COMP%]{background-color:#fff;border:none}.modal.fade[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{border-radius:26px;max-width:950px!important}.modal-title[_ngcontent-%COMP%]{font-weight:300;font-size:42px;line-height:53px;word-wrap:break-word;color:#1a1f22}.alarm-name-list[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;height:26px}.alarm-name-list-box[_ngcontent-%COMP%]{max-height:550px;overflow-y:scroll}.hover-row[_ngcontent-%COMP%]{color:#0279ff!important}.hover-row[_ngcontent-%COMP%]:hover{text-decoration:underline}.width-60[_ngcontent-%COMP%]{width:60%!important}.min-height-div[_ngcontent-%COMP%]{min-height:15px}.marg-b-38px[_ngcontent-%COMP%]{margin-bottom:38px}.close-page[_ngcontent-%COMP%]{position:absolute;right:15px;top:10px}.summary-label[_ngcontent-%COMP%]{font-size:15px;font-style:normal;font-weight:400;line-height:24px;text-align:left;color:gray}.summary-olt-table[_ngcontent-%COMP%]   .row.border-bottom[_ngcontent-%COMP%]{margin-bottom:-1px}.summary-olt-table[_ngcontent-%COMP%]   .row.border-bottom[_ngcontent-%COMP%]:last-child{margin-bottom:0}"]}),o})()}}]);