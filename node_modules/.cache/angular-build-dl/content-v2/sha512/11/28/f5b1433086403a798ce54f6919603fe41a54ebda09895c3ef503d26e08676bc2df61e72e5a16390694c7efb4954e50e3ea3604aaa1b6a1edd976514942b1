"use strict";(self.webpackChunkcalix=self.webpackChunkcalix||[]).push([[4954],{70516:function(t,e,a){a.d(e,{_:function(){return h}});var s=a(92340),n=a(38583),r=a(16738),i=a(37716),o=a(91841),l=a(89097),g=a(13149),u=a(30900),c=a(94690),p=a(39895);let h=(()=>{class t{constructor(t,e,a,n,r,i){this.httpClient=t,this.sso=e,this.excel=a,this.customTranslateService=n,this.utils=r,this.router=i,this.baseURL=s.N.SUPPORT_URL,this.org_id=s.N.faAdminOrgId,this.topn=this.baseURL+"/traffic/reports/topapplications",this.language=this.customTranslateService.defualtLanguage,this.customTranslateService.selectedLanguage.subscribe(t=>{this.language=t})}Topn(t,e){let a=this.sso.getOrgId(),s=new Date(t.startDate).toISOString();s=this.makeIsoDate(s);let n=new Date(t.endDate).toISOString();n=this.makeIsoDate(n);let r=`${this.topn}?org=${a}&tenant=0&groupBy=${t.groupBy}&sortBy=total&granularity=1month&startTime=${s}&endTime=${n}&count=${t.limit?t.limit:10}&output=${t.criteriaSelected?t.criteriaSelected:"usage"}`;return e&&"top-applications"==e&&(r=`${this.topn}?granularity=24hour&org=${a}&tenant=0&startTime=${s}&endTime=${n}&endpoint=e8ba81c8-c6c7-458d-bcdc-e775af1de465&count=10&direction=both`),this.httpClient.get(r)}getTopEndpoints(t){this.sso.getOrgId();let e=new Date(t.startDate).toISOString();e=this.makeIsoDate(e);let a=new Date(t.endDate).toISOString();a=this.makeIsoDate(a);let n="";if("usage"==t.criteriaSelected){let r=this.sso.getSubscriberEndpointId()?this.sso.getSubscriberEndpointId():"33e034e2-9bcf-4d71-81d7-3a2e97d3a84b";n=`${s.N.SUPPORT_URL}/traffic/reports/topdestinations?granularity=24hour&org=${this.sso.getOrgId()}&tenant=0&startTime=${e}&endTime=${a}&endpoint=${r}&count=10&direction=${t.directionSelected.toLowerCase()}`}else{let r=this.sso.getSubscriberEndpointId()?this.sso.getSubscriberEndpointId():"2a3686a2-6a92-4437-9e12-9f04e96e7fdf";n=`${s.N.SUPPORT_URL}/traffic/timeseries?granularity=1hour&org=${this.sso.getOrgId()}&tenant=0&startTime=${e}&endTime=${a}&endpoint=${r}&groupBy=destination&direction=${t.directionSelected.toLowerCase()}&output=${t.criteriaSelected}&count=${t.limit}`}return this.httpClient.get(n)}getApplications(t){let e=new Date(t.startDate),a=new Date(t.endDate);e=this.getStartUTCDate(t.startDate,0),a=this.getEndUTCDate(t.endDate),"usage"==t.criteriaSelected&&(e=this.getISOStartOfDay(e),a=this.getISOEndOfDay(a,"applications"));let n="",r={granularity:"24hour",tenant:0,startTime:e,endpoint:this.sso.getSubscriberEndpointId()?this.sso.getSubscriberEndpointId():"e8ba81c8-c6c7-458d-bcdc-e775af1de465",output:t.criteriaSelected,direction:t.directionSelected.toLowerCase(),org:this.sso.getOrgId(),count:t.limit,endTime:a};"yes"===t.groupSelected&&(r.groupApplications=!0);let i="";for(var o in r)void 0!==r[o]&&(""!=i&&(i+="&"),i+=o+"="+encodeURIComponent(r[o]));return n=`${s.N.SUPPORT_URL}/traffic/reports/topapplications?${i}`,this.httpClient.get(n)}getAppTraffic(t){let e=new Date(t.startDate),a=new Date(t.endDate);e=this.getStartUTCDate(t.startDate,0),a=this.getEndUTCDate(t.endDate);let n="",r={granularity:this.getGranularityByChart(e,a)||"1hour",org:this.sso.getOrgId(),tenant:0,startTime:e,endTime:a,endpoint:this.sso.getSubscriberEndpointId()?this.sso.getSubscriberEndpointId():"2705d400-58a5-4cca-8091-8ee2843ea2c9",groupBy:"application",output:"rate",count:t.limit,direction:"both"},i="";for(var o in r)void 0!==r[o]&&(""!=i&&(i+="&"),i+=o+"="+encodeURIComponent(r[o]));return n=`${s.N.SUPPORT_URL}/traffic/timeseries?${i}`,this.httpClient.get(n)}getUsage(t,e){let a=this.sso.getOrgId(),n=new Date(t.startDate),r=new Date(t.endDate);n=this.getISOStartOfDay(n),r=this.getISOEndOfDay(r);let i=this.getGranularity(n,r);return t.granularity=i,this.httpClient.get(`${s.N.SUPPORT_URL}/traffic/timeseries?org=${a}&tenant=0&granularity=${i}&startTime=${n}&endTime=${r}&output=usage&endpoint=${e}`)}getRate(t,e){let a=this.sso.getOrgId(),n=new Date(t.startDate),r=new Date(t.endDate),i=this.getGranularityByChart(n,r,"rate");return n=this.getStartUTCDate(t.startDate,0),r=this.getEndUTCDate(t.endDate),this.httpClient.get(`${s.N.SUPPORT_URL}/traffic/timeseries?org=${a}&tenant=0&granularity=${i}&startTime=${n}&endTime=${r}&output=rate&endpoint=${e}`)}getMonthlyUsage(t,e){let a=this.sso.getOrgId(),n=new Date,r=t.monthCount?t.monthCount:1,i=new Date(n.getFullYear(),n.getMonth()-r,1),o=new Date(n.getFullYear(),n.getMonth(),0),l=this.getISOStartOfDay(i),g=this.getISOEndOfDay(o);return this.httpClient.get(`${s.N.SUPPORT_URL}/traffic/timeseries?org=${a}&tenant=0&granularity=${t.granularity}&startTime=${l}&endTime=${g}&output=usage&endpoint=${e}`)}topAppTraffic(t){let e=this.sso.getOrgId(),a=new Date(t.startDate).toISOString();a=this.makeIsoDate(a);let s=new Date(t.endDate).toISOString();return s=this.makeIsoDate(s),this.httpClient.get(`${this.topn}?org=${e}&tenant=0&groupBy=application&sortBy=total&granularity=1month&startTime=${a}&endTime=${s}&count=${t.limit?t.limit:10}`)}makeOptions(t,e,a,s){let r=s.title,i=this,o=new n.uU("en-US"),l=new n.rS,g=/\((.*)\)/.exec((new Date).toString())[1];"usage"==a.criteriaSelected&&(g="Coordinated Universal Time");let u=[],c=[],p=`${this.language.down}`;p="both"==a.directionSelected?`${this.language["Both(Down+Up)"]}`:"Down"==a.directionSelected?`${this.language.down}`:`${this.language.up}`;let h="";this.sso.getTrafficReportChartSubscriberInfo()&&(h=`<span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;">${this.language.Subscriber}: ${this.sso.getTrafficReportChartSubscriberInfo()}</span><span style="font-size:16px; color:#ffffff">...</span>`);let d=`${h}<span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;">${this.language.criteria}: ${this.language[a.criteriaSelected]}</span><span style="font-size:16px; color:#ffffff">...</span><span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;"> ${this.language.time_win}: ${o.transform(a.startDate,"MM/dd/yyyy")} to ${o.transform(a.endDate,"MM/dd/yyyy")} [${g}]</span><span style="font-size:16px; color:#ffffff">...</span><span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;"> ${this.language.direction}: ${p}</span>`,f={chart:{type:e,zoomType:"xy"},title:{text:r},subtitle:{text:d},xAxis:{categories:u},yAxis:{min:0,title:{text:""},labels:{formatter:function(){let t=this;var e,s=t.axis.series[0].dataMax;if("usage"==a.criteriaSelected)e=(t.value/(n=s>1e12?[1e12,"TB"]:s>1e9?[1e9,"GB"]:s>1e6?[1e6,"MB"]:s>1e3?[1e3,"KB"]:[1,"B"])[0]).toFixed(1)+(t.isFirst?" "+n[1]:"");else{var n=s>1e12?[1e12,"Tbps"]:s>1e9?[1e9,"Gbps"]:s>1e6?[1e6,"Mbps"]:s>1e3?[1e3,"Kbps"]:[1,"bps"];e=(t.isFirst?0:(t.value/n[0]).toFixed(1))+(t.isFirst?" "+n[1]:"")}return e}}},lang:{noData:i.language["No Data Available"]},legend:{reversed:!0},plotOptions:{series:{color:"#0279FF",cursor:"pointer",point:{events:{}}}},tooltip:{formatter:function(){var t,e,s=this.y;return"usage"==a.criteriaSelected?(t=i.getStackedUnit(s),e=`<b> ${this.key} </b><br/>\n                        <p>${this.series.name}<span>: <b>${(this.y/t[0]).toFixed(2)+" "+t[1]}</b><br/></span></p>`):(t=i.utils.bitsToSize(s,!1),e=`<b> ${this.key} </b><br/>\n                        <p>${this.series.name}<span>: <b>${t}</b><br/></span></p>`),e}},series:[],exporting:{filename:"Subscriber_Top_Applications",buttons:{contextButton:{menuItems:[{textKey:"downloadPDF",text:this.language.exportPDF||"Export PDF",onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadCSV",text:this.language.exportCsv||"Export CSV",onclick:function(){let e=[];for(var s=0;s<t.length;s++)e.push("usage"==a.criteriaSelected?{Name:t[s].name?t[s].name:"","Up Usage(Byte)":t[s].usOctets?t[s].usOctets.toLocaleString():0,"Down Usage(Byte)":t[s].dsOctets?t[s].dsOctets.toLocaleString():0,"Both(Down+Up) Usage(Byte)":t[s].totalOctets?t[s].totalOctets.toLocaleString():0}:{Name:t[s].name?t[s].name:t[s].key,"Up Max Rate(bps)":t[s].peakUsRate?t[s].peakUsRate.toLocaleString():0,"Up Average Rate(bps)":t[s].usRate?t[s].usRate.toLocaleString():0,"Down Max Rate(bps)":t[s].peakDsRate?t[s].peakDsRate.toLocaleString():0,"Down Average Rate(bps)":t[s].dsRate?t[s].dsRate.toLocaleString():0});let n="",l="";i.sso.getTrafficReportChartSubscriberInfo()&&(l=`${i.language.Subscriber}: ${i.sso.getTrafficReportChartSubscriberInfo()}\r\n`),n=`${r}\r\n${l} Criteria: ${i.language[a.criteriaSelected]} \r\n ${i.language.time_win}: ${o.transform(a.startDate,"MM/dd/yyyy")} - ${o.transform(a.endDate,"MM/dd/yyyy")} [${g}]\r\n Direction: ${p} \r\n`,i.excel.downLoadCSV("Subscriber_Top_Applications",e,n)}}],text:this.language.export}}},credits:{enabled:!1}};if("bar"===e){for(let e=0;e<t.length;e++)t[e].name?u.push(t[e].name):(t[e].key||(t[e].key="others"),u.push(t[e].key)),"usage"==a.criteriaSelected?c.push("both"==a.directionSelected?t[e].totalOctets:"Down"==a.directionSelected?t[e].dsOctets:t[e].usOctets):"rate"==a.criteriaSelected&&c.push("both"==a.directionSelected?t[e].dsRate+t[e].usRate:"Down"==a.directionSelected?t[e].dsRate:t[e].usRate);f.series=[{name:`${"both"==a.directionSelected?this.language["Both(Down+Up)"]:this.language[a.directionSelected]} ${l.transform(a.criteriaSelected)}`,data:c}]}else if("pie"===e){for(let e=0;e<t.length;e++)c.push("Both(Down+Up)"==a.directionSelected?{name:t[e].name,y:t[e].dsOctets+t[e].usOctets}:"Down"==a.directionSelected?{name:t[e].name,y:t[e].dsOctets}:{name:t[e].name,y:t[e].usOctets});f.series=[{data:c,name:this.language[a.directionSelected]}],f.plotOptions.pie={allowPointSelect:!0,cursor:"pointer"}}return f}makeIsoDate(t){let e=t.split(".")[0].split(":");return e.pop(),e.join(":")+":00Z"}getISODate(t){let e=new Date(t),a=e.getFullYear(),s=`${e.getMonth()+1}`,n=`${e.getDate()}`,r=`${(new Date).getUTCHours()}`;return s.length<2&&(s=`0${s}`),n.length<2&&(n=`0${n}`),r.length<2&&(r=`0${r}`),`${a}-${s}-${n}T${r}:00:00Z`}convertStartDate(t){let e=t.split("T");e.splice(1,1),e.push("00:00:00");let a=e.join(" ");return new Date(a).toISOString()}convertEndDate(t){let e=t.split("T");e.splice(1,1),e.push("23:59:59");let a=e.join(" ");return new Date(a).toISOString()}checkSameDate(t){return new Date(t.startDate).setHours(0,0,0,0)==new Date(t.endDate).setHours(0,0,0,0)}getStartUTCDate(t,e){let a=new Date(t);a.setHours(e,0,0,0);let s=a.getUTCFullYear(),n=`${a.getUTCMonth()+1}`,r=`${a.getUTCDate()}`,i=`${a.getUTCHours()}`,o=`${a.getUTCMinutes()}`;return n.length<2&&(n=`0${n}`),r.length<2&&(r=`0${r}`),i.length<2&&(i=`0${i}`),o.length<2&&(o=`0${o}`),`${s}-${n}-${r}T${i}:${o}:00Z`}getEndUTCDate(t){let e=new Date(t);e.setHours(0,0,0,0),e.setDate(new Date(e).getDate()+1);let a=e.getUTCFullYear(),s=`${e.getUTCMonth()+1}`,n=`${e.getUTCDate()}`,r=`${e.getUTCHours()}`,i=`${e.getUTCMinutes()}`;return s.length<2&&(s=`0${s}`),n.length<2&&(n=`0${n}`),r.length<2&&(r=`0${r}`),i.length<2&&(i=`0${i}`),`${a}-${s}-${n}T${r}:${i}:00Z`}getISOStartOfDay(t){let e=new Date(t),a=e.getFullYear(),s=`${e.getMonth()+1}`,n=`${e.getDate()}`;return s.length<2&&(s=`0${s}`),n.length<2&&(n=`0${n}`),`${a}-${s}-${n}T00:00:00Z`}getISOEndOfDay(t,e){let a=new Date(t);a.setDate(new Date(a).getDate()+("applications"===e?0:1));let s=a.getFullYear(),n=`${a.getMonth()+1}`,r=`${a.getDate()}`;return n.length<2&&(n=`0${n}`),r.length<2&&(r=`0${r}`),`${s}-${n}-${r}T00:00:00Z`}getISOStartEndDateNEW(t,e,a){let s=new Date(t),n=new Date,r=s.getUTCFullYear(),i=`${s.getUTCMonth()+1}`,o=`${s.getUTCDate()}`,l=`${s.getUTCHours()}`,g=`${s.getUTCMinutes()}`;return i.length<2&&(i=`0${i}`),o.length<2&&(o=`0${o}`),e&&new Date(s)>n&&(l=`${(new Date).getUTCHours()}`,g=`${(new Date).getUTCMinutes()}`),l.length<2&&(l=`0${l}`),g.length<2&&(g=`0${g}`),`${r}-${i}-${o}T${l}:${g}:00Z`}getISOStartEndDate(t,e,a){let s=new Date(t),n=new Date;e?s.setHours(23,59,0,0):s.setHours(0,0,0,0);let r=s.getUTCFullYear(),i=`${s.getUTCMonth()+1}`,o=`${s.getUTCDate()}`,l=`${s.getUTCHours()}`,g=`${s.getUTCMinutes()}`;return i.length<2&&(i=`0${i}`),o.length<2&&(o=`0${o}`),e&&new Date(s)>n&&(l=`${(new Date).getUTCHours()}`,g=`${(new Date).getUTCMinutes()}`),l.length<2&&(l=`0${l}`),g.length<2&&(g=`0${g}`),`${r}-${i}-${o}T${l}:${g}:00Z`}getISOEndDate(t){let e=new Date(t),a=e.getFullYear(),s=`${e.getMonth()+1}`,n=`${e.getDate()}`,r=`${(new Date).getUTCHours()}`;return s.length<2&&(s=`0${s}`),n.length<2&&(n=`0${n}`),r.length<2&&(r=`0${r}`),`${a}-${s}-${n}T${r}:00:00Z`}getGranularity(t,e){let a="24hour";return a=r(e).diff(r(t),"hour")<=24?"1hour":"24hour",a}getGranularityByChart(t,e,a,s){let n="24hour",i=0;return i=s?24*s*60*60:2764800,n=60*r(e).diff(r(t),"hour")*60<i?"1hour":"24hour",n}getStackedUnit(t){let e;return e=t>1e12?[1e12,"TB"]:t>1e9?[1e9,"GB"]:t>1e6?[1e6,"MB"]:t>1e3?[1e3,"KB"]:[1,"KB"],e}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o.eN),i.LFG(l.t6),i.LFG(g.O),i.LFG(u.d),i.LFG(c.e),i.LFG(p.F0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},4954:function(t,e,a){a.d(e,{D:function(){return f}});var s=a(38583),n=a(16738),r=a(1282),i=a(55429),o=a(37716),l=a(39895),g=a(94690),u=a(48483),c=a(13149),p=a(30900),h=a(89097),d=a(70516);let f=(()=>{class t{constructor(t,e,a,s,n,r,i){this.router=t,this.utils=e,this.dateUtils=a,this.excel=s,this.customTranslateService=n,this.sso=r,this.service=i,this.defaultData={downData:[],downPercentage:"",downTotal:"",graphType:"",sendTime:(new Date).getTime(),upData:[],upPercentage:"",upTotal:""},this.language=this.customTranslateService.defualtLanguage,this.customTranslateService.selectedLanguage.subscribe(t=>{this.language=t})}makeOptionsForTraffic(t,e,a){var r=this;let i,o,l=new s.uU("en-US"),g=0,u=0,c=r.language["Coordinated Universal Time"],p=(n(a.endDate).diff(n(a.startDate),"hour"),""),h=[],d=[],f=[];for(let s=0;s<t.length;s++){let e=this.dateUtils.getUTCDateFormatFromUTCTime(t[s].startPeriodSec,!0);"1hour"===a.granularity&&(e=this.dateUtils.getUTCDateFormatFromUTCTime(t[s].startPeriodSec,!0,"MM/dd HH:mm")),h.push(e),d.push(t[s].usOctets&&-1!==t[s].usOctets?t[s].usOctets:null),f.push(t[s].dsOctets&&-1!==t[s].dsOctets?t[s].dsOctets:null),g+=t[s].usOctets&&-1!==t[s].usOctets?t[s].usOctets:0,u+=t[s].dsOctets&&-1!==t[s].dsOctets?t[s].dsOctets:0}let m=this.getStackedUnit(g),$=this.getStackedUnit(u);i=(g/m[0]).toFixed(2)+" "+m[1],o=(u/$[0]).toFixed(2)+" "+$[1];const D=this;let y={chart:{type:"column",zoomType:"xy"},time:{useUTC:!1},title:{text:this.language.subscriberUsage},subtitle:{text:p},xAxis:{categories:h},yAxis:{min:0,title:{text:""},labels:{formatter:function(){let t=this;var e=t.axis.series[0].dataMax,a=e>1e12?[1e12,"TB"]:e>1e9?[1e9,"GB"]:e>1e6?[1e6,"MB"]:e>1e3?[1e3,"KB"]:[1,"B"];return(t.value/a[0]).toFixed(1)+(t.isFirst?" ":" "+a[1])}},opposite:!1,tickLength:2},lang:{noData:r.language["No Data Available"]},legend:{reversed:!1},plotOptions:{column:{stacking:"normal"},series:{colors:["#E87B00","#44367D","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],point:{events:{}}}},series:[],exporting:{filename:"Subscriber_Usage",buttons:{contextButton:{menuItems:[{textKey:"downloadPDF",text:this.language.exportPDF||"Export PDF",onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadCSV",text:this.language.exportCsv||"Export CSV",onclick:function(){let e=[],s="",n="";r.sso.getTrafficReportChartSubscriberInfo()&&(n=`${D.language.Subscriber}: ${r.sso.getTrafficReportChartSubscriberInfo()}\r\n`),s=`${D.language.subscriberUsage}\r\n${n}${r.language.time_win}: ${l.transform(a.startDate,"MM/dd/yyyy")} - ${l.transform(a.endDate,"MM/dd/yyyy")} [${c}]\r\n${r.language.upUsageTitle}: ${i}    ${r.language.downUsageTitle}: ${o}\r\n`;for(var g=0;g<t.length;g++)e.push({[D.language["Date Time"]]:r.dateUtils.getUTCDateFormatFromUTCTime(t[g].startPeriodSec,!0,"MM/dd HH:mm"),[D.language["Up Usage(Byte)"]]:t[g].usOctets&&-1!==t[g].usOctets?t[g].usOctets.toLocaleString():0,[D.language["Down Usage(Byte)"]]:t[g].dsOctets&&-1!==t[g].dsOctets?t[g].dsOctets.toLocaleString():0});r.excel.downLoadCSV("Subscriber_Usage",e,s)}}],text:r.language.export}}},credits:{enabled:!1},tooltip:{formatter:function(){var t=this.x||this.point.name,e=r.getUnit(this.y);return"<p><strong>"+t+"</strong><br/><span> "+this.series.name+": <strong>"+(this.y/e[0]).toFixed(2)+" "+e[1]+"</strong><br/></span></p>"}}};y.series=[{name:this.language.upUsageTitle,data:d,color:"#82BF00"},{name:this.language.downUsageTitle,data:f,color:"#0279FF"}],y.xAxis.categories=h;let S="";return this.sso.getTrafficReportChartSubscriberInfo()&&(S=`<span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;">${this.language.Subscriber}: ${this.sso.getTrafficReportChartSubscriberInfo()}</span><span style="font-size:16px; color:#ffffff">...</span>`),p=`${S}<span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;"> ${this.language.time_win}: ${l.transform(a.startDate,"MM/dd/yyyy")} to ${l.transform(a.endDate,"MM/dd/yyyy")} [${c}]</span><br/>\n    <span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;">${this.language.upUsageTitle}: ${i}    ${this.language.downUsageTitle}: ${o}</span>`,y.subtitle.text=p,y}dataFormingForRTBC(t,e){let a=[],s=[];if("upData"===e){t.upData=t.upData.slice(0,5);for(let e=0;e<t.upData.length;e++)a.push(t.upData[e].name),s.push({y:t.upData[e].value,id:t.upData[e].id,name:t.upData[e].name})}else{t.downData=t.downData.slice(0,5);for(let e=0;e<t.downData.length;e++)a.push(t.downData[e].name),s.push({y:t.downData[e].value,id:t.downData[e].id,name:t.downData[e].name})}}makeOptionsForRTBC(t,e,a,s,n){let r=this;s=s||5;let i=[],o=[],l={chart:{type:"bar",zoomType:"xy",height:180,renderTo:"container"},title:{text:""},credits:{enabled:!1},xAxis:{categories:i},yAxis:{title:{text:""},opposite:!0,tickLength:2,tickAmount:n?6:3,startOnTick:!1,endOnTick:!1,labels:{formatter:function(){return`${r.bitsToSize(this.value,!1)}`},rotation:0}},legend:{enabled:!1},plotOptions:{column:{stacking:"normal"},series:{color:"#0027FF",cursor:"pointer",point:{events:{}}}},series:[],tooltip:{formatter:function(){return`${this.x} <br/> ${r.utils.bitsToSize(this.y,!1)}`}}},g=[],u=[];if("bar"===e){if("upData"===a){t.upData=t.upData.slice(0,s);for(let e=0;e<t.upData.length;e++)i.push(t.upData[e].name),o.push(t.upData[e].value),g.push(t.upData[e].name),u.push(t.upData[e].id)}else{t.downData=t.downData.slice(0,s);for(let e=0;e<t.downData.length;e++)i.push(t.downData[e].name),o.push(t.downData[e].value),g.push(t.downData[e].name),u.push(t.downData[e].id)}l.series=[{data:o}]}return l.xAxis.categories=i,l}makeOptionsForAreaChart(t,e,a){let s={chart:{type:"area",zoomType:"xy"},title:{text:""},xAxis:{categories:[]},yAxis:{min:0,title:{text:""}},legend:{reversed:!0},plotOptions:{area:{stacking:"normal",lineColor:"#666666",lineWidth:1,marker:{lineWidth:1,lineColor:"#666666"}}},series:[]},n=[];for(let r=0;r<t.length;r++)n.push("up"==e?{name:t[r].name,data:[t[r].usOctets]}:{name:t[r].name,data:[t[r].dsOctets]});return s.xAxis.categories=[a.startDate],s.series=n,s}makeOptionsForLineChart(t,e,a){let r=this.language.max_up_rate,i=this.language.max_down_rate,o=this,l=[],g=[],u=[];this.sso.getReportChartSubscriberInfo(),"Average"==a.rateSelected&&(r=this.language.Average_Up_Rate,i=this.language.Average_Down_Rate);let c=new s.uU("en-US"),p=new Date(a.startDate),h=new Date(a.endDate);this.service.getGranularityByChart(p,h,"rate");for(let s=0;s<t.length;s++)l.push(this.getDateTime(t[s].startPeriodSec,!0,"MM/dd HH:mm"));let d=/\((.*)\)/.exec((new Date).toString())[1],f=(n(a.endDate).diff(n(a.startDate),"hour"),"");this.sso.getTrafficReportChartSubscriberInfo()&&(f=`<span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;">${this.language.Subscriber}: ${this.sso.getTrafficReportChartSubscriberInfo()}</span><span style="font-size:16px; color:#ffffff">...</span>`);let m=`${f}<span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;">Rate: ${this.language[a.rateSelected]}</span><span style="font-size:16px; color:#ffffff">...</span><span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;"> ${this.language.time_win}: ${c.transform(a.startDate,"MM/dd/yyyy")} to ${c.transform(a.endDate,"MM/dd/yyyy")} [${d}]</span>`,$={chart:{type:"line"},time:{useUTC:!1},title:{text:this.language.subscriberRate},subtitle:{text:m},xAxis:{categories:[],labels:{rotation:-65,formatter:function(){return this.value}}},yAxis:{title:{text:""},labels:{formatter:function(){return o.utils.bitsToSize(this.value,!0)}},min:0,minRange:1},lang:{noData:o.language["No Data Available"]},legend:{align:"center",verticalAlign:"bottom",layout:"horizontal",symbolRadius:0},tooltip:{formatter:function(){return"<b>"+this.x+" <b><br/>"+this.series.name+": <b>"+o.utils.bitsToSize(this.y,!1)+"</b>"}},plotOptions:{series:{marker:{enabled:!1}},column:{stacking:"normal",dataLabels:{enabled:!1}}},series:[{name:r,color:"#82BF00",data:[]},{name:i,color:"#0279FF",data:[]}],exporting:{filename:"Subscriber_Rate",buttons:{contextButton:{menuItems:[{textKey:"downloadPDF",text:this.language.exportPDF||"Export PDF",onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadCSV",text:this.language.exportCsv||"Export CSV",onclick:function(){let e=[],s="",n="";o.sso.getTrafficReportChartSubscriberInfo()&&(n=`${o.language.Subscriber}: ${o.sso.getTrafficReportChartSubscriberInfo()}\r\n`),s=`Subscriber Rate\r\n${n}${o.language.time_win}: ${c.transform(a.startDate,"MM/dd/yyyy")} - ${c.transform(a.endDate,"MM/dd/yyyy")} [${d}]\r\nRate: ${a.rateSelected}\r\n`;for(var r=0;r<t.length;r++)e.push({"Date Time":o.getDateTime(t[r].startPeriodSec,!0,"MM/dd HH:mm"),"Max Up Rate(bps)":t[r].peakUsRate&&-1!==t[r].peakUsRate?t[r].peakUsRate:0,"Max Down Rate(bps)":t[r].peakDsRate&&-1!==t[r].peakDsRate?t[r].peakDsRate:0,"Average Up Rate(bps)":t[r].usRate&&-1!==t[r].usRate?t[r].usRate:0,"Average Down Rate(bps)":t[r].dsRate&&-1!==t[r].dsRate?t[r].dsRate:0});o.excel.downLoadCSV("Subscriber_Rate",e,s)}}],text:o.language.export}}},credits:{enabled:!1}};for(let s=0;s<t.length;s++)l.push(this.getDateTime(t[s].startPeriodSec,!0,"MM/dd HH:mm")),"Average"==a.rateSelected?(g.push(t[s].usRate),u.push(t[s].dsRate)):(g.push(t[s].peakUsRate),u.push(t[s].peakDsRate));return $.xAxis.categories=l,l&&l.length<=45?$.xAxis.tickInterval=1:l&&l.length>45&&($.xAxis.tickInterval=Math.floor(l.length/45)),$.series[0].data=g,$.series[1].data=u,$}makeOptionsForMonthlyUsage(t,e,a){var n=this;new s.uU("en-US");let r,i,o=n.language["Coordinated Universal Time"],l=new Date,g=a.monthCount?a.monthCount:1,u=new Date(l.getFullYear(),l.getMonth()-g,1),c=new Date(l.getFullYear(),l.getMonth(),0),p=this.dateUtils.getMonthYear(u),h=this.dateUtils.getMonthYear(c),d="",f=0,m=0,$=[],D=[],y=[];for(let s=0;s<t.length;s++){let e=this.dateUtils.getUTCDateFormatFromUTCTime(t[s].startPeriodSec,!0,"MM/yyyy");$.push(e),D.push(t[s].usOctets&&-1!==t[s].usOctets?t[s].usOctets:null),y.push(t[s].dsOctets&&-1!==t[s].dsOctets?t[s].dsOctets:null),f+=t[s].usOctets&&-1!==t[s].usOctets?t[s].usOctets:0,m+=t[s].dsOctets&&-1!==t[s].dsOctets?t[s].dsOctets:0}let S=this.getStackedUnit(f),b=this.getStackedUnit(m);r=(f/S[0]).toFixed(2)+" "+S[1],i=(m/b[0]).toFixed(2)+" "+b[1];let T={chart:{type:"column",zoomType:"xy"},title:{text:this.language.subscriberMonthlyUsage},subtitle:{text:d},xAxis:{categories:$},yAxis:{min:0,title:{text:""},labels:{formatter:function(){let t=this;var e=t.axis.series[0].dataMax,a=e>1e12?[1e12,"TB"]:e>1e9?[1e9,"GB"]:e>1e6?[1e6,"MB"]:e>1e3?[1e3,"KB"]:[1,"B"];return(t.value/a[0]).toFixed(1)+(t.isFirst?" ":" "+a[1])}},opposite:!1,tickLength:2},lang:{noData:n.language["No Data Available"]},legend:{reversed:!1},plotOptions:{column:{stacking:"normal"},series:{colors:["#E87B00","#44367D","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],point:{events:{}}}},series:[],exporting:{filename:"Subscriber_Monthly_Usage",buttons:{contextButton:{menuItems:[{textKey:"downloadPDF",text:this.language.exportPDF||"Export PDF",onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadCSV",text:this.language.exportCsv||"Export CSV",onclick:function(){let e=[],a="",s="";n.sso.getTrafficReportChartSubscriberInfo()&&(s=`${n.language.Subscriber}: ${n.sso.getTrafficReportChartSubscriberInfo()}\r\n`),a=`${n.language.subscriberMonthlyUsage}\r\n${s}${n.language.time_win}: ${p} - ${h} [${o}]\r\n${n.language.upUsageTitle}: ${r}    ${n.language.downUsageTitle}: ${i}\r\n`;for(var l=0;l<t.length;l++)e.push({"Date Time":n.dateUtils.getUTCDateFormatFromUTCTime(t[l].startPeriodSec,!0,"MM/yyyy"),"Up Usage(Byte)":t[l].usOctets&&-1!==t[l].usOctets?t[l].usOctets.toLocaleString():0,"Down Usage(Byte)":t[l].dsOctets&&-1!==t[l].dsOctets?t[l].dsOctets.toLocaleString():0});n.excel.downLoadCSV("Subscriber_Monthly_Usage",e,a)}}],text:"Export"}}},credits:{enabled:!1},tooltip:{formatter:function(){var t=this.x||this.point.name,e=n.getUnit(this.y);return"<p><strong>"+t+"</strong><br/><span> "+this.series.name+": <strong>"+(this.y/e[0]).toFixed(2)+" "+e[1]+"</strong><br/></span></p>"}}};T.series=[{name:this.language.upUsageTitle,data:D,color:"#82BF00"},{name:this.language.downUsageTitle,data:y,color:"#0279FF"}],T.xAxis.categories=$;let x="";return this.sso.getTrafficReportChartSubscriberInfo()&&(x=`<span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;">${this.language.Subscriber}: ${this.sso.getTrafficReportChartSubscriberInfo()}</span><span style="font-size:16px; color:#ffffff">...</span>`),d=`${x}<span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;"> ${this.language.time_win}: ${p} to ${h} [${o}]</span><br/>\n    <span style="font-family: Lato; color: #000000; font-size: 12px; line-height: 1.1640625;">${this.language.upUsageTitle}: ${r}    ${this.language.downUsageTitle}:  ${i}</span>`,T.subtitle.text=d,T}convertDate(t){var e=new Date(t),a=(e.getMonth()+1).toString(),s=e.getDate().toString(),n=a.split(""),r=s.split("");return(n[1]?a:"0"+n[0])+"/"+(r[1]?s:"0"+r[0])}setTopEP(t){t?localStorage.setItem("calix.topep_data",JSON.stringify(t)):localStorage.removeItem("calix.topep_data")}getTopEP(){return localStorage.getItem("calix.topep_data")?JSON.parse(localStorage.getItem("calix.topep_data")):[]}setTopApp(t){t?localStorage.setItem("calix.topapp_data",JSON.stringify(t)):localStorage.removeItem("calix.topapp_data")}getTopApp(){return localStorage.getItem("calix.topapp_data")?JSON.parse(localStorage.getItem("calix.topapp_data")):[]}setTopLoc(t){t?localStorage.setItem("calix.toploc_data",JSON.stringify(t)):localStorage.removeItem("calix.toploc_data")}getTopLoc(){return localStorage.getItem("calix.toploc_data")?JSON.parse(localStorage.getItem("calix.toploc_data")):[]}getStackedUnit(t){let e;return e=t>1e12?[1e12,"TB"]:t>1e9?[1e9,"GB"]:t>1e6?[1e6,"MB"]:t>1e3?[1e3,"KB"]:[1,""],e}setNetworkRealTimeGraphData(t,e){e?localStorage.setItem(t,JSON.stringify(e)):localStorage.removeItem(t)}getNetworkRealTimeGraphData(t){return this.defaultData.graphType=t,localStorage.getItem(t)?JSON.parse(localStorage.getItem(t)):this.defaultData}bitsToSize(t,e){let a=t,s=["bps","Kbps","Mbps","Gbps","Tbps"];if(0==a)return"0 bps";var n=Math.floor(Math.log(a)/Math.log(1e3));if(e)return Math.round(a/Math.pow(1e3,n))+" "+s[n];n<0&&(n=0);let i=1;return Number.isInteger(+r.numberFormat(Math.abs(a/Math.pow(1e3,n)),1))&&(i=0),r.numberFormat(Math.abs(a/Math.pow(1e3,n)),i)+" "+s[n]}getDateTime(t,e,a){let s=60*(new Date).getTimezoneOffset()*-1;t=e?1e3*parseInt(t+s):1e3*parseInt(t);let n=i.ou.fromMillis(t),r="";return r=a?n.toUTC().toFormat(a):n.toUTC().toFormat("MM/dd/yyyy"),r}getUnit(t){let e;return e=t>1e12?[1e12,"TB"]:t>1e9?[1e9,"GB"]:t>1e6?[1e6,"MB"]:t>1e3?[1e3,"KB"]:[1,"KB"],e}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(l.F0),o.LFG(g.e),o.LFG(u.s),o.LFG(c.O),o.LFG(p.d),o.LFG(h.t6),o.LFG(d._))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);