"use strict";(self.webpackChunkcalix=self.webpackChunkcalix||[]).push([[2955],{12955:function(t,e,s){s.r(e),s.d(e,{FederatedDashboardModule:function(){return F}});var i=s(38583),a=s(39895),n=s(37716),r=s(81100),o=s(83249);let l=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-federated-dashboard-header"]],decls:9,vars:0,consts:[[1,"row","my-3","px-0"],[1,"col-md-6"],["src","../../../assets/img/calix-Cloud-logo.svg"],[1,"d-flex","justify-content-end"],[1,"mx-3","pt-2"],[1,""]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n._UZ(2,"img",2),n.qZA(),n.TgZ(3,"div",1),n.TgZ(4,"div",3),n.TgZ(5,"div",4),n._UZ(6,"app-grid"),n.qZA(),n.TgZ(7,"div",5),n._UZ(8,"app-dd-menu"),n.qZA(),n.qZA(),n.qZA(),n.qZA())},directives:[r.M,o.z],styles:[""]}),t})();var c=s(7450),g=s(89097);let d=(()=>{class t{constructor(t,e){this.translateService=t,this.sso=e}ngOnInit(){this.loginType=this.sso.getCscType(),this.language=this.translateService.defualtLanguage,this.languageSubject=this.translateService.selectedLanguage.subscribe(t=>{this.language=t})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(c.s),n.Y36(g.t6))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-federated-dashboard-footer"]],decls:13,vars:3,consts:[[1,"mt-4"],[1,"ftr-row","flex"],[1,"ftr-rht","flex"],[1,"flex","ftr-link"],["target","_blank","href","https://www.calix.com/pages/terms-of-use.html"],["target","_blank","href","https://www.calix.com/content/dam/calix/mycalix-misc/lib/cloud/rn/current/oc-rn.htm"],["target","_blank","href","https://www.calix.com/about-calix/contact-us.html"]],template:function(t,e){1&t&&(n.TgZ(0,"footer",0),n.TgZ(1,"div",1),n._UZ(2,"div"),n.TgZ(3,"div",2),n.TgZ(4,"div",3),n.TgZ(5,"a",4),n._uU(6),n.qZA(),n.TgZ(7,"a",5),n._uU(8),n.qZA(),n.TgZ(9,"a",6),n._uU(10),n.qZA(),n.TgZ(11,"p"),n._uU(12,"1.877.766.3500"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(6),n.Oqu(e.language.Terms_and_Conditions),n.xp6(2),n.Oqu(e.language.About_Calix_Cloud),n.xp6(2),n.Oqu(e.language.Contact_Calix))},styles:[""]}),t})(),u=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-federated-dashboard-layout"]],decls:4,vars:0,consts:[[1,"container"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n._UZ(1,"app-federated-dashboard-header"),n._UZ(2,"router-outlet"),n._UZ(3,"app-federated-dashboard-footer"),n.qZA())},directives:[l,a.lC,d],styles:[""]}),t})();var h=s(91841),p=s(3679),f=s(23771),Z=s(79765),v=s(22759),m=s(25917),b=s(54395),A=s(87519),w=s(43190),x=s(5304),T=s(92340),C=s(49342),_=s(39075);function q(t,e){if(1&t&&(n.TgZ(0,"div",11),n.TgZ(1,"div",12),n.TgZ(2,"div",13),n.TgZ(3,"span",14),n._uU(4),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&t){const t=n.oxw();n.xp6(4),n.Oqu(t.language.Loading)}}function O(t,e){if(1&t){const t=n.EpF();n.TgZ(0,"div",15),n.TgZ(1,"span",16),n._UZ(2,"img",17),n.qZA(),n.TgZ(3,"button",18),n.NdJ("click",function(){return n.CHM(t),n.oxw().closeAlert()}),n._UZ(4,"span"),n.qZA(),n._UZ(5,"div",19),n.qZA()}if(2&t){const t=n.oxw();n.xp6(5),n.Q6J("innerHtml",t.errorInfo,n.oJD)}}function I(t,e){if(1&t&&(n.TgZ(0,"div",20),n._uU(1),n.qZA()),2&t){const t=n.oxw();n.xp6(1),n.hij(" ",t.language["Access denied due to RBAC. Please consult your Organization Administrator for access."]," ")}}function L(t,e){if(1&t){const t=n.EpF();n.TgZ(0,"i",21),n.NdJ("click",function(){return n.CHM(t),n.oxw().clearSearchInp()}),n.qZA()}}function S(t,e){if(1&t){const t=n.EpF();n.TgZ(0,"tr"),n.TgZ(1,"td",26),n.NdJ("click",function(){const e=n.CHM(t).$implicit;return n.oxw(2).gotoFederatedAcccess(e.grantor_org_id)}),n._uU(2),n.qZA(),n.qZA()}if(2&t){const t=e.$implicit;n.xp6(2),n.hij(" ",t.grantor_org_name," ")}}function y(t,e){if(1&t&&(n.TgZ(0,"tbody"),n.TgZ(1,"tr"),n.TgZ(2,"td",27),n._uU(3),n.qZA(),n.qZA(),n.qZA()),2&t){const t=n.oxw(2);n.xp6(3),n.Oqu(t.language["No matching records found"])}}function E(t,e){if(1&t&&(n.TgZ(0,"div",22),n.TgZ(1,"table",23),n.TgZ(2,"thead"),n.TgZ(3,"tr"),n.TgZ(4,"th"),n._uU(5),n.qZA(),n.qZA(),n.qZA(),n.TgZ(6,"tbody"),n.YNc(7,S,3,1,"tr",24),n.qZA(),n.YNc(8,y,4,1,"tbody",25),n._UZ(9,"tbody"),n.qZA(),n.qZA()),2&t){const t=n.oxw();n.xp6(1),n.Q6J("dtOptions",t.dtOptions),n.xp6(4),n.Oqu(t.language.Name),n.xp6(2),n.Q6J("ngForOf",t.orgsList),n.xp6(1),n.Q6J("ngIf",0==(null==t.orgsList?null:t.orgsList.length)||0===t.count||0===t.filterCount)}}const U=[{path:"",component:u,children:[{path:"",component:(()=>{class t{constructor(t,e,s,i,a,n,r){this.translateService=t,this.fb=e,this.sso=s,this.http=i,this.router=a,this.commonOrgService=n,this.titleService=r,this.searchOrg=new p.NI(""),this.isSecureAccess=!1,this.dtOptions={},this.dtTrigger=new Z.xQ,this.loading=!1,this.showTable=!1,this.hasScopeAccess=!0,this.orgsList=[],this.accountsForm=this.fb.group({org:[""]}),this.errorInfo="",this.successInfo="",this.count=0}ngOnInit(){this.isSecureAccess=this.sso.isSecureAccess(),this.language=this.translateService.defualtLanguage,this.languageSubject=this.translateService.selectedLanguage.subscribe(t=>{this.language=t,this.titleService.setTitle(`${this.language.Federated} - ${this.language.Dashboards} - ${this.language["Calix Cloud"]}`)}),this.titleService.setTitle(`${this.language.Federated} - ${this.language.Dashboards} - ${this.language["Calix Cloud"]}`);let t=this.sso.getLandingPage();"grantor_orgs"===(null==t?void 0:t.toLowerCase())?(this.listenSearch(),this.subscribeCount("")):this.router.navigate(["/login"])}listenSearch(){this.searchSub=(0,v.R)(document.getElementById("search-org"),"keyup").pipe((0,b.b)(200),(0,A.x)(),(0,w.w)(t=>(this.orgsList=[],this.getCount(t.target.value)))).subscribe(t=>{(null==t?void 0:t["api-error"])||(this.filterCount=t,this.redraw())})}getCount(t){this.loading=!0;let e=`${T.N.API_BASE_URL}grantor/orgs/_count`;return t&&(e+=`?filter=${t}`),this.http.get(e).pipe((0,x.K)(t=>(t["api-error"]=!0,this.showErrorMessage(this.commonOrgService.pageErrorHandle(t)),(0,m.of)(t))))}subscribeCount(t){this.getCount(t).subscribe(e=>{(null==e?void 0:e["api-error"])||(this.count=e,this.filterCount=e,this.initLoad?this.redraw():this.getData(t))})}getData(t){this.showTable=!0,this.dtOptions={pagingType:"full_numbers",pageLength:10,serverSide:!0,processing:!1,lengthChange:!1,ordering:!1,dom:"tipr",ajax:(t,e)=>{this.http.get(`${T.N.API_BASE_URL}/grantor/orgs?offset=${t.start}&size=${t.length}&filter=${t.search.value}`).subscribe(t=>{this.orgsList=t||[],this.loading=!1,e({recordsTotal:this.count?this.count:0,recordsFiltered:null!=this.filterCount?this.filterCount:this.count,data:[]})},t=>{this.loading=!1,this.showErrorMessage(this.commonOrgService.pageErrorHandle(t)),e({recordsTotal:this.count?this.count:0,recordsFiltered:null!=this.filterCount?this.filterCount:this.count,data:[]})},()=>{this.initLoad=!0,this.loading=!1})},drawCallback:t=>{}},this.tableLanguageOptions()}ngOnDestroy(){}tableLanguageOptions(){"de_DE"==this.language.fileLanguage?this.dtOptions.language=this.translateService.de_DE:"fr"==this.language.fileLanguage?this.dtOptions.language=this.translateService.fr:"es"==this.language.fileLanguage?this.dtOptions.language=this.translateService.es:"en"==this.language.fileLanguage&&this.dtOptions.language&&delete this.dtOptions.language}gotoFederatedAcccess(t){this.loading=!0;let e=new h.WM;e=e.append("X-Calix-ClientID",T.N.X_CALIX_CLIENTID),e=e.append("Content-Type","application/x-www-form-urlencoded");let s=`client_secret=${T.N.X_CALIX_SECURE_CLIENTID}&orgid=${t}&access_token=${this.sso.getAccessToken()}`;this.doSub=this.http.post(`${T.N.API_BASE_URL}grantor/changeorg`,s,{headers:e}).subscribe(t=>{var e;if(this.loading=!1,t.access_token){if(!(null===(e=null==t?void 0:t.entitlements)||void 0===e?void 0:e.length))return void this.showErrorMessage(this.language["Error: No Valid Entitlement"]);let s=this.sso.showApps(t),i=Object.keys(s),a=!1;if(null==i||i.forEach(t=>{s[t]&&(a=!0)}),!a)return void this.showErrorMessage(this.language["Error: No Valid Entitlement"]);this.sso.setCSCLoggedIn(!1),this.sso.setLoginInfo(t),this.sso.setFederatedLogin(!0),t.landingPage&&"cco"==t.landingPage.toLowerCase()&&s.cco?this.router.navigate(["/cco"]):t.landingPage&&"cmc"==t.landingPage.toLowerCase()&&s.cmc?this.router.navigate(["/engagement"]):t.landingPage&&("csc"==t.landingPage.toLowerCase()||"main page"==t.landingPage.toLowerCase())&&s.csc?this.router.navigate(["/support"]):t.landingPage&&"DC"==t.landingPage.toLowerCase()&&s.foundation?this.router.navigate(["/cco-foundation"]):this.gotoDP()}},t=>{this.loading=!1})}gotoDP(){this.router.navigate([this.sso.getDefaultRoute()])}closeAlert(){this.error=!1,this.success=!1}showErrorMessage(t){this.closeAlert(),this.errorInfo=t,this.error=!0,this.loading=!1}clearSearchInp(){this.searchOrg.setValue(""),this.subscribeCount("")}redraw(){var t,e;null===(e=null===(t=this.dtElement)||void 0===t?void 0:t.dtInstance)||void 0===e||e.then(t=>{t.search(this.searchOrg.value).draw()})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(c.s),n.Y36(p.qu),n.Y36(g.t6),n.Y36(h.eN),n.Y36(a.F0),n.Y36(C.v),n.Y36(_.Dx))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-federated-dashboard"]],viewQuery:function(t,e){if(1&t&&n.Gf(f.G,5),2&t){let t;n.iGM(t=n.CRH())&&(e.dtElement=t.first)}},decls:14,vars:8,consts:[[1,"row"],["class","loader",4,"ngIf"],["class","w-100 alert alert-danger  fade show",4,"ngIf"],[1,"col-md-12"],[1,"sub-imp-title","d-flex","justify-content-between"],[1,""],["role","alert","class","alert alert-warning",4,"ngIf"],[1,"col-md-3","smy-2","ccl-form","mt-4","position-relative","px-0"],["id","search-org",1,"ccl-input",3,"placeholder","formControl"],["class","search-close fas fa-times",3,"click",4,"ngIf"],["class","sub-imp-table",4,"ngIf"],[1,"loader"],[1,"d-flex","justify-content-center"],[1,"spinner-border","text-primary"],[1,"sr-only"],[1,"w-100","alert","alert-danger","fade","show"],[1,"error-img"],["src","./assets/img/ic_error-36px.svg"],["type","button",1,"close",3,"click"],[1,"d-inline-flex",3,"innerHtml"],["role","alert",1,"alert","alert-warning"],[1,"search-close","fas","fa-times",3,"click"],[1,"sub-imp-table"],["datatable","",1,"table","table-borderless","w-100",3,"dtOptions"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"pointer","blue",3,"click"],["colspan","5",1,"no-data-available"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.YNc(1,q,5,1,"div",1),n.YNc(2,O,6,1,"div",2),n.TgZ(3,"div",3),n.TgZ(4,"div",4),n.TgZ(5,"div",5),n._uU(6),n.qZA(),n.qZA(),n.qZA(),n.YNc(7,I,2,1,"div",6),n.qZA(),n.TgZ(8,"div",0),n.TgZ(9,"div",3),n.TgZ(10,"div",7),n._UZ(11,"input",8),n.YNc(12,L,1,0,"i",9),n.qZA(),n.YNc(13,E,10,4,"div",10),n.qZA(),n.qZA()),2&t&&(n.xp6(1),n.Q6J("ngIf",e.loading),n.xp6(1),n.Q6J("ngIf",e.error),n.xp6(4),n.Oqu(e.language.selectAnOrganization),n.xp6(1),n.Q6J("ngIf",!e.hasScopeAccess),n.xp6(4),n.s9C("placeholder",e.language["Search Orgs"]),n.Q6J("formControl",e.searchOrg),n.xp6(1),n.Q6J("ngIf",null==e.searchOrg?null:e.searchOrg.value),n.xp6(1),n.Q6J("ngIf",e.showTable))},directives:[i.O5,p.Fj,p.JJ,p.oH,f.G,i.sg],styles:[".blue[_ngcontent-%COMP%]{color:#00f!important}.search-close[_ngcontent-%COMP%]{position:absolute;right:15px;top:10px;color:#cdcdcd;cursor:pointer}  table.dataTable td.dataTables_empty{display:none}"]}),t})(),pathMatch:"full",data:{title:"Calix Cloud - Federated Dashboard"}}]}];let N=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[a.Bz.forChild(U)],a.Bz]}),t})();var k=s(23830),D=s(86640);let F=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[i.ez,N,k.o,D.A0,f.T,p.u5,p.UX]]}),t})()}}]);