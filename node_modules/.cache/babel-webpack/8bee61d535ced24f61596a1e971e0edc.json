{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app-services/translate.service\";\nimport * as i2 from \"../../shared/service/protect-iq.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../../shared/top-nav-bar/top-nav-bar.component\";\nfunction ProtectIqSecuritySettingsComponent_top_nav_bar_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"top-nav-bar\", 11);\n    i0.ɵɵlistener(\"activeTab\", function ProtectIqSecuritySettingsComponent_top_nav_bar_0_Template_top_nav_bar_activeTab_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.selectedTab($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"menus\", ctx_r0.menus);\n  }\n}\nfunction ProtectIqSecuritySettingsComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵelementStart(1, \"div\", 13);\n    i0.ɵɵelement(2, \"img\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"div\", 15);\n    i0.ɵɵelementStart(4, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ProtectIqSecuritySettingsComponent_div_2_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.errorMessage = \"\";\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"innerHtml\", ctx_r1.errorMessage, i0.ɵɵsanitizeHtml);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.language.OK, \" \");\n  }\n}\nfunction ProtectIqSecuritySettingsComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵelementStart(1, \"div\", 18);\n    i0.ɵɵelementStart(2, \"div\", 19);\n    i0.ɵɵelementStart(3, \"span\", 20);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r2.language.Loading);\n  }\n}\nexport let ProtectIqSecuritySettingsComponent = /*#__PURE__*/(() => {\n  class ProtectIqSecuritySettingsComponent {\n    constructor(translateService, protectIqService) {\n      this.translateService = translateService;\n      this.protectIqService = protectIqService;\n      this.menus = [{\n        label: 'Primary Network',\n        value: 'primary-network',\n        state: 'active'\n      }, {\n        label: 'Staff Network',\n        value: 'staff-network'\n      }, {\n        label: 'Point of Sale',\n        value: 'point-of-sale'\n      }, {\n        label: 'Customer Portal',\n        value: 'customer-portal'\n      }];\n      this.loading = true;\n      this.isLatestVersion = false;\n      this.errorMessage = '';\n      this.userId = '';\n      this.roleId = 0;\n      this.securitySettings = {\n        protocolAnomaly: false,\n        portScanDefence: false\n      };\n    }\n    ngOnInit() {\n      this.language = this.translateService.defualtLanguage;\n      this.languageSubscription = this.translateService.selectedLanguage.subscribe(language => {\n        this.language = language;\n      });\n      this.userId = history.state.userId;\n      this.isLatestVersion = history.state.isLatestVersion;\n      this.loadData();\n    }\n    loadData() {\n      this.loading = true;\n      let apiCall = this.protectIqService.getSecurityList(this.userId);\n      if (this.roleId) {\n        apiCall = this.protectIqService.getSecurityListByRole(this.userId, this.roleId);\n      }\n      apiCall.subscribe(response => {\n        var _a, _b, _c, _d;\n        let securitySettings = response.securitySettings;\n        if (securitySettings.count) {\n          this.securitySettings = {\n            protocolAnomaly: (_b = (_a = securitySettings.data.find(element => element.name == 'PA')) === null || _a === void 0 ? void 0 : _a.enabled) !== null && _b !== void 0 ? _b : false,\n            portScanDefence: (_d = (_c = securitySettings.data.find(element => element.name == 'PSD')) === null || _c === void 0 ? void 0 : _c.enabled) !== null && _d !== void 0 ? _d : false\n          };\n        }\n        this.loading = false;\n      }, error => {\n        this.loading = false;\n        this.errorMessage = this.protectIqService.errorHandler(error);\n      });\n    }\n    onSettingChange(type) {\n      this.loading = true;\n      let payload = {\n        userId: this.userId,\n        roleId: this.roleId,\n        securitySettings: [{\n          type: type == 'PA' ? 1 : 2,\n          enabled: type == 'PA' ? this.securitySettings.protocolAnomaly : this.securitySettings.portScanDefence\n        }]\n      };\n      let apiCall = this.protectIqService.setSecuritySettings(payload);\n      if (this.roleId) {\n        payload['roleId'] = this.roleId;\n        apiCall = this.protectIqService.setSecuritySettingsByRole(payload);\n      }\n      apiCall.subscribe(() => {\n        this.loadData();\n      }, error => {\n        this.loading = false;\n        this.errorMessage = this.protectIqService.errorHandler(error);\n      });\n    }\n    selectedTab(activeTab) {\n      this.roleId = 0;\n      if (activeTab == 'staff-network') this.roleId = 2;\n      if (activeTab == 'customer-portal') this.roleId = 3;\n      if (activeTab == 'point-of-sale') this.roleId = 4;\n      this.loadData();\n    }\n  }\n  ProtectIqSecuritySettingsComponent.ɵfac = function ProtectIqSecuritySettingsComponent_Factory(t) {\n    return new (t || ProtectIqSecuritySettingsComponent)(i0.ɵɵdirectiveInject(i1.TranslateService), i0.ɵɵdirectiveInject(i2.ProtectIqService));\n  };\n  ProtectIqSecuritySettingsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProtectIqSecuritySettingsComponent,\n    selectors: [[\"app-protect-iq-security-settings\"]],\n    decls: 22,\n    vars: 7,\n    consts: [[3, \"menus\", \"activeTab\", 4, \"ngIf\"], [1, \"security-settings\", \"mt-4\"], [\"class\", \"w-100 alert alert alert-danger fade show d-flex justify-content-between align-items-center\", 4, \"ngIf\"], [\"class\", \"loader\", 4, \"ngIf\"], [1, \"row\", \"col-5\"], [1, \"col-12\", \"toggles-switch\"], [1, \"toggle-swtbtn\", \"checkbox\", \"switcher\", \"d-flex\", \"justify-content-between\"], [1, \"cco-list-label\"], [\"type\", \"checkbox\", \"name\", \"protocolAnomaly\", \"id\", \"protocol-anomaly\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [1, \"mr-1\"], [\"type\", \"checkbox\", \"name\", \"portScanDefence\", \"id\", \"port-scan-defence\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [3, \"menus\", \"activeTab\"], [1, \"w-100\", \"alert\", \"alert\", \"alert-danger\", \"fade\", \"show\", \"d-flex\", \"justify-content-between\", \"align-items-center\"], [1, \"error-img\"], [\"src\", \"./assets/img/ic_error-36px.svg\"], [1, \"d-inline-flex\", \"wrn-msg\", 3, \"innerHtml\"], [\"type\", \"button\", 1, \"btn-default\", \"primary\", \"ok\", 3, \"click\"], [1, \"loader\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"spinner-border\", \"text-primary\"], [1, \"sr-only\"]],\n    template: function ProtectIqSecuritySettingsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ProtectIqSecuritySettingsComponent_top_nav_bar_0_Template, 1, 1, \"top-nav-bar\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵtemplate(2, ProtectIqSecuritySettingsComponent_div_2_Template, 6, 2, \"div\", 2);\n        i0.ɵɵtemplate(3, ProtectIqSecuritySettingsComponent_div_3_Template, 5, 1, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\", 6);\n        i0.ɵɵelementStart(7, \"span\", 7);\n        i0.ɵɵtext(8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"label\");\n        i0.ɵɵelementStart(10, \"input\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function ProtectIqSecuritySettingsComponent_Template_input_ngModelChange_10_listener($event) {\n          return ctx.securitySettings.protocolAnomaly = $event;\n        })(\"change\", function ProtectIqSecuritySettingsComponent_Template_input_change_10_listener() {\n          return ctx.onSettingChange(\"PA\");\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"span\", 9);\n        i0.ɵɵelement(12, \"small\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 4);\n        i0.ɵɵelementStart(14, \"div\", 5);\n        i0.ɵɵelementStart(15, \"div\", 6);\n        i0.ɵɵelementStart(16, \"span\", 7);\n        i0.ɵɵtext(17);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"label\");\n        i0.ɵɵelementStart(19, \"input\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function ProtectIqSecuritySettingsComponent_Template_input_ngModelChange_19_listener($event) {\n          return ctx.securitySettings.portScanDefence = $event;\n        })(\"change\", function ProtectIqSecuritySettingsComponent_Template_input_change_19_listener() {\n          return ctx.onSettingChange(\"PSD\");\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"span\", 9);\n        i0.ɵɵelement(21, \"small\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.isLatestVersion);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(ctx.language[\"IPS Protocol Anomaly\"]);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.securitySettings.protocolAnomaly);\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate(ctx.language[\"IPS Port Scan Defense\"]);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.securitySettings.portScanDefence);\n      }\n    },\n    directives: [i3.NgIf, i4.CheckboxControlValueAccessor, i4.NgControlStatus, i4.NgModel, i5.TopNavBarComponent],\n    styles: [\".wrn-msg[_ngcontent-%COMP%]{width:85%}\"]\n  });\n  return ProtectIqSecuritySettingsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}