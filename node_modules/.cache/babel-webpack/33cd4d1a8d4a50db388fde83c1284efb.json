{"ast":null,"code":"import { combineLatest, Subject, concat, of } from 'rxjs';\nimport { environment } from '../../../environments/environment';\nimport { DataTableDirective } from 'angular-datatables';\n// import { AuthService } from '../../shared/services/auth.service';\nimport { catchError, map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../shared/services/custom-translate.service\";\nimport * as i2 from \"../services/common.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"../services/organizations.service\";\nimport * as i5 from \"src/app/shared/services/sso-auth.service\";\nimport * as i6 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i7 from \"@angular/platform-browser\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"@ng-select/ng-select\";\nimport * as i10 from \"@angular/forms\";\nimport * as i11 from \"angular-datatables\";\nconst _c0 = [\"deleteModal\"];\nfunction OrganizationDetailComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵelementStart(1, \"div\", 26);\n    i0.ɵɵelementStart(2, \"div\", 27);\n    i0.ɵɵelementStart(3, \"span\", 28);\n    i0.ɵɵtext(4, \"Loading...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nfunction OrganizationDetailComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵelementStart(1, \"span\", 30);\n    i0.ɵɵelement(2, \"img\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_div_2_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.closeAlert();\n    });\n    i0.ɵɵelement(4, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"div\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"innerHtml\", ctx_r1.errorInfo, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction OrganizationDetailComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 34);\n    i0.ɵɵelementStart(1, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_div_3_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.closeAlert();\n    });\n    i0.ɵɵelement(2, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"div\", 35);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"innerHtml\", ctx_r2.successInfo, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction OrganizationDetailComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵelementStart(1, \"span\", 30);\n    i0.ɵɵelement(2, \"img\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_div_25_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.closeAlertWarning();\n    });\n    i0.ɵɵelement(4, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"div\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"innerHtml\", ctx_r3.warningInfo, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction OrganizationDetailComponent_tr_34_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 36);\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 37);\n    i0.ɵɵelementStart(4, \"i\", 38);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_tr_34_Template_i_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const item_r15 = restoredCtx.$implicit;\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.deleteUser(item_r15);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r15 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"id\", item_r15.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", item_r15.username, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"title\", ctx_r4.language.delete);\n  }\n}\nconst _c1 = function () {\n  return [\"active\", \"about_to_expire\", \"in_grace_period\"];\n};\nconst _c2 = function () {\n  return {\n    standalone: true\n  };\n};\nfunction OrganizationDetailComponent_div_39_tr_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵelement(2, \"input\", 44);\n    i0.ɵɵelement(3, \"input\", 45);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 42);\n    i0.ɵɵelementStart(6, \"div\", 46);\n    i0.ɵɵelementStart(7, \"label\", 47);\n    i0.ɵɵelementStart(8, \"input\", 48);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_div_39_tr_16_Template_input_click_8_listener($event) {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext(2);\n      return ctx_r21.preventClick($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\u00A0\\u00A0\\u00A0 \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\", 42);\n    i0.ɵɵelementStart(11, \"div\", 46);\n    i0.ɵɵelementStart(12, \"label\", 47);\n    i0.ɵɵelementStart(13, \"input\", 49);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_div_39_tr_16_Template_input_click_13_listener($event) {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r23 = i0.ɵɵnextContext(2);\n      return ctx_r23.preventClick($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \" \\u00A0\\u00A0\\u00A0 \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"td\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"td\");\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"td\", 50);\n    i0.ɵɵelement(20, \"input\", 51);\n    i0.ɵɵelementStart(21, \"ng-select\", 52);\n    i0.ɵɵlistener(\"ngModelChange\", function OrganizationDetailComponent_div_39_tr_16_Template_ng_select_ngModelChange_21_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r22);\n      const i_r20 = restoredCtx.index;\n      const ctx_r24 = i0.ɵɵnextContext(2);\n      return ctx_r24.entStatus[i_r20] = $event;\n    })(\"change\", function OrganizationDetailComponent_div_39_tr_16_Template_ng_select_change_21_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r22);\n      const i_r20 = restoredCtx.index;\n      const ctx_r25 = i0.ɵɵnextContext(2);\n      ctx_r25.removePlaceholder(i_r20);\n      return ctx_r25.showSubmitButtons = true;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r19 = ctx.$implicit;\n    const i_r20 = ctx.index;\n    const ctx_r18 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"value\", item_r19.appType);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"value\", item_r19.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r19.name, \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassMapInterpolate1(\"\", item_r19.appType, \" not-allow d-none\");\n    i0.ɵɵpropertyInterpolate1(\"id\", \"\", item_r19.appType, \"_entitled\");\n    i0.ɵɵpropertyInterpolate(\"value\", item_r19.appType);\n    i0.ɵɵproperty(\"checked\", i0.ɵɵpureFunction0(24, _c1).includes((ctx_r18.entStatus[i_r20] || \"\").toLowerCase()))(\"readonly\", true);\n    i0.ɵɵadvance(5);\n    i0.ɵɵclassMapInterpolate1(\"\", item_r19.appType, \" not-allow d-none\");\n    i0.ɵɵpropertyInterpolate1(\"id\", \"\", item_r19.appType, \"_inherited\");\n    i0.ɵɵproperty(\"checked\", false)(\"readonly\", true);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r19.startDate ? item_r19.startDate : \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r19.endDate ? item_r19.endDate : \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"value\", item_r19.overrideEndDate);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"placeholder\", ctx_r18.language[\"Select\"]);\n    i0.ɵɵproperty(\"id\", \"status-list\" + i_r20)(\"items\", ctx_r18.statusList)(\"ngModel\", ctx_r18.entStatus[i_r20])(\"ngModelOptions\", i0.ɵɵpureFunction0(25, _c2));\n  }\n}\nfunction OrganizationDetailComponent_div_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵelementStart(1, \"form\", 40);\n    i0.ɵɵelementStart(2, \"table\", 41);\n    i0.ɵɵelementStart(3, \"thead\", 19);\n    i0.ɵɵelementStart(4, \"tr\");\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"th\", 42);\n    i0.ɵɵelement(8, \"th\", 42);\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"tbody\");\n    i0.ɵɵtemplate(16, OrganizationDetailComponent_div_39_tr_16_Template, 22, 26, \"tr\", 43);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"dtOptions\", ctx_r5.dtOptions);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r5.language.appName);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r5.language.salesStartdate);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r5.language.salesEnddate);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r5.language.Status);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.entitlements);\n  }\n}\nfunction OrganizationDetailComponent_div_40_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 53);\n    i0.ɵɵelementStart(1, \"div\", 54);\n    i0.ɵɵelementStart(2, \"button\", 55);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_div_40_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r26 = i0.ɵɵnextContext();\n      return ctx_r26.save();\n    });\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 56);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_div_40_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r28 = i0.ɵɵnextContext();\n      return ctx_r28.cancel();\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r6.language.saveEnregistrer);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r6.language.Cancel);\n  }\n}\nfunction OrganizationDetailComponent_ng_template_41_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r32 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 57);\n    i0.ɵɵelementStart(1, \"h4\", 58);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 59);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_ng_template_41_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const ctx_r31 = i0.ɵɵnextContext();\n      return ctx_r31.closeModal();\n    });\n    i0.ɵɵelement(4, \"span\", 60);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 61);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 62);\n    i0.ɵɵelementStart(8, \"button\", 63);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_ng_template_41_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const ctx_r33 = i0.ɵɵnextContext();\n      return ctx_r33.confirmDeleteSecleted();\n    });\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 64);\n    i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_ng_template_41_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const ctx_r34 = i0.ɵɵnextContext();\n      return ctx_r34.closeModal();\n    });\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r8.modalTitle);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r8.language[\"Are you sure you want to delete this administrator\"], \"? (\", ctx_r8.modalInfo, \") \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r8.language.yes);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r8.language.no);\n  }\n}\nconst $ = require('jquery');\nexport let OrganizationDetailComponent = /*#__PURE__*/(() => {\n  class OrganizationDetailComponent {\n    constructor(customTranslateService, commonOrgService, router, api, sso, dialogService, titleService) {\n      this.customTranslateService = customTranslateService;\n      this.commonOrgService = commonOrgService;\n      this.router = router;\n      this.api = api;\n      this.sso = sso;\n      this.dialogService = dialogService;\n      this.titleService = titleService;\n      this.pageAvailable = false;\n      this.languages = [{\n        name: \"English\"\n      }, {\n        name: \"French Canadian\"\n      }];\n      this.appsTableData = [];\n      this.userTableOptions = {};\n      this.entitlementAvailable = false;\n      this.roles = [];\n      this.usersList = []; // All users\n      this.addedUsersList = []; // Added users list\n      this.dtTrigger = new Subject();\n      this.isRerender = false;\n      this.tableOptions = {\n        pagingType: 'full_numbers',\n        pageLength: 10,\n        processing: true,\n        searching: false,\n        ordering: false,\n        lengthChange: false,\n        language: {\n          emptyTable: \"No users available in table\"\n        },\n        drawCallback: settings => {\n          let total = settings.aoData.length;\n          let length = settings._iDisplayLength;\n          if (total <= length) {\n            $(settings.nTableWrapper).find(`#${settings.sTableId}_last`).addClass('disabled');\n          }\n        }\n      };\n      this.dtOptions = {\n        lengthChange: false,\n        searching: false,\n        ordering: false,\n        paging: false,\n        dom: 't'\n      };\n      this.loader = true;\n      this.errorInfo = '';\n      this.successInfo = '';\n      this.warningInfo = '';\n      this.endDates = {\n        '118_endDate': '',\n        '119_endDate': '',\n        '120_endDate': '',\n        '122_endDate': '',\n        '131_endDate': '',\n        '200_endDate': '',\n        '201_endDate': '',\n        '202_endDate': '',\n        '203_endDate': '',\n        '204_endDate': '',\n        '205_endDate': ''\n      };\n      this.usersCount = 0;\n      this.showSubmitButtons = false;\n      this.orgRoleAvail = true;\n      this.sysAdminRoute = 'systemAdministration';\n      this.model = {\n        year: parseInt(\"2020\"),\n        month: parseInt(\"10\"),\n        day: parseInt(\"1\")\n      };\n      this.statusList = [];\n      this.entStatus = [];\n      let url = this.router.url;\n      this.ORG_ID = this.sso.getOrganizationID(url);\n      this.commonOrgService.currentPageAdder('orgDetail');\n      this.orgData = JSON.parse(sessionStorage.getItem('calixAdminOrgDetail'));\n      if (this.orgData) {\n        this.orgName = this.orgData.name ? this.orgData.name : 'Calix';\n      }\n      this.getData();\n      this.sysAdminRoute = environment.SYS_ADMIN_ROUTE;\n      let MODULE = this.sso.getRedirectModule(url);\n    }\n    ngOnInit() {\n      let url = this.router.url;\n      let MODULE = this.sso.getRedirectModule(url);\n      this.language = this.customTranslateService.defualtLanguage;\n      if (this.language) {\n        this.pageAvailable = true;\n      }\n      this.translateSubscribe = this.customTranslateService.selectedLanguage.subscribe(data => {\n        this.language = data;\n        this.loader = true;\n        this.dataAvailable = false;\n        this.isRerender = true;\n        this.renderUsersTable('language');\n        this.titleService.setTitle(`${this.language['Organization detail']} - ${MODULE === 'systemAdministration' ? this.language['System Administration'] : this.language['administration']} - ${this.language['Calix Cloud']}`);\n      });\n      this.titleService.setTitle(`${this.language['Organization detail']} - ${MODULE === 'systemAdministration' ? this.language['System Administration'] : this.language['administration']} - ${this.language['Calix Cloud']}`);\n      this.frTable = this.customTranslateService.fr;\n      this.tableLanguageOptions();\n      this.closeAlert();\n      this.setYearRange();\n      this.statusList = [\n      //{ label: '', value: '' },\n      {\n        label: this.language['Active'],\n        value: 'active'\n      }, {\n        label: this.language['About to Expire'],\n        value: \"about_to_expire\"\n      }, {\n        label: this.language['In Grace Period'],\n        value: \"in_grace_period\"\n      }, {\n        label: this.language['Expired'],\n        value: \"expired\"\n      }];\n    }\n    ngAfterViewInit() {\n      //this.dtTrigger.next();\n    }\n    ngOnDestroy() {\n      if (this.parallelReqSubscribtion) {\n        this.parallelReqSubscribtion.unsubscribe();\n      }\n      if (this.usersAvailInterval) {\n        clearInterval(this.usersAvailInterval);\n      }\n      if (this.translateSubscribe) {\n        this.translateSubscribe.unsubscribe();\n      }\n    }\n    getData() {\n      //this.getOrgEntitlements();\n      const requestEndpoints = [`${environment.CALIX_ADMIN_ORG_BASE_URL}entitlements/cloud/all`, `${environment.CALIX_ADMIN_ORG_BASE_URL}entitlements/${this.ORG_ID}`, `${environment.CALIX_ADMIN_BASE_URL}org/${this.ORG_ID}/roles`, `${environment.CALIX_ADMIN_BASE_URL}org/${this.ORG_ID}/users/_count`];\n      const requests = [];\n      requestEndpoints.forEach(endpoint => {\n        const req = this.api.callRestApi(endpoint).pipe(map(res => {\n          return res;\n        }), catchError(error => {\n          return of(error);\n        }));\n        requests.push(req);\n      });\n      this.combineLatest = combineLatest(requests);\n      this.makeParallelRequest();\n    }\n    makeParallelRequest() {\n      this.parallelReqSubscribtion = this.combineLatest.subscribe(response => {\n        this.entitlements = response[0];\n        this.orgEntitlements = response[1];\n        this.roles = response[2];\n        this.usersCount = response[3];\n        if (response.length) {\n          for (let e of response) {\n            if (e != null && e.error != undefined) {\n              this.loader = false;\n              this.pageErrorHandle(e);\n              this.commonOrgService.pageScrollTop();\n              this.addedUsersList = [];\n              this.renderUsersTable();\n              this.entitlementAvailable = true;\n              return;\n            }\n          }\n        }\n        if (this.roles.length) {\n          this.getOrgAdminUsers();\n        } else {\n          this.addedUsersList = [];\n          this.renderUsersTable();\n        }\n        if (this.orgEntitlements) {\n          this.combineData();\n        }\n        this.getOrgUsersList();\n      }, err => {\n        this.loader = false;\n        this.pageErrorHandle(err);\n        this.commonOrgService.pageScrollTop();\n      }, () => {\n        this.loader = false;\n      });\n    }\n    getOrgUsersList() {\n      this.api.UsersListByOrgId(this.ORG_ID, this.usersCount).subscribe(res => {\n        this.usersList = res ? res : [];\n        this.usersAvail = true;\n      }, err => {\n        this.loader = false;\n        this.pageErrorHandle(err);\n        this.commonOrgService.pageScrollTop();\n      });\n    }\n    getOrgAdminUsers() {\n      var orgRole = this.roles.filter(obj => {\n        return obj.name === 'OrgAdmin';\n      });\n      if (orgRole && orgRole.length) {\n        this.orgAdminRoleId = orgRole[0]._id;\n        this.roleData();\n        this.orgRoleAvail = true;\n      } else {\n        this.orgRoleAvail = false;\n        this.addedUsersList = [];\n        this.renderUsersTable();\n        this.errorInfo = this.language['Role (null) not found'];\n        this.error = true;\n        this.commonOrgService.pageScrollTop();\n      }\n    }\n    roleData() {\n      this.api.RoleData(this.orgAdminRoleId).subscribe(res => {\n        this.addedUsersList = res.users ? this.addId(res.users) : [];\n        this.renderUsersTable();\n        setTimeout(() => {\n          this.checkSelected();\n        }, 500);\n      }, err => {\n        this.loader = false;\n        this.pageErrorHandle(err);\n        this.commonOrgService.pageScrollTop();\n        this.addedUsersList = [];\n        this.renderUsersTable();\n      });\n    }\n    addId(users) {\n      users.forEach(e => {\n        e['_id'] = e.userId;\n      });\n      return users;\n    }\n    addUser() {\n      this.warning = false;\n      let selUsers = this.selectedUsers;\n      let added = [];\n      let index;\n      selUsers.forEach(sel => {\n        if (this.addedUsersList.filter(e => e._id === sel._id).length > 0) {\n          this.warningInfo = `${sel.username} - User already added`;\n          this.warning = true;\n          return;\n        }\n        index = this.usersList.findIndex(e => e._id === sel._id);\n        this.usersList[index]['disabled'] = true;\n        this.usersList = [...this.usersList];\n        added.push(sel);\n      });\n      if (this.warning) {\n        return;\n      }\n      this.addedUsersList = [...this.addedUsersList, ...added];\n      this.selectedUsers = [];\n      //this.redraw();\n      this.isRerender = true;\n      this.renderUsersTable();\n      this.showButtons();\n    }\n    deleteUser(item) {\n      this.deleteItem = item;\n      this.modalTitle = this.language['Delete Administrator'];\n      this.modalInfo = `${item.username}`;\n      this.closeModal();\n      this.modalRef = this.dialogService.open(this.deleteModal, {\n        backdrop: 'static',\n        keyboard: false\n      });\n    }\n    confirmDeleteSecleted() {\n      this.closeModal();\n      let item = this.deleteItem;\n      let temp = [];\n      let index;\n      this.addedUsersList.forEach(element => {\n        if (element._id !== item._id) {\n          temp.push(element);\n        }\n      });\n      index = this.usersList.findIndex(e => e._id === item._id);\n      if (index !== -1) {\n        this.usersList[index]['disabled'] = false;\n      }\n      this.usersList = [...this.usersList];\n      this.addedUsersList = temp;\n      this.isRerender = true;\n      this.renderUsersTable();\n      this.deleteItem = undefined;\n      this.showButtons();\n    }\n    renderUsersTable(type) {\n      this.setTableOptions();\n      if (type && type == 'language') {\n        setTimeout(() => {\n          if (this.isRerender) {\n            this.rerender();\n            this.isRerender = false;\n          } else {\n            this.dtTrigger.next();\n          }\n          this.loader = false;\n        }, 50);\n      } else {\n        if (this.isRerender) {\n          this.rerender();\n          this.isRerender = false;\n        } else {\n          this.dtTrigger.next();\n        }\n      }\n    }\n    setTableOptions() {\n      this.tableOptions = {\n        pagingType: 'full_numbers',\n        pageLength: 10,\n        processing: true,\n        searching: false,\n        ordering: false,\n        lengthChange: false,\n        language: {\n          emptyTable: \"No users available in table\"\n        },\n        drawCallback: settings => {\n          let total = settings.aoData.length;\n          let length = settings._iDisplayLength;\n          if (total <= length) {\n            $(settings.nTableWrapper).find(`#${settings.sTableId}_last`).addClass('disabled');\n          }\n        }\n        // paging: false\n      };\n\n      this.tableLanguageOptions();\n      this.dataAvailable = true;\n      setTimeout(() => {\n        this.hideSearch();\n      }, 500);\n    }\n    rerender() {\n      this.dtElement.dtInstance.then(dtInstance => {\n        // Destroy the table first\n        dtInstance.destroy();\n        this.dtTrigger.next();\n      });\n    }\n    redraw() {\n      this.dtElement.dtInstance.then(dtInstance => {\n        dtInstance.draw();\n      });\n    }\n    languageChange(language) {\n      sessionStorage.setItem('defaultLanguage', language);\n      this.customTranslateService.changeLanguage(language);\n    }\n    someClickHandler(info) {\n      //this.message = info.id + ' - ' + info.firstName;\n    }\n    addOrg() {\n      this.router.navigate([`${this.sysAdminRoute}/addOrg`]);\n    }\n    goToOrgList() {\n      this.router.navigate([`${this.sysAdminRoute}/organizations`]);\n    }\n    goToUserList() {\n      this.router.navigate([`${this.sysAdminRoute}/blacklist`]);\n    }\n    processData(res) {\n      let data = res;\n      let cscObj = {};\n      for (let i = 0; i < data.length; i++) {\n        cscObj[data[i].appType] = data[i].overrideEndDate;\n      }\n      this.selectedEntitlements = cscObj;\n    }\n    combineData() {\n      let orgEntitle = {};\n      let allEntitle = [];\n      let temp = {};\n      let check = false;\n      let date = new Date();\n      let currentDate = date.getTime();\n      for (let i = 0; i < this.orgEntitlements.length; i++) {\n        orgEntitle[this.orgEntitlements[i].appType] = this.orgEntitlements[i];\n      }\n      let appType;\n      let greenColor = false;\n      for (let i = 0; i < this.entitlements.length; i++) {\n        greenColor = false;\n        appType = this.entitlements[i].appType;\n        let overrideEndDate_obj_date;\n        if (orgEntitle[appType]) {\n          //check = this.checkDate(orgEntitle[appType].overrideEndDate);\n          overrideEndDate_obj_date = orgEntitle[appType].overrideEndDate ? new Date(orgEntitle[appType].overrideEndDate) : undefined;\n          check = this.checkEnttlmnt(orgEntitle[appType]);\n          let overriddenDateTime = orgEntitle[appType].overrideEndDate ? new Date(`${orgEntitle[appType].overrideEndDate} 23:59:59`) : new Date();\n          overriddenDateTime = overriddenDateTime.getTime();\n          if (overriddenDateTime && overriddenDateTime >= currentDate) {\n            greenColor = true;\n          }\n          allEntitle.push(Object.assign(Object.assign({}, orgEntitle[appType]), {\n            checked: check,\n            override: `${appType}_endDate`,\n            greenColor: greenColor,\n            overrideEndDate_obj_date: overrideEndDate_obj_date,\n            overrideEndDate_obj: {\n              day: 1,\n              month: 11,\n              year: 2020\n            }\n          }));\n          temp[appType] = Object.assign(Object.assign({}, orgEntitle[appType]), {\n            checked: check,\n            override: `${appType}_endDate`,\n            greenColor: greenColor,\n            overrideEndDate_obj_date: overrideEndDate_obj_date,\n            overrideEndDate_obj: {\n              day: 1,\n              month: 11,\n              year: 2020\n            }\n          });\n          this.endDates[`${appType}_endDate`] = orgEntitle[appType].overrideEndDate; //new Date(orgEntitle[appType].overrideEndDate);\n        } else {\n          allEntitle.push(Object.assign(Object.assign({}, this.entitlements[i]), {\n            overrideEndDate: null,\n            checked: false,\n            override: `${appType}_endDate`,\n            overrideEndDate_obj_date: undefined,\n            overrideEndDate_obj: {\n              day: 1,\n              month: 11,\n              year: 2020\n            }\n          }));\n        }\n      }\n      this.selectedEntitlements = temp;\n      this.entitlements = allEntitle;\n      this.entitlements = this.sortByTimestamp(this.entitlements, 'timestamp', 'desc');\n      this.entStatus = this.entitlements.map(obj => (obj.status || '').toLowerCase());\n      setTimeout(() => {\n        this.entStatus.forEach((elem, i) => {\n          if (!elem) $(`#status-list${i} input`).attr('placeholder', this.language['Select']);\n        });\n      }, 100);\n      this.entitlementAvailable = true;\n      this.loader = false;\n    }\n    checkEnttlmnt(data) {\n      let date = new Date();\n      let currentDate = date.getTime();\n      let endDate = '';\n      let overriddenDate = '';\n      endDate = data.endDate ? new Date(data.endDate) : \"\";\n      overriddenDate = data.overrideEndDate ? new Date(`${data.overrideEndDate} 23:59:59`) : \"\";\n      if (data.entitlement && (!endDate && !overriddenDate && !data.endDate || endDate && endDate > currentDate || overriddenDate && overriddenDate > currentDate)) {\n        return true;\n      }\n      return false;\n    }\n    setOverrideDate(event, data, appType, ovrRdeDate) {\n      if (!ovrRdeDate) {\n        this.clearOverrideEndDate(event, data, appType, ovrRdeDate);\n        return;\n      }\n      let entitlements = this.entitlements;\n      let obj = entitlements.find((obj, index) => {\n        this.objIndex = index;\n        return obj.appType == appType;\n      });\n      let date = new Date();\n      let currentDate = date.getTime();\n      let endDate = '';\n      //let overriddenDate: any = event;\n      let overriddenDate = `${ovrRdeDate} 23:59:59`;\n      let overriddenDateTime;\n      endDate = data.endDate ? new Date(data.endDate).getTime() : \"\";\n      overriddenDateTime = new Date(overriddenDate);\n      overriddenDateTime = overriddenDateTime.getTime();\n      if (data.entitlement && (!endDate && !overriddenDate && !data.endDate || endDate && endDate > currentDate || overriddenDateTime && overriddenDateTime > currentDate)) {\n        obj.overrideEndDate = this.formatDate(overriddenDate);\n        obj.checked = true;\n        if (overriddenDateTime && overriddenDateTime > currentDate) {\n          obj.greenColor = true;\n        } else {\n          obj.greenColor = false;\n        }\n      } else if (!endDate && !overriddenDate && !data.endDate || endDate && endDate > currentDate || overriddenDateTime && overriddenDateTime > currentDate) {\n        obj.overrideEndDate = this.formatDate(overriddenDate);\n        obj.checked = true;\n        if (overriddenDateTime && overriddenDateTime > currentDate) {\n          obj.greenColor = true;\n        } else {\n          obj.greenColor = false;\n        }\n      } else {\n        obj.overrideEndDate = this.formatDate(overriddenDate);\n        obj.checked = false;\n        obj.greenColor = false;\n      }\n      this.endDates[appType + '_endDate'] = ovrRdeDate;\n      this.entitlements[this.objIndex] = obj;\n      this.showButtons();\n    }\n    formatDate(date) {\n      var d = new Date(date),\n        month = '' + (d.getMonth() + 1),\n        day = '' + d.getDate(),\n        year = d.getFullYear();\n      if (month.length < 2) month = '0' + month;\n      if (day.length < 2) day = '0' + day;\n      return [year, month, day].join('-');\n    }\n    checkDate(dat) {\n      let oDate;\n      if (typeof dat == 'object') {\n        oDate = new Date(dat);\n      } else {\n        oDate = new Date(dat + ' 23:59:59');\n      }\n      let today = new Date();\n      if (today < oDate) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n    save() {\n      if (!this.orgRoleAvail) {\n        this.errorInfo = this.language['Role (null) not found'];\n        this.error = true;\n        this.commonOrgService.pageScrollTop();\n        return;\n      }\n      this.updateAdmins();\n    }\n    updateAdmins() {\n      this.loader = true;\n      let params = [];\n      this.addedUsersList.forEach(element => {\n        params.push(element._id);\n      });\n      this.api.AddAdmin(params, this.orgAdminRoleId).subscribe(res => {\n        //To fix CCL-40950\n        /* Reenabling below function for CCL-41086 */\n        this.saveEntitlements();\n        //this.loader = false;\n        this.successMessage();\n      }, err => {\n        this.loader = false;\n        this.pageErrorHandle(err);\n        this.commonOrgService.pageScrollTop();\n      }, () => {\n        this.loader = false;\n      });\n    }\n    saveEntitlements() {\n      var _a, _b, _c, _d, _e, _f, _g, _h;\n      var perParams = {};\n      let statusMatch = {\n        \"\": null,\n        active: 'Active',\n        about_to_expire: 'About_to_Expire',\n        in_grace_period: 'In_Grace_Period',\n        expired: 'Expired'\n      };\n      var fields = $('#entitlementsForm').serializeArray();\n      $.each(fields, function (i, field) {\n        if (typeof perParams[field.name] != 'undefined') {\n          if (jQuery.type(perParams[field.name]) != 'array') {\n            var old = perParams[field.name];\n            perParams[field.name] = [old];\n          }\n          perParams[field.name].push(field.value);\n        } else {\n          perParams[field.name] = field.value;\n        }\n      });\n      let appTypes = perParams['appType'];\n      let selectedEntlmnts = perParams['entitlement'] ? perParams['entitlement'] : [];\n      let data = [];\n      //to overcome p-calendar issue\n      let tempPerParams = {};\n      tempPerParams['appType'] = perParams['appType'];\n      tempPerParams['entitlement'] = perParams['entitlement'] ? perParams['entitlement'] : [];\n      tempPerParams['name'] = perParams['name'] ? perParams['name'] : [];\n      /* Changes for CCL-41086 */\n      tempPerParams['overrideEndDate'] = perParams['overrideEndDate'] ? perParams['overrideEndDate'] : [];\n      tempPerParams['status'] = [];\n      let pLen = appTypes.length;\n      for (let e = 0; e < pLen; e++) {\n        /* Changes for CCL-41086 */\n        /* let type = `overrideEndDate${appTypes[e]}`;\r\n        tempPerParams['overrideEndDate'].push(perParams[type]); */\n        //tempPerParams['status'].push(statusMatch[$(`#status-list${e}`).attr('ng-reflect-model')] || '');\n        tempPerParams['status'].push(statusMatch[this.entStatus[e]]);\n      }\n      perParams = tempPerParams;\n      let newEntitles = [];\n      let changedEntitles = [];\n      for (let i = 0; i < perParams['appType'].length; i++) {\n        let obj = {\n          \"createTime\": null,\n          \"updateTime\": null,\n          \"id\": null,\n          \"appType\": 999,\n          \"name\": \"Service Cloud\",\n          \"entitlement\": 100,\n          \"disabledFlag\": false,\n          \"startDate\": null,\n          \"endDate\": null,\n          \"overrideEndDate\": \"2021-06-30\",\n          \"contractNumber\": null,\n          \"productFamily\": null,\n          \"partCategory\": null,\n          \"partNumber\": null,\n          \"partDescription\": null,\n          \"qty\": null,\n          \"customer\": null,\n          \"organizationId\": this.ORG_ID,\n          //\"graceDays\": null,\n          //\"bannerDays\": null,\n          \"status\": null,\n          \"serviceName\": null,\n          \"serviceEdition\": null\n        };\n        let index = selectedEntlmnts.indexOf(perParams['appType'][i]);\n        if (selectedEntlmnts && index !== -1) {\n          if (this.selectedEntitlements[perParams['appType'][i]] != undefined) {\n            obj['appType'] = perParams['appType'][i];\n            obj['name'] = perParams['name'][i];\n            obj['overrideEndDate'] = perParams['overrideEndDate'][i];\n            obj['disabledFlag'] = false;\n            obj['id'] = this.selectedEntitlements[perParams['appType'][i]].id;\n            obj['startDate'] = this.selectedEntitlements[perParams['appType'][i]].startDate;\n            obj['endDate'] = this.selectedEntitlements[perParams['appType'][i]].endDate;\n            obj['createTime'] = this.selectedEntitlements[perParams['appType'][i]].createTime;\n            obj['updateTime'] = this.selectedEntitlements[perParams['appType'][i]].updateTime;\n            obj['contractNumber'] = this.selectedEntitlements[perParams['appType'][i]].contractNumber;\n            obj['productFamily'] = this.selectedEntitlements[perParams['appType'][i]].productFamily;\n            obj['partCategory'] = this.selectedEntitlements[perParams['appType'][i]].partCategory;\n            obj['partDescription'] = this.selectedEntitlements[perParams['appType'][i]].partDescription;\n            obj['qty'] = this.selectedEntitlements[perParams['appType'][i]].qty;\n            obj['customer'] = this.selectedEntitlements[perParams['appType'][i]].customer;\n            // obj['graceDays'] = typeof this.selectedEntitlements[perParams['appType'][i]]?.graceDays != 'undefined' ? this.selectedEntitlements[perParams['appType'][i]]?.graceDays : null;\n            // obj['bannerDays'] = typeof this.selectedEntitlements[perParams['appType'][i]]?.bannerDays != 'undefined' ? this.selectedEntitlements[perParams['appType'][i]]?.bannerDays : null;\n            /* Changes for CCL-41086 */\n            obj['status'] = perParams['status'][i] || null; //typeof this.selectedEntitlements[perParams['appType'][i]]?.status != 'undefined' ? this.selectedEntitlements[perParams['appType'][i]]?.status : null;\n            obj['serviceName'] = typeof ((_a = this.selectedEntitlements[perParams['appType'][i]]) === null || _a === void 0 ? void 0 : _a.serviceName) != 'undefined' ? (_b = this.selectedEntitlements[perParams['appType'][i]]) === null || _b === void 0 ? void 0 : _b.serviceName : null;\n            obj['serviceEdition'] = typeof ((_c = this.selectedEntitlements[perParams['appType'][i]]) === null || _c === void 0 ? void 0 : _c.serviceEdition) != 'undefined' ? (_d = this.selectedEntitlements[perParams['appType'][i]]) === null || _d === void 0 ? void 0 : _d.serviceEdition : null;\n            changedEntitles.push(obj);\n            data.push(obj);\n          } else {\n            obj['appType'] = perParams['appType'][i];\n            obj['name'] = perParams['name'][i];\n            obj['overrideEndDate'] = perParams['overrideEndDate'][i];\n            /* Changes for CCL-41086 */\n            obj['status'] = perParams['status'][i] || null;\n            obj['disabledFlag'] = false;\n            newEntitles.push(obj);\n            data.push(obj);\n          }\n        } else {\n          //Newly added 4/12/2020 start\n          if (this.selectedEntitlements[perParams['appType'][i]] != undefined) {\n            obj['appType'] = perParams['appType'][i];\n            obj['name'] = perParams['name'][i];\n            obj['overrideEndDate'] = perParams['overrideEndDate'][i];\n            obj['disabledFlag'] = false;\n            obj['id'] = this.selectedEntitlements[perParams['appType'][i]].id;\n            obj['startDate'] = this.selectedEntitlements[perParams['appType'][i]].startDate;\n            obj['endDate'] = this.selectedEntitlements[perParams['appType'][i]].endDate;\n            obj['createTime'] = this.selectedEntitlements[perParams['appType'][i]].createTime;\n            obj['updateTime'] = this.selectedEntitlements[perParams['appType'][i]].updateTime;\n            obj['contractNumber'] = this.selectedEntitlements[perParams['appType'][i]].contractNumber;\n            obj['productFamily'] = this.selectedEntitlements[perParams['appType'][i]].productFamily;\n            obj['partCategory'] = this.selectedEntitlements[perParams['appType'][i]].partCategory;\n            obj['partDescription'] = this.selectedEntitlements[perParams['appType'][i]].partDescription;\n            obj['qty'] = this.selectedEntitlements[perParams['appType'][i]].qty;\n            obj['customer'] = this.selectedEntitlements[perParams['appType'][i]].customer;\n            // obj['graceDays'] = typeof this.selectedEntitlements[perParams['appType'][i]]?.graceDays != 'undefined' ? this.selectedEntitlements[perParams['appType'][i]]?.graceDays : null;\n            // obj['bannerDays'] = typeof this.selectedEntitlements[perParams['appType'][i]]?.bannerDays != 'undefined' ? this.selectedEntitlements[perParams['appType'][i]]?.bannerDays : null;\n            /* Changes for CCL-41086 */\n            obj['status'] = perParams['status'][i] || null; //typeof this.selectedEntitlements[perParams['appType'][i]]?.status != 'undefined' ? this.selectedEntitlements[perParams['appType'][i]]?.status : null;\n            obj['serviceName'] = typeof ((_e = this.selectedEntitlements[perParams['appType'][i]]) === null || _e === void 0 ? void 0 : _e.serviceName) != 'undefined' ? (_f = this.selectedEntitlements[perParams['appType'][i]]) === null || _f === void 0 ? void 0 : _f.serviceName : null;\n            obj['serviceEdition'] = typeof ((_g = this.selectedEntitlements[perParams['appType'][i]]) === null || _g === void 0 ? void 0 : _g.serviceEdition) != 'undefined' ? (_h = this.selectedEntitlements[perParams['appType'][i]]) === null || _h === void 0 ? void 0 : _h.serviceEdition : null;\n            changedEntitles.push(obj);\n            data.push(obj);\n          } else {\n            if (perParams['status'][i]) {\n              //(perParams['overrideEndDate'][i] != '')\n              obj['appType'] = perParams['appType'][i];\n              obj['name'] = perParams['name'][i];\n              obj['overrideEndDate'] = perParams['overrideEndDate'][i];\n              /* Changes for CCL-41086 */\n              obj['status'] = perParams['status'][i] || null;\n              obj['disabledFlag'] = false;\n              newEntitles.push(obj);\n              data.push(obj);\n            }\n          }\n          //Newly added 4/12/2020 end\n        }\n      }\n\n      if (!newEntitles.length && !changedEntitles.length) {\n        this.loader = false;\n        this.successMessage();\n        return;\n      }\n      this.newEntitlesUpdate = newEntitles;\n      this.changedEntitlesUpdate = changedEntitles;\n      this.updateEnt();\n    }\n    updateEnt() {\n      this.loader = true;\n      const calls = [];\n      const newCallsForExpiredStatus = [];\n      const updateCallsForExpiredStatus = [];\n      let addUrl = `${environment.CALIX_ADMIN_ORG_BASE_URL}entitlements/`;\n      this.newEntitlesUpdate.forEach(ent => {\n        if (ent.status === \"Expired\") {\n          newCallsForExpiredStatus.push(this.api.addEntitlements(addUrl, ent));\n        } else {\n          calls.push(this.api.addEntitlements(addUrl, ent));\n        }\n      });\n      this.changedEntitlesUpdate.forEach(ent => {\n        let flag = false;\n        this.orgEntitlements.forEach(orgEnt => {\n          if (Number(ent.appType) === orgEnt.appType && ent.status === orgEnt.status) {\n            flag = true;\n          }\n        });\n        if (!flag) {\n          let url = `${environment.CALIX_ADMIN_ORG_BASE_URL}entitlements/${ent.id}`;\n          if (ent.status === \"Expired\") {\n            updateCallsForExpiredStatus.push(this.api.changeEntitlements(url, ent));\n          } else {\n            calls.push(this.api.changeEntitlements(url, ent));\n          }\n        }\n      });\n      const lenForCalls = calls.length;\n      let i = 0;\n      concat(...newCallsForExpiredStatus, ...updateCallsForExpiredStatus, ...calls\n      //).pipe(\n      //  toArray()\n      ).subscribe(response => {\n        i++;\n        if (lenForCalls == i && newCallsForExpiredStatus.length == i && updateCallsForExpiredStatus.length == i) {\n          this.successMessage();\n        }\n      }, err => {\n        this.loader = false;\n        this.pageErrorHandle(err);\n        this.commonOrgService.pageScrollTop();\n      });\n    }\n    cancel() {\n      this.goToOrgList();\n    }\n    changeDate(item, appType, dt) {\n      dt = dt.toString();\n      let check = this.checkDateObject(dt);\n      if (check) {\n        $(`#${appType}_entitled`).prop('checked', true);\n      } else {\n        $(`#${appType}_entitled`).prop('checked', false);\n      }\n    }\n    checkDateObject(dat) {\n      let oDate;\n      oDate = new Date(dat);\n      let today = new Date();\n      if (today < oDate) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n    dateF(str) {\n      return new Date(str);\n    }\n    closeAlert() {\n      this.error = false;\n      this.success = false;\n    }\n    closeAlertWarning() {\n      this.warning = false;\n    }\n    hideSearch() {\n      setTimeout(() => {\n        $('#table-div .dataTables_wrapper .dataTables_filter').css('display', 'none');\n        $('#table-div .dataTables_wrapper .dataTables_length').css('display', 'none');\n      }, 100);\n    }\n    showButtons() {\n      this.showSubmitButtons = true;\n    }\n    successMessage() {\n      this.closeAlert();\n      this.successInfo = this.language['Organization updated successfully'];\n      this.success = true;\n      this.commonOrgService.pageScrollTop();\n      setTimeout(() => {\n        this.loader = false;\n        this.closeAlert();\n        this.goToOrgList();\n      }, 1500);\n    }\n    checkSelected() {\n      if (!this.usersAvail) {\n        this.usersAvailInterval = setInterval(() => {\n          if (this.usersAvail) {\n            this.checkSelected();\n            clearInterval(this.usersAvailInterval);\n          }\n        }, 500);\n        return;\n      }\n      this.usersList.forEach(users => {\n        let avail = [];\n        avail = this.addedUsersList.filter(added => users._id === added.userId);\n        if (avail.length) {\n          users['disabled'] = true;\n        }\n      });\n      this.usersList = [...this.usersList];\n    }\n    tableLanguageOptions() {\n      if (sessionStorage.getItem('defaultLanguage') && sessionStorage.getItem('defaultLanguage') == 'fr') {\n        this.tableOptions.language = this.frTable;\n        this.tableOptions.language.emptyTable = \"Aucune utilisateur disponible dans le tableau\";\n      } else if (this.language.fileLanguage == 'es') {\n        this.tableOptions.language = this.customTranslateService.es;\n      } else if (this.language.fileLanguage == 'de_DE') {\n        this.tableOptions.language = this.customTranslateService.de_DE;\n      } else if (sessionStorage.getItem('defaultLanguage') && sessionStorage.getItem('defaultLanguage') == 'en' && this.tableOptions.language) {\n        delete this.tableOptions.language;\n        this.tableOptions['language'] = {\n          emptyTable: \"No users available in table\"\n        };\n      }\n    }\n    closeModal() {\n      if (this.modalRef) {\n        this.modalRef.close();\n      }\n    }\n    pageErrorHandle(err) {\n      if (err.status == 401) {\n        this.errorInfo = this.language['Access Denied'];\n      } else {\n        this.errorInfo = this.commonOrgService.pageErrorHandle(err);\n      }\n      this.closeAlert();\n      this.error = true;\n    }\n    setYearRange() {\n      this.yRange = '2000:2030';\n      let currentYear = new Date().getFullYear();\n      this.yRange = `${currentYear - 20}:${currentYear + 30}`;\n    }\n    sortByTimestamp(list, key, asc) {\n      let lesser = [],\n        greater = [],\n        zeros = [];\n      let now = new Date().getTime();\n      list.forEach(e => {\n        e['timestamp'] = e.overrideEndDate ? new Date(e.overrideEndDate).getTime() : 0;\n      });\n      key = 'timestamp';\n      asc = 'desc';\n      list.sort(function (x, y) {\n        x[key] = x[key] ? parseInt(x[key]) : 0;\n        y[key] = y[key] ? parseInt(y[key]) : 0;\n        if (asc && asc == 'asc') {\n          return x[key] - y[key];\n        }\n        if (asc && asc == 'desc') {\n          return y[key] - x[key];\n        }\n      });\n      list.forEach(e => {\n        if (e.timestamp && e.timestamp < now) {\n          lesser.push(e);\n        } else if (e.timestamp && e.timestamp > now) {\n          greater.push(e);\n        } else if (!e.timestamp || e.timestamp == now) {\n          zeros.push(e);\n        }\n      });\n      return [...lesser, ...greater, ...zeros];\n    }\n    clearOverrideEndDate(event, data, appType, ovrRdeDate) {\n      let entitlements = this.entitlements;\n      let hasDate = false;\n      let obj = entitlements.find((obj, index) => {\n        this.objIndex = index;\n        return obj.appType == appType;\n      });\n      if (obj.overrideEndDate) {\n        hasDate = true;\n      }\n      let date = new Date();\n      let currentDate = date.getTime();\n      let endDate = '';\n      //let overriddenDate: any = event;\n      let overriddenDate = `${ovrRdeDate} 23:59:59`;\n      let overriddenDateTime;\n      endDate = data.endDate ? new Date(data.endDate).getTime() : \"\";\n      overriddenDateTime = new Date(overriddenDate);\n      overriddenDateTime = overriddenDateTime.getTime();\n      // if (data.entitlement && endDate && endDate > currentDate) {\n      //   obj.overrideEndDate = null;\n      //   obj.checked = true;\n      //   obj.greenColor = false;\n      // } else {\n      //   obj.overrideEndDate = null;\n      //   obj.checked = false;\n      //   obj.greenColor = false;\n      // }\n      obj.overrideEndDate = null;\n      obj.checked = false;\n      obj.greenColor = false;\n      this.endDates[appType + '_endDate'] = \"\";\n      this.entitlements[this.objIndex] = obj;\n      if (hasDate) {\n        this.showButtons();\n      }\n    }\n    preventClick(e) {\n      e.preventDefault();\n    }\n    removePlaceholder(i) {\n      $(`#status-list${i} input`).attr('placeholder', '');\n    }\n  }\n  OrganizationDetailComponent.ɵfac = function OrganizationDetailComponent_Factory(t) {\n    return new (t || OrganizationDetailComponent)(i0.ɵɵdirectiveInject(i1.CustomTranslateService), i0.ɵɵdirectiveInject(i2.CommonService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.OrganizationsService), i0.ɵɵdirectiveInject(i5.SsoAuthService), i0.ɵɵdirectiveInject(i6.NgbModal), i0.ɵɵdirectiveInject(i7.Title));\n  };\n  OrganizationDetailComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OrganizationDetailComponent,\n    selectors: [[\"app-organization-detail\"]],\n    viewQuery: function OrganizationDetailComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n        i0.ɵɵviewQuery(DataTableDirective, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.deleteModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.dtElement = _t.first);\n      }\n    },\n    decls: 43,\n    vars: 25,\n    consts: [[1, \"container\", \"mh-65\", \"position-relative\"], [\"class\", \"loader\", 4, \"ngIf\"], [\"class\", \"w-100 alert alert-danger  fade show\", 4, \"ngIf\"], [\"class\", \"w-100 alert alert-success fade show\", 4, \"ngIf\"], [1, \"row\", \"my-3\"], [1, \"col-md-8\"], [1, \"ccl-title\"], [1, \"col-md-4\", \"px-0\"], [1, \"text-right\"], [\"id\", \"back-org-list\", 1, \"back-text\", 3, \"click\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-angle-left\", \"mr-3\"], [1, \"col-md-6\"], [1, \"row\", \"my-3\", \"ccl-form\"], [1, \"col-md-8\", \"pr-0\"], [\"id\", \"admins-list\", \"bindLabel\", \"username\", \"placeholder\", \"\", 1, \"ccl-select-box\", 3, \"items\", \"ngModel\", \"clearable\", \"ngModelOptions\", \"multiple\", \"disabled\", \"ngModelChange\"], [1, \"col-md-4\"], [\"_ngcontent-veq-c50\", \"\", \"id\", \"add-user\", 1, \"btn-default\", \"primary\", \"px-1\", 3, \"disabled\", \"click\"], [1, \"col-md-12\", 3, \"hidden\"], [\"id\", \"org-detail-users\", \"width\", \"100%\", \"datatable\", \"\", 1, \"row-border\", \"hover\", \"table-alter\", \"w-100\", 3, \"dtOptions\", \"dtTrigger\"], [1, \"\"], [3, \"id\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-md-12\"], [\"class\", \"col-md-12 my-2\", 4, \"ngIf\"], [\"class\", \"row\", 4, \"ngIf\"], [\"deleteModal\", \"\"], [1, \"loader\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"spinner-border\", \"text-primary\"], [1, \"sr-only\"], [1, \"w-100\", \"alert\", \"alert-danger\", \"fade\", \"show\"], [1, \"error-img\"], [\"src\", \"./assets/img/ic_error-36px.svg\"], [\"type\", \"button\", 1, \"close\", 3, \"click\"], [1, \"d-inline-flex\", 3, \"innerHtml\"], [1, \"w-100\", \"alert\", \"alert-success\", \"fade\", \"show\"], [3, \"innerHtml\"], [3, \"id\"], [1, \"actions\", \"text-nowrap\"], [\"id\", \"delete-user\", 1, \"fas\", \"fa-trash-alt\", \"primary\", \"p-1\", \"cursor-pointer\", 3, \"title\", \"click\"], [1, \"col-md-12\", \"my-2\"], [\"id\", \"entitlementsForm\"], [\"datatable\", \"\", 1, \"row-border\", \"hover\", \"table-alter\", 3, \"dtOptions\"], [1, \"hiddenCol\", \"p-0\"], [4, \"ngFor\", \"ngForOf\"], [\"type\", \"hidden\", \"name\", \"appType\", 3, \"value\"], [\"type\", \"hidden\", \"name\", \"name\", 3, \"value\"], [1, \"form-check\"], [1, \"form-check-label\"], [\"type\", \"checkbox\", \"name\", \"entitlement\", 3, \"id\", \"checked\", \"value\", \"readonly\", \"click\"], [\"type\", \"checkbox\", \"name\", \"inherited\", 3, \"id\", \"checked\", \"readonly\", \"click\"], [1, \"org-detail-status\"], [\"type\", \"hidden\", \"name\", \"overrideEndDate\", 3, \"value\"], [\"bindLabel\", \"label\", \"bindValue\", \"value\", 1, \"ccl-select-box\", 3, \"id\", \"placeholder\", \"items\", \"ngModel\", \"ngModelOptions\", \"ngModelChange\", \"change\"], [1, \"row\"], [1, \"col-md-6\", \"offset-md-6\", \"my-2\", \"text-right\", \"pr-0\"], [\"_ngcontent-veq-c50\", \"\", \"id\", \"submit\", 1, \"btn-default\", \"primary\", 3, \"click\"], [\"_ngcontent-veq-c50\", \"\", \"id\", \"cancel\", 1, \"btn-default\", \"btn-dft\", \"mx-3\", 3, \"click\"], [1, \"modal-header\"], [\"id\", \"modal-basic-title\", 1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn-default\", \"primary\", \"px-3\", 3, \"click\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn-default\", \"btn-dft\", \"py-1\", \"px-3\", 3, \"click\"]],\n    template: function OrganizationDetailComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, OrganizationDetailComponent_div_1_Template, 5, 0, \"div\", 1);\n        i0.ɵɵtemplate(2, OrganizationDetailComponent_div_2_Template, 6, 1, \"div\", 2);\n        i0.ɵɵtemplate(3, OrganizationDetailComponent_div_3_Template, 4, 1, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\", 6);\n        i0.ɵɵtext(7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 7);\n        i0.ɵɵelementStart(9, \"div\", 8);\n        i0.ɵɵelementStart(10, \"a\", 9);\n        i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_Template_a_click_10_listener() {\n          return ctx.goToOrgList();\n        });\n        i0.ɵɵelement(11, \"i\", 10);\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 4);\n        i0.ɵɵelementStart(14, \"div\", 11);\n        i0.ɵɵelementStart(15, \"div\", 6);\n        i0.ɵɵtext(16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"div\", 12);\n        i0.ɵɵelementStart(18, \"div\", 13);\n        i0.ɵɵelementStart(19, \"ng-select\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function OrganizationDetailComponent_Template_ng_select_ngModelChange_19_listener($event) {\n          return ctx.selectedUsers = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 15);\n        i0.ɵɵelementStart(21, \"button\", 16);\n        i0.ɵɵlistener(\"click\", function OrganizationDetailComponent_Template_button_click_21_listener() {\n          return ctx.addUser();\n        });\n        i0.ɵɵtext(22);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"div\", 4);\n        i0.ɵɵelementStart(24, \"div\", 17);\n        i0.ɵɵtemplate(25, OrganizationDetailComponent_div_25_Template, 6, 1, \"div\", 2);\n        i0.ɵɵelementStart(26, \"table\", 18);\n        i0.ɵɵelementStart(27, \"thead\", 19);\n        i0.ɵɵelementStart(28, \"tr\");\n        i0.ɵɵelementStart(29, \"th\");\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"th\");\n        i0.ɵɵtext(32);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"tbody\");\n        i0.ɵɵtemplate(34, OrganizationDetailComponent_tr_34_Template, 5, 3, \"tr\", 20);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"div\", 4);\n        i0.ɵɵelementStart(36, \"div\", 21);\n        i0.ɵɵelementStart(37, \"div\", 6);\n        i0.ɵɵtext(38);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(39, OrganizationDetailComponent_div_39_Template, 17, 6, \"div\", 22);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(40, OrganizationDetailComponent_div_40_Template, 6, 2, \"div\", 23);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(41, OrganizationDetailComponent_ng_template_41_Template, 12, 5, \"ng-template\", null, 24, i0.ɵɵtemplateRefExtractor);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loader);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.error);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.success);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"\", ctx.orgName, \" \");\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(ctx.language.backtoorg);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"\", ctx.language.addadmin, \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"items\", ctx.usersList)(\"ngModel\", ctx.selectedUsers)(\"clearable\", false)(\"ngModelOptions\", i0.ɵɵpureFunction0(24, _c2))(\"multiple\", true)(\"disabled\", !(ctx.usersList == null ? null : ctx.usersList.length));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", !(ctx.usersList == null ? null : ctx.usersList.length));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.language.add);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"hidden\", !ctx.dataAvailable);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.warning);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"dtOptions\", ctx.tableOptions)(\"dtTrigger\", ctx.dtTrigger);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.language.username);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.language.action);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.addedUsersList);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"\", ctx.language.entitlements, \" \");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.entitlementAvailable);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showSubmitButtons);\n      }\n    },\n    directives: [i8.NgIf, i9.NgSelectComponent, i10.NgControlStatus, i10.NgModel, i11.DataTableDirective, i8.NgForOf, i10.ɵNgNoValidate, i10.NgControlStatusGroup, i10.NgForm],\n    styles: [\".overriden-input-remove[_ngcontent-%COMP%]{position:absolute;white-space:nowrap;right:30px;padding:0 8px 0 0;cursor:pointer}.overriden-input-remove[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60%;padding-bottom:3px}.org-detail-status[_ngcontent-%COMP%]{width:150px!important}.hiddenCol[_ngcontent-%COMP%]{width:0px!important}\"]\n  });\n  return OrganizationDetailComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}