{"ast":null,"code":"import { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app-services/translate.service\";\nimport * as i2 from \"../shared/services/cco-common.service\";\nimport * as i3 from \"src/app/shared/services/sso-auth.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"../system/cco-subscriber-system/add-service-system/add-subscriber.service\";\nimport * as i6 from \"@angular/platform-browser\";\nimport * as i7 from \"@angular/common\";\nfunction ServicesComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.language[\"Access denied due to RBAC. Please consult your Organization Administrator for access.\"], \" \");\n  }\n}\nfunction ServicesComponent_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.language.Services, \"\\n\");\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"active\": a0\n  };\n};\nfunction ServicesComponent_section_2_div_2_li_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 14);\n    i0.ɵɵelementStart(1, \"a\", 15);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", ctx_r5.menuConfig == null ? null : ctx_r5.menuConfig.subscribers == null ? null : ctx_r5.menuConfig.subscribers.urls == null ? null : ctx_r5.menuConfig.subscribers.urls[0])(\"ngClass\", i0.ɵɵpureFunction1(3, _c0, ctx_r5.activeMenus[\"subscribers\"]));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r5.language[\"Subscribers\"], \" \");\n  }\n}\nfunction ServicesComponent_section_2_div_2_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 14);\n    i0.ɵɵelementStart(1, \"a\", 16);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", ctx_r6.menuConfig == null ? null : ctx_r6.menuConfig.serviceprofiles == null ? null : ctx_r6.menuConfig.serviceprofiles.urls == null ? null : ctx_r6.menuConfig.serviceprofiles.urls[0])(\"ngClass\", i0.ɵɵpureFunction1(3, _c0, ctx_r6.activeMenus[\"service-profiles\"]));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r6.language[\"ONT Services Profiles\"]);\n  }\n}\nfunction ServicesComponent_section_2_div_2_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 14);\n    i0.ɵɵelementStart(1, \"a\", 17);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", ctx_r7.menuConfig == null ? null : ctx_r7.menuConfig.configuration == null ? null : ctx_r7.menuConfig.configuration.urls == null ? null : ctx_r7.menuConfig.configuration.urls[0])(\"ngClass\", i0.ɵɵpureFunction1(3, _c0, ctx_r7.activeMenus[\"configuration\"]));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r7.language[\"Configuration\"]);\n  }\n}\nfunction ServicesComponent_section_2_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelementStart(1, \"div\", 11);\n    i0.ɵɵelementStart(2, \"ul\", 12);\n    i0.ɵɵtemplate(3, ServicesComponent_section_2_div_2_li_3_Template, 3, 5, \"li\", 13);\n    i0.ɵɵtemplate(4, ServicesComponent_section_2_div_2_li_4_Template, 3, 5, \"li\", 13);\n    i0.ɵɵtemplate(5, ServicesComponent_section_2_div_2_li_5_Template, 3, 5, \"li\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.menus[\"subscribers\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.menus[\"service-profiles\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.menus[\"configuration\"]);\n  }\n}\nfunction ServicesComponent_section_2_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵelementStart(1, \"div\", 19);\n    i0.ɵɵelementStart(2, \"span\", 8);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"img\", 20);\n    i0.ɵɵlistener(\"click\", function ServicesComponent_section_2_div_3_Template_img_click_4_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return ctx_r8.gotoServiceProfiles();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r4.ccoSearchText, \" : \", ctx_r4.language[\"Provisioned Subscribers\"], \"\");\n  }\n}\nfunction ServicesComponent_section_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\");\n    i0.ɵɵelementStart(1, \"div\", 4);\n    i0.ɵɵtemplate(2, ServicesComponent_section_2_div_2_Template, 6, 3, \"div\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ServicesComponent_section_2_div_3_Template, 5, 2, \"div\", 10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r2.isProvisioned);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.isProvisioned && ctx_r2.ccoSearchText);\n  }\n}\nexport let ServicesComponent = /*#__PURE__*/(() => {\n  class ServicesComponent {\n    constructor(translateService, ccoCommonService, sso, router, subscriber, titleService, cdRef) {\n      var _a;\n      this.translateService = translateService;\n      this.ccoCommonService = ccoCommonService;\n      this.sso = sso;\n      this.router = router;\n      this.subscriber = subscriber;\n      this.titleService = titleService;\n      this.cdRef = cdRef;\n      this.isDev = false;\n      this.menus = {\n        'subscribers': false,\n        'service-profiles': false,\n        //'orchestration': false,\n        'configuration': false\n      };\n      this.menuConfig = {\n        'subscribers': {\n          urls: [],\n          scopes: ['subscriberslist']\n        },\n        'serviceprofiles': {\n          urls: [],\n          scopes: ['serviceprofiles', 'rgprofiles', 'rgdialplans']\n        },\n        'configuration': {\n          urls: [],\n          scopes: ['ontconfigurations', 'externalfileserver', 'secureonboarding', 'stalesystempurge', 'subnetconfiguration', 'speedtest']\n        }\n      };\n      this.module = 'network';\n      this.subscriberStepperInfo = '';\n      this.isSystemsMainPage = false;\n      this.showSubscriberSystems = false;\n      this.allowSubscriberSystems = true;\n      this.hasPageAccess = true;\n      this.TableView = false;\n      this.activeMenus = {\n        'subscribers': false,\n        'service-profiles': false,\n        //'orchestration': false,\n        'configuration': false\n      };\n      this.ccoCommonService.currentPageData.subscribe(data => {\n        this.currentPage = data;\n      });\n      let base = `${environment.API_BASE}`;\n      let host = window.location.host;\n      //console.log(host)\n      if (base.indexOf('/dev.api.calix.ai') > -1 || host.indexOf('localhost') > -1) {\n        this.isDev = true;\n      } else this.isDev = false;\n      this.isDev = true;\n      if (this.router.url && ((_a = this.router.url) === null || _a === void 0 ? void 0 : _a.indexOf('system-table-view')) > -1) {\n        this.isSystemsMainPage = true;\n      } else this.isSystemsMainPage = false;\n    }\n    ngOnInit() {\n      var _a, _b;\n      this.setActiveMenu();\n      this.subsSystemStepSubs = this.subscriber.subsSystemStep.subscribe(data => {\n        this.subscriberStepperInfo = data;\n        this.cdRef.detectChanges();\n      });\n      this.pageAcceesObs = this.sso.hasPageAccess$.subscribe(json => {\n        if (json.access) {\n          this.hasPageAccess = true;\n        } else {\n          this.hasPageAccess = false;\n        }\n      });\n      //console.log(this.router.url)\n      let enttlmnts = this.sso.getEntitlements();\n      if (enttlmnts[210] && !enttlmnts[102]) {\n        this.allowSubscriberSystems = false;\n      }\n      let scopes = this.sso.getScopes();\n      let urlsInfo = this.sso.getCCOUrlInfo();\n      if (environment.VALIDATE_SCOPE) {\n        let validScopes = Object.keys(scopes);\n        if (validScopes) {\n          for (let i = 0; i < validScopes.length; i++) {\n            if (validScopes[i].indexOf('cloud.rbac.coc.services.subscribers') !== -1) {\n              this.menus.subscribers = true;\n              continue;\n            }\n            if (validScopes[i].indexOf('cloud.rbac.coc.services.serviceprofiles') !== -1) {\n              this.menus['service-profiles'] = true;\n              continue;\n            }\n            if (validScopes[i].indexOf('cloud.rbac.coc.services.configuration') !== -1) {\n              this.menus.configuration = true;\n              continue;\n            }\n          }\n        }\n      } else {\n        this.menus = {\n          'subscribers': true,\n          'service-profiles': true,\n          //'orchestration': false,\n          'configuration': true\n        };\n      }\n      for (let menu in this.menuConfig) {\n        (_b = (_a = this.menuConfig[menu]) === null || _a === void 0 ? void 0 : _a.scopes) === null || _b === void 0 ? void 0 : _b.forEach(element => {\n          var _a, _b, _c, _d;\n          if (scopes[`cloud.rbac.coc.services.${menu}.${element}`]) {\n            (_b = (_a = this.menuConfig[menu]) === null || _a === void 0 ? void 0 : _a.urls) === null || _b === void 0 ? void 0 : _b.push((_d = (_c = urlsInfo['services']) === null || _c === void 0 ? void 0 : _c[`cloud.rbac.coc.services.${menu}.${element}`]) === null || _d === void 0 ? void 0 : _d.path);\n          }\n        });\n      }\n      //console.log(this.menuConfig);\n      this.language = this.translateService.defualtLanguage;\n      this.languageSubject = this.translateService.selectedLanguage.subscribe(data => {\n        this.language = data;\n      });\n      this.ccoCommonService.textSearch.subscribe(value => {\n        this.ccoSearchText = value.searchText;\n        this.isProvisioned = value.isProvisioned;\n      });\n    }\n    setActiveMenu() {\n      for (let menu in this.activeMenus) {\n        this.activeMenus[menu] = this.sso.isMenuActive(menu);\n      }\n    }\n    ngOnDestroy() {\n      if (this.pageAcceesObs) {\n        this.pageAcceesObs.unsubscribe();\n      }\n      if (this.languageSubject) {\n        this.languageSubject.unsubscribe();\n      }\n      if (this.subsSystemStepSubs) this.subsSystemStepSubs.unsubscribe();\n    }\n    gotoServiceProfiles() {\n      this.router.navigate(['/cco/services/service-profiles/ONT-profile']);\n    }\n  }\n  ServicesComponent.ɵfac = function ServicesComponent_Factory(t) {\n    return new (t || ServicesComponent)(i0.ɵɵdirectiveInject(i1.TranslateService), i0.ɵɵdirectiveInject(i2.CcoCommonService), i0.ɵɵdirectiveInject(i3.SsoAuthService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.AddSubscriberService), i0.ɵɵdirectiveInject(i6.Title), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n  ServicesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ServicesComponent,\n    selectors: [[\"app-services\"]],\n    decls: 8,\n    vars: 4,\n    consts: [[\"role\", \"alert\", \"class\", \"alert alert-warning\", 4, \"ngIf\"], [\"class\", \"cco-title\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"hidden\"], [1, \"container\"], [1, \"row\"], [1, \"col-md-12\", \"px-0\"], [\"role\", \"alert\", 1, \"alert\", \"alert-warning\"], [1, \"cco-title\"], [\"class\", \"row\", 4, \"ngIf\"], [\"class\", \"container ccl-tabs p-0\", 4, \"ngIf\"], [1, \"col-md-12\", \"px-0\", \"ccl-tabs\", \"my-3\"], [\"id\", \"tabs\", 1, \"nav\", \"nav-tabs\"], [\"class\", \"nav-item\", 4, \"ngIf\"], [1, \"nav-item\"], [\"data-toggle\", \"tab\", 1, \"nav-link\", 3, \"routerLink\", \"ngClass\"], [\"data-toggle\", \"tab\", \"id\", \"subscriber-system\", 1, \"nav-link\", \"small\", 3, \"routerLink\", \"ngClass\"], [\"data-toggle\", \"tab\", 1, \"nav-link\", \"small\", 3, \"routerLink\", \"ngClass\"], [1, \"container\", \"ccl-tabs\", \"p-0\"], [1, \"nav-tabs\", \"d-flex\", \"justify-content-between\", \"align-items-baseline\"], [\"src\", \"assets/img/ic_close-44px.svg\", \"alt\", \"\", 1, \"mr-3\", \"cursor-pointer\", 3, \"click\"]],\n    template: function ServicesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ServicesComponent_div_0_Template, 2, 1, \"div\", 0);\n        i0.ɵɵtemplate(1, ServicesComponent_span_1_Template, 2, 1, \"span\", 1);\n        i0.ɵɵtemplate(2, ServicesComponent_section_2_Template, 4, 2, \"section\", 2);\n        i0.ɵɵelementStart(3, \"section\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\", 6);\n        i0.ɵɵelement(7, \"router-outlet\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", !ctx.hasPageAccess);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.hasPageAccess && !ctx.isProvisioned);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.hasPageAccess);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"hidden\", !ctx.hasPageAccess);\n      }\n    },\n    directives: [i7.NgIf, i4.RouterOutlet, i4.RouterLinkWithHref, i7.NgClass],\n    styles: [\".current-issues-table[_ngcontent-%COMP%]{width:100%}.current-issues-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.current-issues-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{font-size:14px}.current-issues-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{font-size:14px}.subscriber-name[_ngcontent-%COMP%]{font-size:42px;font-style:normal;font-weight:300;line-height:53px;letter-spacing:0em;text-align:left;color:#1a1f22}\"]\n  });\n  return ServicesComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}