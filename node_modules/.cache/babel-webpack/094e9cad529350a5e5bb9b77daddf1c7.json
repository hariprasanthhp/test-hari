{"ast":null,"code":"import { getBBox } from '../../util/Elements';\nvar LOW_PRIORITY = 500;\nimport { append as svgAppend, attr as svgAttr, create as svgCreate } from 'tiny-svg';\nimport { query as domQuery } from 'min-dom';\nimport { assign } from 'min-dash';\n\n/**\n * @class\n *\n * A plugin that adds an outline to shapes and connections that may be activated and styled\n * via CSS classes.\n *\n * @param {EventBus} eventBus\n * @param {Styles} styles\n * @param {ElementRegistry} elementRegistry\n */\nexport default function Outline(eventBus, styles, elementRegistry) {\n  this.offset = 6;\n  var OUTLINE_STYLE = styles.cls('djs-outline', ['no-fill']);\n  var self = this;\n  function createOutline(gfx, bounds) {\n    var outline = svgCreate('rect');\n    svgAttr(outline, assign({\n      x: 10,\n      y: 10,\n      width: 100,\n      height: 100\n    }, OUTLINE_STYLE));\n    svgAppend(gfx, outline);\n    return outline;\n  }\n\n  // A low priortity is necessary, because outlines of labels have to be updated\n  // after the label bounds have been updated in the renderer.\n  eventBus.on(['shape.added', 'shape.changed'], LOW_PRIORITY, function (event) {\n    var element = event.element,\n      gfx = event.gfx;\n    var outline = domQuery('.djs-outline', gfx);\n    if (!outline) {\n      outline = createOutline(gfx, element);\n    }\n    self.updateShapeOutline(outline, element);\n  });\n  eventBus.on(['connection.added', 'connection.changed'], function (event) {\n    var element = event.element,\n      gfx = event.gfx;\n    var outline = domQuery('.djs-outline', gfx);\n    if (!outline) {\n      outline = createOutline(gfx, element);\n    }\n    self.updateConnectionOutline(outline, element);\n  });\n}\n\n/**\n * Updates the outline of a shape respecting the dimension of the\n * element and an outline offset.\n *\n * @param  {SVGElement} outline\n * @param  {djs.model.Base} element\n */\nOutline.prototype.updateShapeOutline = function (outline, element) {\n  svgAttr(outline, {\n    x: -this.offset,\n    y: -this.offset,\n    width: element.width + this.offset * 2,\n    height: element.height + this.offset * 2\n  });\n};\n\n/**\n * Updates the outline of a connection respecting the bounding box of\n * the connection and an outline offset.\n *\n * @param  {SVGElement} outline\n * @param  {djs.model.Base} element\n */\nOutline.prototype.updateConnectionOutline = function (outline, connection) {\n  var bbox = getBBox(connection);\n  svgAttr(outline, {\n    x: bbox.x - this.offset,\n    y: bbox.y - this.offset,\n    width: bbox.width + this.offset * 2,\n    height: bbox.height + this.offset * 2\n  });\n};\nOutline.$inject = ['eventBus', 'styles', 'elementRegistry'];","map":null,"metadata":{},"sourceType":"module"}