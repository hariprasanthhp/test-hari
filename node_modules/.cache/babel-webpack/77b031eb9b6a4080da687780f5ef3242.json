{"ast":null,"code":"import { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"./../../../app-services/translate.service\";\nimport * as i3 from \"../data.service\";\nimport * as i4 from \"../../shared/services/sso-auth.service\";\nimport * as i5 from \"../shared/component/subscriber-menu/subscriber-menu.component\";\nimport * as i6 from \"@angular/common\";\nfunction SupportServiceComponent_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 13);\n    i0.ɵɵelementStart(1, \"a\", 14);\n    i0.ɵɵlistener(\"Click\", function SupportServiceComponent_li_5_Template_a_Click_1_listener($event) {\n      return $event.preventDefault();\n    });\n    i0.ɵɵelementStart(2, \"span\", 15);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/\", ctx_r0.MODULE, \"/service/data\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.language.Datas);\n  }\n}\nfunction SupportServiceComponent_li_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 16);\n    i0.ɵɵelementStart(1, \"a\", 17);\n    i0.ɵɵelementStart(2, \"span\", 15);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/\", ctx_r1.MODULE, \"/service/video\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.language.Video);\n  }\n}\nfunction SupportServiceComponent_li_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 18);\n    i0.ɵɵelementStart(1, \"a\", 19);\n    i0.ɵɵelementStart(2, \"span\", 15);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/\", ctx_r2.MODULE, \"/service/voice\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.language.Voice);\n  }\n}\nfunction SupportServiceComponent_li_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 20);\n    i0.ɵɵelementStart(1, \"a\", 19);\n    i0.ɵɵelementStart(2, \"span\", 15);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/\", ctx_r3.MODULE, \"/service/xdsl\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r3.language.XDSL);\n  }\n}\nfunction SupportServiceComponent_li_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 20);\n    i0.ɵɵelementStart(1, \"a\", 19);\n    i0.ɵɵelementStart(2, \"span\", 15);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/\", ctx_r4.MODULE, \"/service/gfast\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r4.language.gfast);\n  }\n}\nexport let SupportServiceComponent = /*#__PURE__*/(() => {\n  class SupportServiceComponent {\n    constructor(router, translateService, dataChartService, sso) {\n      this.router = router;\n      this.translateService = translateService;\n      this.dataChartService = dataChartService;\n      this.sso = sso;\n      this.loader1 = false;\n      this.loader2 = false;\n      this.showDataService = false;\n      this.showVoiceService = false;\n      this.showVideoService = false;\n      //showVoiceService1 = false;\n      //showVideoService1= false;\n      this.deviceInfo = {\n        'modelName': ''\n      };\n      this.thirdPartyDevice = false;\n      this.checkDeviceManfacturer = sessionStorage.getItem(\"calix.deviceData\") ? JSON.parse(sessionStorage.getItem(\"calix.deviceData\")) : [];\n      this.metaData = {};\n      this.videoWan = true;\n      this.voiceWan = true;\n      this.MODULE = 'support';\n      let url = this.router.url;\n      if (url.indexOf('/support/') > -1) {\n        this.MODULE = 'support';\n      } else this.MODULE = 'cco';\n    }\n    ngOnInit() {\n      this.thirdPartyDevice = this.checkDeviceManfacturer.filter(obj => (obj === null || obj === void 0 ? void 0 : obj.manufacturer) !== 'Calix' && obj.manufacturer).length ? true : false;\n      this.orgId = this.sso.getOrgId();\n      let scopes = this.sso.getScopes();\n      this.getDevice();\n      if (environment.VALIDATE_SCOPE) {\n        //  scopes['cloud.rbac.csc.services.data'] = scopes['cloud.rbac.csc.services.data'] ? scopes['cloud.rbac.csc.services.data'] : [];\n        scopes['cloud.rbac.csc.services.video'] = scopes['cloud.rbac.csc.services.video'] ? scopes['cloud.rbac.csc.services.video'] : [];\n        scopes['cloud.rbac.csc.services.voice'] = scopes['cloud.rbac.csc.services.voice'] ? scopes['cloud.rbac.csc.services.voice'] : [];\n        let validScopes = Object.keys(scopes);\n        if (validScopes) {\n          for (let i = 0; i < validScopes.length; i++) {\n            if (validScopes[i].indexOf('cloud.rbac.csc.services.data') !== -1) {\n              this.showDataService = true;\n              break;\n            }\n          }\n        }\n        /* if (scopes && (scopes['cloud.rbac.csc.services.data'] && scopes['cloud.rbac.csc.services.data'].length)) {\r\n          this.showDataService = true;\r\n        } */\n        if (scopes && scopes['cloud.rbac.csc.services.video'] && scopes['cloud.rbac.csc.services.video'].length) {\n          this.showVideoService = true; // this.showVoiceService = true;\n        }\n\n        if (scopes && scopes['cloud.rbac.csc.services.voice'] && scopes['cloud.rbac.csc.services.voice'].length) {\n          this.showVoiceService = true; ///this.showVideoService = true;\n        }\n\n        if (this.showDataService) {} else if (this.showVoiceService) {\n          this.router.navigate(['/support/service/voice']);\n        } else if (this.showVideoService) {\n          this.router.navigate(['/support/service/video']);\n        }\n      } else {\n        this.showDataService = true;\n        this.showVoiceService = true;\n        this.showVideoService = true;\n      }\n      this.language = this.translateService.defualtLanguage;\n      this.languageSubject = this.translateService.selectedLanguage.subscribe(data => {\n        this.language = data;\n      });\n      this.apiCallDone = true;\n    }\n    getDevice() {\n      var _a;\n      this.deviceInfo = JSON.parse(sessionStorage.getItem(\"calix.deviceData\"));\n      this.deviceInfo = this.deviceInfo ? this.deviceInfo.filter(obj => obj.serialNumber).sort((a, b) => a.opMode != \"RG\" ? 1 : -1) : '';\n      this.deviceInfo = this.deviceInfo ? this.deviceInfo.filter(obj => obj.opMode == \"RG\") : '';\n      this.deviceInfo = this.deviceInfo.length ? this.deviceInfo[0] : {};\n      this.serialNumberSelected = (_a = this.deviceInfo) === null || _a === void 0 ? void 0 : _a.serialNumber;\n      this.metaData = this.dataChartService.getMetaData(this.serialNumberSelected);\n      if (this.metaData) {\n        this.checkWanStatus();\n      } else this.getMetaData();\n      //this.getVideo();\n      //this.getVoice();\n    }\n\n    checkWanStatus() {\n      var _a;\n      if ((_a = this.metaData) === null || _a === void 0 ? void 0 : _a.WANInfo) {\n        let tabAllowed = [];\n        this.loader1 = true;\n        this.dataChartService.getWanInfo(this.orgId, this.serialNumberSelected).subscribe(res => {\n          this.loader1 = false;\n          if (res && res.length) {\n            res.filter(obj => {\n              if (obj.bIsVideo) tabAllowed.push('video');\n              if (obj.bIsVoice) tabAllowed.push('voice');\n            });\n          }\n          this.videoWan = tabAllowed.includes('video');\n          this.voiceWan = tabAllowed.includes('voice');\n        }, err => {\n          this.loader1 = false;\n          this.videoWan = false;\n          this.voiceWan = false;\n        });\n      } else {\n        this.videoWan = false;\n        this.voiceWan = false;\n      }\n    }\n    /*getVideo(){\r\n      this.loader1=true;\r\n      this.dataChartService.getServiceVideo(this.orgId, this.serialNumberSelected).subscribe(\r\n        (data: any) => {\r\n          this.loader1=false;\r\n          localStorage.setItem('calix.videopermission',JSON.stringify('read'));\r\n          if(JSON.stringify(data.videoMulticastSystems.data) !== '{}' || JSON.stringify(data.wanInfo.data) !== '{}'){\r\n            this.showVideoService1 = true;\r\n            this.dataChartService.setVideo(data);\r\n          } else{\r\n            this.showVideoService1 = false;\r\n          }\r\n        } , err => {\r\n          this.showVideoService1 = false;\r\n          localStorage.setItem('calix.videopermission',JSON.stringify('error'));\r\n        }\r\n        )\r\n    }\r\n    getVoice(){\r\n      this.loader2=true;\r\n      this.dataChartService.getServiceVoice(this.orgId, this.serialNumberSelected).subscribe(\r\n      (data: any) => {\r\n        this.loader2=false;\r\n         localStorage.setItem('calix.voicepermission',JSON.stringify('read'))\r\n         //console.log('131',data.voiceStatus.data.length);\r\n         //console.log('94',data.wanInfo.data);\r\n          if(JSON.stringify(data.voiceStatus.data) !== '{}' || JSON.stringify(data.wanInfo.data) !== '{}'){\r\n            this.dataChartService.setVoice(data);\r\n            this.showVoiceService1 = true;\r\n          } else{\r\n            this.showVoiceService1 = false;\r\n          }\r\n        }, err => {\r\n          this.showVoiceService1 = false;\r\n          localStorage.setItem('calix.voicepermission',JSON.stringify('error'))\r\n        })\r\n    }*/\n    getMetaData() {\n      if (!this.serialNumberSelected) return;\n      this.loader1 = true;\n      this.dataChartService.fetchMetaData(this.orgId, this.serialNumberSelected).subscribe(res => {\n        this.loader1 = false;\n        this.metaData = res || {};\n        res.properties.forEach(obj => {\n          this.reStructureMeta(obj);\n        });\n        //console.log('343',this.metaData);\n        this.checkWanStatus();\n        this.dataChartService.setMetaData(this.serialNumberSelected, this.metaData);\n      }, err => {\n        this.loader1 = false;\n        //this.pageErrorHandle(err);\n      });\n    }\n\n    reStructureMeta(obj) {\n      this.metaData[obj.featureName.replace(/[.]/g, \"\")] = {};\n      if (obj.hasOwnProperty(\"fields\")) {\n        obj.fields.forEach(element => {\n          this.metaData[obj.featureName.replace(/[.]/g, \"\")][element.name.replace(/[.]/g, \"\")] = element;\n        });\n      } else if (obj.hasOwnProperty(\"configuration\")) {\n        this.metaData[obj.featureName.replace(/[.]/g, \"\")][\"config\"] = obj.configuration;\n      } else if (obj.hasOwnProperty(\"supported\")) {\n        this.metaData[obj.featureName.replace(/[.]/g, \"\")][\"supported\"] = obj.supported;\n      }\n    }\n    objectExistence(obj) {\n      return Object.keys(obj || {}).length;\n    }\n    ngOnDestroy() {\n      if (this.languageSubject) this.languageSubject.unsubscribe();\n    }\n  }\n  SupportServiceComponent.ɵfac = function SupportServiceComponent_Factory(t) {\n    return new (t || SupportServiceComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.TranslateService), i0.ɵɵdirectiveInject(i3.DataServiceService), i0.ɵɵdirectiveInject(i4.SsoAuthService));\n  };\n  SupportServiceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SupportServiceComponent,\n    selectors: [[\"app-support-service\"]],\n    decls: 16,\n    vars: 6,\n    consts: [[3, \"responseFromIssuse\"], [1, \"mr-2\"], [1, \"row\"], [1, \"col-md-12\", \"ccl-tabs\"], [\"id\", \"tabs\", 1, \"nav\", \"nav-tabs\"], [\"class\", \"nav-item\", \"id\", \"serviceDataTabId\", 4, \"ngIf\"], [\"class\", \"nav-item\", \"id\", \"serviceVideoTabId\", 4, \"ngIf\"], [\"id\", \"serviceVoiceTabId\", \"class\", \"nav-item\", 4, \"ngIf\"], [\"id\", \"serviceXdslTabId\", \"class\", \"nav-item\", 4, \"ngIf\"], [\"id\", \"tabsContent\", 1, \"tab-content\"], [\"id\", \"issue\", 1, \"tab-pane\", \"fade\", \"active\", \"show\"], [1, \"row\", \"pb-2\"], [\"id\", \"topology\", 1, \"tab-pane\", \"fade\"], [\"id\", \"serviceDataTabId\", 1, \"nav-item\"], [\"data-toggle\", \"tab\", \"routerLinkActive\", \"active\", 1, \"nav-link\", \"small\", 3, \"routerLink\", \"Click\"], [1, \"big-text\"], [\"id\", \"serviceVideoTabId\", 1, \"nav-item\"], [\"data-toggle\", \"tab\", \"routerLinkActive\", \"active\", 1, \"big-text\", \"nav-link\", \"small\", 3, \"routerLink\"], [\"id\", \"serviceVoiceTabId\", 1, \"nav-item\"], [\"data-toggle\", \"tab\", \"routerLinkActive\", \"active\", 1, \"nav-link\", \"small\", 3, \"routerLink\"], [\"id\", \"serviceXdslTabId\", 1, \"nav-item\"]],\n    template: function SupportServiceComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-subscriber-menu\", 0);\n        i0.ɵɵelementStart(1, \"section\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"ul\", 4);\n        i0.ɵɵtemplate(5, SupportServiceComponent_li_5_Template, 4, 2, \"li\", 5);\n        i0.ɵɵtemplate(6, SupportServiceComponent_li_6_Template, 4, 2, \"li\", 6);\n        i0.ɵɵtemplate(7, SupportServiceComponent_li_7_Template, 4, 2, \"li\", 7);\n        i0.ɵɵtemplate(8, SupportServiceComponent_li_8_Template, 4, 2, \"li\", 8);\n        i0.ɵɵtemplate(9, SupportServiceComponent_li_9_Template, 4, 2, \"li\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 9);\n        i0.ɵɵelementStart(11, \"div\", 10);\n        i0.ɵɵelement(12, \"div\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 12);\n        i0.ɵɵelement(14, \"div\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(15, \"router-outlet\");\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"responseFromIssuse\", ctx.apiCallDone);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.showDataService);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showVideoService && (ctx.objectExistence(ctx.metaData == null ? null : ctx.metaData.VideoMulticastSystems) || ctx.videoWan));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showVoiceService && (ctx.objectExistence(ctx.metaData == null ? null : ctx.metaData.VoiceStatus) || ctx.voiceWan));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.objectExistence(ctx.metaData == null ? null : ctx.metaData.XDSL));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.objectExistence(ctx.metaData == null ? null : ctx.metaData.GFAST));\n      }\n    },\n    directives: [i5.SubscriberMenuComponent, i6.NgIf, i1.RouterOutlet, i1.RouterLinkWithHref, i1.RouterLinkActive],\n    styles: [\".nav-tabs[_ngcontent-%COMP%]   .nav-item.show[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background-color:#fff;border-color:#dee2e6 #dee2e6 #fff;border:none;border-bottom:1px solid #2078fa}.nav-tabs[_ngcontent-%COMP%]{border-bottom:none}a[_ngcontent-%COMP%]{color:#333}.nav-link[_ngcontent-%COMP%]{font-size:18px;border-bottom:1px solid transparent;cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:focus, .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{border-color:#e9ecef #e9ecef #dee2e6;border:none;color:#4c4c4c;border-bottom:1px solid #9bc1f9}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4c4c4c}.nav-tabs[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{margin-bottom:-1px}.wan-dropdown[_ngcontent-%COMP%]{line-height:26px}\"]\n  });\n  return SupportServiceComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}