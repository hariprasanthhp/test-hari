{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i2 from \"../../services/mycommunity-iq.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app-services/translate.service\";\nimport * as i5 from \"../../services/common.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"angular-datatables\";\nfunction ConfirmUsersComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelementStart(1, \"div\", 6);\n    i0.ɵɵelementStart(2, \"div\", 7);\n    i0.ɵɵelementStart(3, \"span\", 8);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.language.Loading);\n  }\n}\nfunction ConfirmUsersComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵelementStart(1, \"span\", 10);\n    i0.ɵɵelement(2, \"img\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ConfirmUsersComponent_div_2_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.errorInfo = \"\";\n    });\n    i0.ɵɵelement(4, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"div\", 13);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"innerHtml\", ctx_r1.errorInfo, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction ConfirmUsersComponent_div_3_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵelementStart(1, \"div\", 30);\n    i0.ɵɵelement(2, \"img\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 32);\n    i0.ɵɵelementStart(4, \"h5\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6);\n    i0.ɵɵelementStart(7, \"p\", 33);\n    i0.ɵɵlistener(\"click\", function ConfirmUsersComponent_div_3_div_11_Template_p_click_7_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      const _r3 = i0.ɵɵreference(5);\n      return ctx_r14.openErrorsFoundModal(_r3);\n    });\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r9.language[\"Errors found in User Records CSV\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r9.language[\"Please correct the errors and re-upload the CSV file\"], \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\"\", ctx_r9.language[\"View\"], \" \", ctx_r9.missingvalues.length + ctx_r9.apiErrors.length, \" \", ctx_r9.language[\"errors\"], \"\");\n  }\n}\nfunction ConfirmUsersComponent_div_3_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 34);\n    i0.ɵɵelementStart(1, \"div\", 35);\n    i0.ɵɵelement(2, \"img\", 36);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 37);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate3(\" \", ctx_r10.language[\"Adding users to the communities specified in the CSV\"], \"... \", ctx_r10.getRoundedValue(ctx_r10.savedSubscribersCount / ctx_r10.userList.length * 100), \"% \", ctx_r10.language[\"complete\"], \" \");\n  }\n}\nfunction ConfirmUsersComponent_div_3_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 38);\n    i0.ɵɵelementStart(1, \"div\", 39);\n    i0.ɵɵelement(2, \"img\", 40);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 41);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r11.language[\"Users successfully added to the communities specified in the CSV\"], \". \");\n  }\n}\nfunction ConfirmUsersComponent_div_3_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵelementStart(1, \"div\", 30);\n    i0.ɵɵelement(2, \"img\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 32);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r12.language[\"The process for adding users to the communities has been stopped\"], \". \");\n  }\n}\nfunction ConfirmUsersComponent_div_3_tr_33_span_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const community_r19 = ctx.$implicit;\n    const j_r20 = ctx.index;\n    const user_r16 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", community_r19.communityName, \"\", user_r16.community.length - 1 !== j_r20 ? \", \" : \"\", \"\");\n  }\n}\nfunction ConfirmUsersComponent_div_3_tr_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵelement(2, \"img\", 42);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtemplate(10, ConfirmUsersComponent_div_3_tr_33_span_10_Template, 2, 2, \"span\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const user_r16 = ctx.$implicit;\n    const i_r17 = ctx.index;\n    const ctx_r13 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"../../../../assets/img/\", ctx_r13.statusIconInfo[i_r17] == \"success\" ? \"ic_test-success\" : ctx_r13.statusIconInfo[i_r17] == \"inprogress\" ? \"ic_progress-circle\" : \"warning-icon\", \".svg\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵproperty(\"hidden\", ctx_r13.errorFound(user_r16, i_r17) && !ctx_r13.statusIconInfo[i_r17] || ctx_r13.submissionStatus == \"stop\" && i_r17 === ctx_r13.savedSubscribersCount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r16.firstName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r16.lastName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r16.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", user_r16.community);\n  }\n}\nfunction ConfirmUsersComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵelementStart(1, \"div\", 15);\n    i0.ɵɵelementStart(2, \"div\", 16);\n    i0.ɵɵelementStart(3, \"div\", 17);\n    i0.ɵɵelementStart(4, \"div\", 18);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 19);\n    i0.ɵɵelementStart(7, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function ConfirmUsersComponent_div_3_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      const _r5 = i0.ɵɵreference(7);\n      return ctx_r22.submissionStatus == \"in progress\" ? ctx_r22.openStopUserPopup(_r5) : ctx_r22.goBack();\n    });\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function ConfirmUsersComponent_div_3_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r24 = i0.ɵɵnextContext();\n      return ctx_r24.submissionStatus == \"success\" || ctx_r24.submissionStatus == \"stop\" ? ctx_r24.goBack() : ctx_r24.saveUsers(true);\n    });\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, ConfirmUsersComponent_div_3_div_11_Template, 9, 5, \"div\", 22);\n    i0.ɵɵtemplate(12, ConfirmUsersComponent_div_3_div_12_Template, 5, 3, \"div\", 23);\n    i0.ɵɵtemplate(13, ConfirmUsersComponent_div_3_div_13_Template, 5, 1, \"div\", 24);\n    i0.ɵɵtemplate(14, ConfirmUsersComponent_div_3_div_14_Template, 5, 1, \"div\", 22);\n    i0.ɵɵelementStart(15, \"p\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 15);\n    i0.ɵɵelementStart(18, \"div\", 16);\n    i0.ɵɵelementStart(19, \"div\", 25);\n    i0.ɵɵelementStart(20, \"table\", 26);\n    i0.ɵɵelementStart(21, \"thead\");\n    i0.ɵɵelementStart(22, \"tr\");\n    i0.ɵɵelement(23, \"th\");\n    i0.ɵɵelementStart(24, \"th\");\n    i0.ɵɵtext(25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"th\");\n    i0.ɵɵtext(27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"th\", 27);\n    i0.ɵɵtext(29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"th\");\n    i0.ɵɵtext(31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"tbody\");\n    i0.ɵɵtemplate(33, ConfirmUsersComponent_div_3_tr_33_Template, 11, 6, \"tr\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r2.language[\"Confirm Users\"], \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r2.submissionStatus == \"stop\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r2.submissionStatus == \"in progress\" || ctx_r2.submissionStatus == \"stop\" ? ctx_r2.language[\"Stop\"] : ctx_r2.language[\"Cancel\"], \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", !ctx_r2.userList.length || ctx_r2.submissionStatus == \"in progress\" || ctx_r2.errorInAllLines);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.submissionStatus == \"in progress\" ? ctx_r2.language[\"Adding Users\"] + \"...\" : ctx_r2.submissionStatus == \"success\" || ctx_r2.submissionStatus == \"stop\" ? ctx_r2.language[\"Done\"] : ctx_r2.language[\"Confirm\"], \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.missingvalues.length);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.submissionStatus === \"in progress\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.submissionStatus === \"success\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.submissionStatus === \"stop\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.language[\"Access will be granted and a welcome email will be sent to the following users\"], \": \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"dtOptions\", ctx_r2.dtOptions);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r2.language[\"First Name\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.language[\"Last_Name\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.language[\"Email\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.language[\"Bsp_Microsite_Name\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.userList);\n  }\n}\nfunction ConfirmUsersComponent_ng_template_4_li_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"li\", 50);\n  }\n  if (rf & 2) {\n    const error_r26 = ctx.$implicit;\n    i0.ɵɵproperty(\"innerHTML\", error_r26, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction ConfirmUsersComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 43);\n    i0.ɵɵelementStart(1, \"div\", 44);\n    i0.ɵɵelementStart(2, \"h3\", 45);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 46);\n    i0.ɵɵlistener(\"click\", function ConfirmUsersComponent_ng_template_4_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return ctx_r27.close();\n    });\n    i0.ɵɵelement(5, \"span\", 47);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 48);\n    i0.ɵɵelementStart(7, \"p\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"ul\");\n    i0.ɵɵtemplate(10, ConfirmUsersComponent_ng_template_4_li_10_Template, 1, 1, \"li\", 49);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r4.missingvalues.length, \" \", ctx_r4.language[\"errors found\"], \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r4.language[\"Correct the following errors and re-upload the CSV file\"], \":\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.missingvalues);\n  }\n}\nfunction ConfirmUsersComponent_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r30 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 43);\n    i0.ɵɵelementStart(1, \"div\", 44);\n    i0.ɵɵelementStart(2, \"button\", 46);\n    i0.ɵɵlistener(\"click\", function ConfirmUsersComponent_ng_template_6_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r30);\n      const ctx_r29 = i0.ɵɵnextContext();\n      return ctx_r29.close();\n    });\n    i0.ɵɵelement(3, \"span\", 47);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 48);\n    i0.ɵɵelementStart(5, \"div\", 51);\n    i0.ɵɵelementStart(6, \"div\", 52);\n    i0.ɵɵelement(7, \"img\", 53);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 54);\n    i0.ɵɵelementStart(9, \"div\", 55);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"p\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 19);\n    i0.ɵɵelementStart(14, \"button\", 56);\n    i0.ɵɵlistener(\"click\", function ConfirmUsersComponent_ng_template_6_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r30);\n      const ctx_r31 = i0.ɵɵnextContext();\n      ctx_r31.submissionStatus = \"stop\";\n      return ctx_r31.close();\n    });\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"button\", 57);\n    i0.ɵɵlistener(\"click\", function ConfirmUsersComponent_ng_template_6_Template_button_click_16_listener() {\n      i0.ɵɵrestoreView(_r30);\n      const ctx_r32 = i0.ɵɵnextContext();\n      return ctx_r32.close();\n    });\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(10);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r6.language[\"Stop adding users\"], \"?\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r6.language[\"Only users that have successfully been added will be granted access\"], \".\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r6.language[\"Yes, stop adding users\"], \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r6.language[\"Cancel\"], \" \");\n  }\n}\nexport let ConfirmUsersComponent = /*#__PURE__*/(() => {\n  class ConfirmUsersComponent {\n    constructor(dialogService, myCommunityIqService, router, translateService, commonOrgService) {\n      this.dialogService = dialogService;\n      this.myCommunityIqService = myCommunityIqService;\n      this.router = router;\n      this.translateService = translateService;\n      this.commonOrgService = commonOrgService;\n      this._iDisplayStart = 0;\n      // Data Table Configurations\n      this.dtOptions = {\n        pagingType: 'full_numbers',\n        dom: 'tipr',\n        lengthChange: false,\n        pageLength: 10,\n        destroy: true,\n        processing: true,\n        // responsive: true,\n        columnDefs: [{\n          orderable: false,\n          targets: [0, 2, 4]\n        }, {\n          targets: [1, 3],\n          orderable: true\n        }],\n        order: [1, 'asc'],\n        drawCallback: settings => {\n          this._iDisplayStart = settings._iDisplayStart;\n          this.dataTableSetting = settings;\n          this.changeTableStatusLanguage(settings);\n          let total = settings.aoData.length;\n          let length = settings._iDisplayLength;\n          if (total <= length) {\n            $(settings.nTableWrapper).find(`#${settings.sTableId}_last`).addClass('disabled');\n          }\n        }\n      };\n      // For Storing All UserList From CSV File (userList)\n      this.userList = [];\n      // We Are Storing The Error Details to Below Variable (missingvalues)\n      this.missingvalues = [];\n      // Storing All The Subscriptions For Unsubscribe Them While Leaving The Page\n      this.subscriptions = [];\n      this.sortedColumnDetails = [];\n      this.apiErrors = [];\n      this.statusIconInfo = [];\n      this.microSiteList = [];\n      this.frTable = this.translateService.fr;\n      this.esTable = this.translateService.es;\n      this.de_DETable = this.translateService.de_DE;\n      this.orgId = localStorage.getItem('calix.org_id');\n    }\n    ngOnInit() {\n      this.language = this.translateService.defualtLanguage;\n      this.subscriptions.push(this.translateService.selectedLanguage.subscribe(data => {\n        this.language = data;\n        this.dtOptions.language = data;\n        const tempObj = {\n          _iDisplayStart: this.tableCounts.start,\n          _iDisplayLength: this.tableCounts.displayCount,\n          _iRecordsDisplay: this.tableCounts.displayed,\n          _iRecordsTotal: this.tableCounts.total,\n          oPreviousSearch: {\n            sSearch: this.tableCounts.searchText\n          }\n        };\n        this.changeTableStatusLanguage(tempObj);\n      }));\n      this.loader = true;\n      this.getMicroSites();\n      //getting value from user uploaded file\n    }\n\n    changeTableStatusLanguage(dtObj) {\n      const nf = new Intl.NumberFormat();\n      this.tableCounts = {\n        searchText: '',\n        total: dtObj._iRecordsTotal = this.rowcn,\n        displayCount: dtObj._iDisplayLength,\n        displayed: dtObj._iRecordsDisplay = this.rowcn,\n        start: dtObj._iDisplayStart\n      };\n      const isFrench = sessionStorage.getItem('defaultLanguage') == 'fr';\n      const isSpanish = sessionStorage.getItem('defaultLanguage') == 'es';\n      const isGermen = sessionStorage.getItem('defaultLanguage') == 'de_DE';\n      const filtered = `${dtObj._iRecordsTotal > 10000 && dtObj._iRecordsDisplay > 0 ? isFrench ? `(filtrées à partir des  ${nf.format(dtObj._iRecordsTotal)} entrées totales)<br/>` + '' : isSpanish ? `(filtrado de un total de ${nf.format(dtObj._iRecordsTotal)} entradas)<br/>` + '' : isGermen ? `(gefiltert aus  ${nf.format(dtObj._iRecordsTotal)} Einträgen)<br/>` + '' : `(filtered from  ${nf.format(dtObj._iRecordsTotal)} total entries)<br/>` + '' : ''}`;\n      const startCount = dtObj._iRecordsDisplay == 0 ? -1 : dtObj._iDisplayStart;\n      const showingCount = dtObj._iDisplayStart + dtObj._iDisplayLength > dtObj._iRecordsDisplay ? dtObj._iRecordsDisplay : dtObj._iDisplayStart + dtObj._iDisplayLength;\n      $('div [role=\"status\"]').html(isFrench ? `Affichage de ${nf.format(startCount + 1)} à ${nf.format(showingCount)} des  ${nf.format(dtObj._iRecordsDisplay)} entrées ${filtered}` : isSpanish ? `Se muestran del ${nf.format(startCount + 1)} al ${nf.format(showingCount)} de  ${nf.format(dtObj._iRecordsDisplay)} resultados ${filtered}` : isGermen ? `Angezeigt ${nf.format(startCount + 1)} bis ${nf.format(showingCount)} von  ${nf.format(dtObj._iRecordsDisplay)} ergebnissen ${filtered}` : `Showing ${nf.format(startCount + 1)} to ${nf.format(showingCount)} of  ${nf.format(dtObj._iRecordsDisplay)} entries ${filtered}`);\n      $(\".first\").text(isFrench ? 'Le début' : isSpanish ? 'Primero' : isGermen ? 'Erste Seite' : 'First');\n      $(\".previous\").text(isFrench ? 'Précédent' : isSpanish ? 'Anterior' : isGermen ? 'Zurück' : 'Previous');\n      $(\".next\").text(isFrench ? 'Suivant' : isSpanish ? 'Siguiente' : isGermen ? 'Weiter' : 'Next');\n      $(\".last\").text(isFrench ? 'Dernière' : isSpanish ? 'Último' : isGermen ? 'Letzte' : 'Last');\n    }\n    //Error model\n    openErrorsFoundModal(modal) {\n      this.findMissingValuesForErrorPopUp(this.userList);\n      this.dialogService.open(modal, {\n        size: 'xl',\n        centered: true,\n        windowClass: 'errors-found-modal'\n      });\n    }\n    //Stop model\n    openStopUserPopup(modal) {\n      // (this.submissionStatus = 'stop')\n      // this.findMissingValuesForErrorPopUp(this.userList);\n      this.dialogService.open(modal, {\n        size: 'xl',\n        centered: true,\n        windowClass: 'stop-user-modal'\n      });\n    }\n    // find the missing values\n    findMissingValuesForErrorPopUp(value) {\n      this.missingvalues = [];\n      value.forEach((e, i) => {\n        var _a, _b;\n        if (!e.firstName) {\n          this.missingvalues.push(`<b>Row ${i + 1}:</b> Empty value in “First Name” column`);\n          this.statusIconInfo[i] = 'error';\n        }\n        if (!e.lastName) {\n          this.missingvalues.push(`<b>Row ${i + 1}:</b> Empty value in “Last Name” column`);\n          this.statusIconInfo[i] = 'error';\n        }\n        if (!e.email) {\n          this.missingvalues.push(`<b>Row ${i + 1}:</b> Empty value in “Email” column`);\n          this.statusIconInfo[i] = 'error';\n        }\n        if (e.email && !/^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(e.email)) {\n          this.missingvalues.push(`<b>Row ${i + 1}:</b> Invalid email syntax`);\n          this.statusIconInfo[i] = 'error';\n        }\n        if (e.community.length > 8) {\n          this.missingvalues.push(`<b>Row ${i + 1}:</b> Subcriber can only have upto 8 communities`);\n        }\n        e.community = (_a = e.community) === null || _a === void 0 ? void 0 : _a.map(e => {\n          let value = this.microSiteList.find(m => m.communityName == e.communityName);\n          if (!value) {\n            this.missingvalues.push(`<b>Row ${i + 1}:</b> Community “${e.communityName}” is not available`);\n            this.statusIconInfo[i] = 'error';\n          }\n          return value ? {\n            micrositeId: value.id,\n            communityName: e.communityName\n          } : e;\n        });\n        if (!((_b = e.community) === null || _b === void 0 ? void 0 : _b.length)) {\n          this.statusIconInfo[i] = 'error';\n          this.missingvalues.push(`<b>Row ${i + 1}:</b> Empty value in “Community Name” column`);\n        }\n      });\n      this.missingvalues = this.missingvalues.concat(this.apiErrors).sort((a, b) => Number(a.match(/\\d+/)[0]) - Number(b.match(/\\d+/)[0]));\n      this.apiErrors = [];\n      this.errorInAllLines = value.every((e, i) => !this.errorFound(e, i));\n    }\n    //To Close POP UP Models\n    close() {\n      this.dialogService.dismissAll('Cross Click');\n    }\n    // Find any value missing in purticular row\n    errorFound(item, index) {\n      var _a;\n      return Object.values(item).filter(e => Array.isArray(e) ? e.length : e).length > 3 && /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(item.email) && ((_a = item === null || item === void 0 ? void 0 : item.community) === null || _a === void 0 ? void 0 : _a.every(c => this.microSiteList.some(e => e.communityName === c.communityName))) && (item === null || item === void 0 ? void 0 : item.community.length) <= 8;\n    }\n    // Save Users One By One\n    saveUsers(sort) {\n      if (sort) {\n        let index = --this.sortedColumnDetails[0];\n        let sortedKey = index == 0 ? 'firstName' : index == 2 ? 'email' : 'community';\n        let sortOrder = this.userList.map((e, i) => ({\n          value: e,\n          status: this.statusIconInfo[i]\n        })).sort(({\n          value: a\n        }, {\n          value: b\n        }) => {\n          let value = this.sortedColumnDetails[1] === 'asc' ? a[sortedKey].toString().localeCompare(b[sortedKey]) : b[sortedKey].toString().localeCompare(a[sortedKey]);\n          return value;\n        });\n        this.userList = sortOrder.map(e => e.value);\n        this.statusIconInfo = sortOrder.map(e => e.status);\n        this.submissionStatus = 'in progress';\n      }\n      if (this.savedSubscribersCount == undefined) {\n        this.savedSubscribersCount = 0;\n        this.statusIconInfo[this.savedSubscribersCount] = 'inprogress';\n      }\n      // Deep Copy\n      let value = JSON.parse(JSON.stringify(this.userList[this.savedSubscribersCount]));\n      if (!this.errorFound(value)) {\n        this.statusIconInfo[this.savedSubscribersCount] = 'error';\n        return this.recursionSaveUsers();\n      }\n      ;\n      this.subscriptions.push(this.myCommunityIqService.saveUsers(value, this.orgId).subscribe(res => {\n        console.log(res);\n        this.statusIconInfo[this.savedSubscribersCount] = 'success';\n        this.recursionSaveUsers();\n      }, err => {\n        this.apiErrors.push(`<b>Row ${this.savedSubscribersCount + 1}:</b> ${err.error.errorMessage}`);\n        this.statusIconInfo[this.savedSubscribersCount] = 'error';\n        this.recursionSaveUsers();\n        this.pageErrorHandle(err);\n      }));\n    }\n    pageErrorHandle(err) {\n      if (err.status == 401) {\n        this.errorInfo = this.language['Access Denied'];\n      } else {\n        this.errorInfo = this.commonOrgService.pageErrorHandle(err);\n      }\n    }\n    recursionSaveUsers() {\n      if (this.userList.length - 1 === this.savedSubscribersCount) {\n        this.submissionStatus = this.statusIconInfo.some(e => e === 'success') ? 'success' : 'stop';\n        this.close();\n      }\n      this.savedSubscribersCount++;\n      this.statusIconInfo[this.savedSubscribersCount] = 'inprogress';\n      if (this.submissionStatus == 'in progress') this.saveUsers();\n    }\n    // Navigating To Community-Users Listing Page\n    goBack() {\n      this.router.navigate(['/organization-admin/SmartTownWi-Fi/community-users']);\n    }\n    getMicroSites() {\n      this.subscriptions.push(this.myCommunityIqService.GetMicrosite().subscribe(res => {\n        this.microSiteList = res;\n        this.GetCSVValue();\n        this.loader = false;\n      }, err => {\n        this.loader = false;\n        this.pageErrorHandle(err);\n      }));\n    }\n    GetCSVValue() {\n      this.subscriptions.push(this.myCommunityIqService.communityListSubject.subscribe(res => {\n        this.rowcn = res.length;\n        console.log(\"length=\", this.rowcn);\n        this.statusIconInfo = Array.from({\n          length: res.length\n        }, () => '');\n        this.userList = res;\n        this.dtOptions.displayStart = this._iDisplayStart ? this._iDisplayStart : 0;\n        this.dtOptions.drawCallback = settings => {\n          this.sortedColumnDetails = settings.aaSorting.flat(1);\n          this._iDisplayStart = settings._iDisplayStart;\n          this.dataTableSetting = settings;\n          this.changeTableStatusLanguage(settings);\n          let total = settings.aoData.length;\n          let length = settings._iDisplayLength;\n          if (total <= length) {\n            $(settings.nTableWrapper).find(`#${settings.sTableId}_last`).addClass('disabled');\n          }\n        };\n        this.findMissingValuesForErrorPopUp(res);\n      }));\n    }\n    // reviceMissingErrorData(){\n    //   let index = --this.sortedColumnDetails[0];\n    //   let sortedKey = index == 0 ? 'firstName' : index == 2 ? 'email' : 'community';\n    //   let sortOrder = this.userList.map((e, i) => ({ value: e, status: this.statusIconInfo[i] })).sort(({ value: a }, { value: b }): number => {\n    //     let value = (this.sortedColumnDetails[1] === 'asc') ? (a[sortedKey].toString().localeCompare(b[sortedKey])) : (b[sortedKey].toString().localeCompare(a[sortedKey]));\n    //     return value\n    //   });\n    //   this.findMissingValuesForErrorPopUp(sortOrder);\n    // }\n    //Unsubscribing All Subscriptions To Prevent Memory Leak\n    ngOnDestroy() {\n      var _a;\n      (_a = this.subscriptions) === null || _a === void 0 ? void 0 : _a.forEach(e => e === null || e === void 0 ? void 0 : e.unsubscribe());\n    }\n    getRoundedValue(num) {\n      return Math.round(num);\n    }\n  }\n  ConfirmUsersComponent.ɵfac = function ConfirmUsersComponent_Factory(t) {\n    return new (t || ConfirmUsersComponent)(i0.ɵɵdirectiveInject(i1.NgbModal), i0.ɵɵdirectiveInject(i2.MycommunityIqService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.TranslateService), i0.ɵɵdirectiveInject(i5.CommonService));\n  };\n  ConfirmUsersComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ConfirmUsersComponent,\n    selectors: [[\"app-confirm-users\"]],\n    decls: 8,\n    vars: 3,\n    consts: [[\"class\", \"loader\", 4, \"ngIf\"], [\"class\", \"w-100 alert alert-danger  fade show my-3\", 4, \"ngIf\"], [\"class\", \"container\", 4, \"ngIf\"], [\"ErrorsFoundModal\", \"\"], [\"StopUserModal\", \"\"], [1, \"loader\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"spinner-border\", \"text-primary\"], [1, \"sr-only\"], [1, \"w-100\", \"alert\", \"alert-danger\", \"fade\", \"show\", \"my-3\"], [1, \"error-img\"], [\"src\", \"./assets/img/ic_error-36px.svg\"], [\"type\", \"button\", 1, \"close\", 3, \"click\"], [1, \"d-inline-flex\", 3, \"innerHtml\"], [1, \"container\"], [1, \"row\"], [1, \"col-md-12\"], [1, \"confirm-user-title-info\", \"d-flex\", \"justify-content-between\", \"align-items-end\"], [1, \"confirm-user-title\"], [1, \"\"], [\"type\", \"button\", \"data-toggle\", \"modal\", \"data-target\", \".bd-example-modal-lg\", 1, \"btn-default\", \"btn-dft\", \"py-1\", \"md-btn\", \"ml-1\", \"mr-3\", 3, \"disabled\", \"click\"], [\"id\", \"cancel-add-role\", 1, \"btn-default\", \"primary\", 3, \"disabled\", \"click\"], [\"class\", \"confirm-user-warning-info\", 4, \"ngIf\"], [\"class\", \"confirm-user-progress-box\", 4, \"ngIf\"], [\"class\", \"confirm-user-success-box\", 4, \"ngIf\"], [1, \"confirm-user-list\"], [\"datatable\", \"\", 3, \"dtOptions\"], [1, \"email-with\", \"text-break\"], [4, \"ngFor\", \"ngForOf\"], [1, \"confirm-user-warning-info\"], [1, \"warning-info-icon\"], [\"src\", \"../../../../assets/img/warning-icon.svg\", \"alt\", \"\"], [1, \"warning-info-content\"], [1, \"primary\", \"pointer\", 3, \"click\"], [1, \"confirm-user-progress-box\"], [1, \"progress-box-icon\"], [\"src\", \"../../../../assets/img/ic_progress-circle.svg\", \"alt\", \"\"], [1, \"progress-info-content\"], [1, \"confirm-user-success-box\"], [1, \"success-box-icon\"], [\"src\", \"../../../../assets/img/ic_success-circle-outline.svg\", \"alt\", \"\"], [1, \"success-info-content\"], [3, \"hidden\", \"src\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\"], [\"class\", \"list-styled-bullet\", 3, \"innerHTML\", 4, \"ngFor\", \"ngForOf\"], [1, \"list-styled-bullet\", 3, \"innerHTML\"], [1, \"d-flex\", \"w-100\", \"align-items-start\"], [1, \"w-10\", \"mr-2\"], [\"src\", \"../../../../assets/img/ic_warning-36px.svg\", \"alt\", \"\"], [1, \"w-90\", \"ml-2\"], [1, \"stop-user-sub-title\"], [\"id\", \"\", 1, \"btn-default\", \"primary\", 3, \"click\"], [\"type\", \"button\", 1, \"btn-default\", \"btn-dft\", \"py-1\", \"md-btn\", \"ml-1\", \"mr-3\", 3, \"click\"]],\n    template: function ConfirmUsersComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\");\n        i0.ɵɵtemplate(1, ConfirmUsersComponent_div_1_Template, 5, 1, \"div\", 0);\n        i0.ɵɵtemplate(2, ConfirmUsersComponent_div_2_Template, 6, 1, \"div\", 1);\n        i0.ɵɵtemplate(3, ConfirmUsersComponent_div_3_Template, 34, 16, \"div\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(4, ConfirmUsersComponent_ng_template_4_Template, 11, 4, \"ng-template\", null, 3, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(6, ConfirmUsersComponent_ng_template_6_Template, 18, 4, \"ng-template\", null, 4, i0.ɵɵtemplateRefExtractor);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loader);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorInfo);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.loader);\n      }\n    },\n    directives: [i6.NgIf, i7.DataTableDirective, i6.NgForOf],\n    styles: [\".confirm-user-title[_ngcontent-%COMP%]{font-weight:300;font-size:42px;line-height:53px}.confirm-user-title-info[_ngcontent-%COMP%]{border-bottom:2px solid #CCCCCC;padding-bottom:8px;align-items:end;margin-bottom:16px}.confirm-user-list[_ngcontent-%COMP%]{width:100%;margin-top:22px}.confirm-user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.confirm-user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #CCCCCC}.confirm-user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;font-size:16px;line-height:20px;color:#1a1f22;padding-bottom:7px}.confirm-user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:400;font-size:15px;line-height:24px;padding:7px 0}.confirm-user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px}.confirm-user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(6){margin-right:30px}.confirm-user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#f8f8fa}.confirm-user-warning-info[_ngcontent-%COMP%]{width:100%;background:#FFF8F5;border-radius:24px;padding:20px 24px;display:flex;margin-bottom:24px}.confirm-user-warning-info[_ngcontent-%COMP%]   .warning-info-icon[_ngcontent-%COMP%]{width:6%}.confirm-user-warning-info[_ngcontent-%COMP%]   .warning-info-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px}.confirm-user-warning-info[_ngcontent-%COMP%]   .warning-info-content[_ngcontent-%COMP%]{width:94%;font-weight:400;font-size:16px;line-height:20px}.confirm-user-warning-info[_ngcontent-%COMP%]   .warning-info-content[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-weight:400;font-size:24px;line-height:30px;color:#1a1f22}.confirm-user-warning-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:24px}.confirm-user-progress-box[_ngcontent-%COMP%]{background:#F5FAFF;border-radius:12px;padding:12px 20px;margin-bottom:24px;display:flex;align-items:center}.confirm-user-progress-box[_ngcontent-%COMP%]   .progress-box-icon[_ngcontent-%COMP%]{width:6%}.confirm-user-progress-box[_ngcontent-%COMP%]   .progress-box-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px}.confirm-user-progress-box[_ngcontent-%COMP%]   .progress-info-content[_ngcontent-%COMP%]{width:94%;font-weight:400;font-size:16px;line-height:20px}.confirm-user-success-box[_ngcontent-%COMP%]{background:#FAFFF5;border-radius:12px;padding:12px 20px;margin-bottom:24px;display:flex;align-items:center}.confirm-user-success-box[_ngcontent-%COMP%]   .success-box-icon[_ngcontent-%COMP%]{width:6%}.confirm-user-success-box[_ngcontent-%COMP%]   .success-box-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px}.confirm-user-success-box[_ngcontent-%COMP%]   .success-info-content[_ngcontent-%COMP%]{width:94%;font-weight:400;font-size:16px;line-height:20px}  .errors-found-modal .modal-content{background:#fff}  .errors-found-modal .modal-dialog{max-width:45.73%!important}  .stop-user-modal .modal-content{background:#FFF9F5}  .stop-user-modal .modal-dialog{max-width:35%!important}.stop-user-sub-title[_ngcontent-%COMP%]{font-weight:400;font-size:24px;line-height:30px}.email-with[_ngcontent-%COMP%]{min-width:180px;min-width:200px;word-break:break-all}.list-styled-bullet[_ngcontent-%COMP%]{list-style-type:disc;max-height:450px;overflow:auto}\"]\n  });\n  return ConfirmUsersComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}