{"ast":null,"code":"import { DataTableDirective } from 'angular-datatables';\nimport { Subject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app-services/translate.service\";\nimport * as i2 from \"../service/ccochart.service\";\nimport * as i3 from \"src/app/shared-utils/date-utils.service\";\nimport * as i4 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i5 from \"src/app/sys-admin/services/common.service\";\nimport * as i6 from \"src/app/support/shared/custom-pipes/shortnumber.pipe\";\nimport * as i7 from \"@angular/router\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"angular-datatables\";\nconst _c0 = [\"showTopONTs\"];\nfunction PonFsanComponent_ng_template_0_section_0_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵelementStart(1, \"div\", 22);\n    i0.ɵɵelementStart(2, \"div\", 23);\n    i0.ɵɵelementStart(3, \"span\", 24);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r5.language.Loading);\n  }\n}\nfunction PonFsanComponent_ng_template_0_section_0_tr_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\", 25);\n    i0.ɵɵelementStart(2, \"div\", 26);\n    i0.ɵɵelementStart(3, \"div\", 27);\n    i0.ɵɵelementStart(4, \"span\", 28);\n    i0.ɵɵelement(5, \"img\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function PonFsanComponent_ng_template_0_section_0_tr_30_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(3);\n      return ctx_r8.error = false;\n    });\n    i0.ɵɵelement(7, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"div\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"innerHtml\", ctx_r6.errorInfo, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction PonFsanComponent_ng_template_0_section_0_tr_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const data_r10 = ctx.$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(data_r10 == null ? null : data_r10.ontId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r7.AddTotalRate(data_r10 == null ? null : data_r10.ontUpstreamUsage == null ? null : data_r10.ontUpstreamUsage.rate, data_r10 == null ? null : data_r10.ontDownstreamUsage == null ? null : data_r10.ontDownstreamUsage.rate), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", (data_r10 == null ? null : data_r10.ontUpstreamUsage == null ? null : data_r10.ontUpstreamUsage.byteCount) + (data_r10 == null ? null : data_r10.ontDownstreamUsage == null ? null : data_r10.ontDownstreamUsage.byteCount), \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate((data_r10 == null ? null : data_r10.ontUpstreamUsage == null ? null : data_r10.ontUpstreamUsage.packetCount) + (data_r10 == null ? null : data_r10.ontDownstreamUsage == null ? null : data_r10.ontDownstreamUsage.packetCount));\n  }\n}\nfunction PonFsanComponent_ng_template_0_section_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"section\", 3);\n    i0.ɵɵelementStart(1, \"div\", 4);\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵelementStart(3, \"div\", 5);\n    i0.ɵɵelementStart(4, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function PonFsanComponent_ng_template_0_section_0_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return ctx_r12.GoBack();\n    });\n    i0.ɵɵelement(5, \"img\", 7);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function PonFsanComponent_ng_template_0_section_0_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return ctx_r14.close();\n    });\n    i0.ɵɵelement(8, \"span\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"h2\", 10);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\", 11);\n    i0.ɵɵelementStart(12, \"h3\", 12);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\", 13);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"table\", 14, 15);\n    i0.ɵɵelementStart(18, \"thead\", 16);\n    i0.ɵɵelementStart(19, \"tr\");\n    i0.ɵɵelementStart(20, \"th\", 17);\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"th\");\n    i0.ɵɵtext(23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"th\");\n    i0.ɵɵtext(25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"th\");\n    i0.ɵɵtext(27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(28, PonFsanComponent_ng_template_0_section_0_div_28_Template, 5, 1, \"div\", 18);\n    i0.ɵɵelementStart(29, \"tbody\");\n    i0.ɵɵtemplate(30, PonFsanComponent_ng_template_0_section_0_tr_30_Template, 9, 1, \"tr\", 19);\n    i0.ɵɵtemplate(31, PonFsanComponent_ng_template_0_section_0_tr_31_Template, 9, 4, \"tr\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.language[\"back\"], \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r3.interface, \" (\", ctx_r3.name, \")\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r3.language[\"Top 5 ONTs\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r3.language[\"Ranking based on upstream usage\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"dtOptions\", ctx_r3.dtOptionsONT)(\"dtTrigger\", ctx_r3.dtTrigger1);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r3.language[\"ONT_ID\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r3.language[\"Rate\"], \" (bps)\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r3.language[\"Total Octets\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r3.language[\"Total Packets\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.loading);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.error);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.TopONt);\n  }\n}\nfunction PonFsanComponent_ng_template_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, PonFsanComponent_ng_template_0_section_0_Template, 32, 14, \"section\", 2);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.topONTs);\n  }\n}\nexport let PonFsanComponent = /*#__PURE__*/(() => {\n  class PonFsanComponent {\n    constructor(translateService, ccochatservice, dateUtils, modalService, commonOrgService, ShortnumberPipe, router, route) {\n      this.translateService = translateService;\n      this.ccochatservice = ccochatservice;\n      this.dateUtils = dateUtils;\n      this.modalService = modalService;\n      this.commonOrgService = commonOrgService;\n      this.ShortnumberPipe = ShortnumberPipe;\n      this.router = router;\n      this.route = route;\n      this.dtTrigger1 = new Subject();\n      this.count = 0;\n      this.topONTs = false;\n      this.dtOptionsONT = {\n        info: false,\n        pageLength: 10,\n        lengthChange: false,\n        processing: false,\n        dom: 'tipr',\n        destroy: true,\n        columnDefs: [{\n          targets: [0, 1, 2],\n          orderable: false\n        }],\n        order: []\n      };\n      this.dtOptions = {\n        pagingType: 'full_numbers',\n        pageLength: 10,\n        lengthChange: false,\n        processing: false,\n        dom: 'tipr',\n        columnDefs: [{\n          targets: [1],\n          orderable: false\n        }],\n        order: [0, 'asc']\n      };\n    }\n    ngOnInit() {\n      this.language = this.translateService.defualtLanguage;\n      this.languageSubject = this.translateService.selectedLanguage.subscribe(data => {\n        this.language = data;\n      });\n      this.route.queryParams.subscribe(params => {\n        if (params['system']) {\n          this.system = params['system'];\n        }\n        if (params['interface']) {\n          this.interface = params['interface'];\n        }\n        if (params['name']) {\n          this.name = params['name'];\n        }\n      });\n      this.FromDate = Math.ceil((this.dateUtils.getStartUtcTimeByDaysseconds(0) - 86400000) / 1000);\n      this.showTopONTsModel(this.showTopONTs);\n    }\n    ngOnDestroy() {\n      if (this.languageSubject) {\n        this.languageSubject.unsubscribe();\n      }\n      if (this.dtsub) this.dtsub.unsubscribe();\n      if (this.totalcount) this.totalcount.unsubscribe();\n      this.dtTrigger1.unsubscribe();\n    }\n    rerender() {\n      var _a, _b;\n      (_b = (_a = this.datatableElement) === null || _a === void 0 ? void 0 : _a.dtInstance) === null || _b === void 0 ? void 0 : _b.then(dtInstance => {\n        var _a;\n        dtInstance === null || dtInstance === void 0 ? void 0 : dtInstance.destroy();\n        (_a = this.dtTrigger1) === null || _a === void 0 ? void 0 : _a.next();\n      });\n    }\n    close() {\n      if (this.modalRef) {\n        this.modalRef.close();\n      }\n      this.router.navigate(['/cco/health/pon-utilization/realtime']);\n    }\n    ngAfterViewInit() {\n      this.dtTrigger1.next();\n    }\n    GoBack() {\n      if (this.modalRef) {\n        this.modalRef.close();\n      }\n      this.topONTs = false;\n      this.router.navigate(['/cco/health/pon-utilization/ONT']);\n    }\n    countconvert(number) {\n      return this.ShortnumberPipe.transform(number, true, 5);\n    }\n    AddTotalRate(val1, val2) {\n      let val = val1.slice(-1);\n      let rate1 = parseFloat(val1);\n      let rate2 = parseFloat(val2);\n      let result = (rate1 + rate2).toFixed(3);\n      return `${result}${val}`;\n    }\n    showTopONTsModel(modal) {\n      this.loading = true;\n      this.topONTs = true;\n      this.ponCapacitytd = false;\n      this.ccochatservice.GetTop5ONTs(this.interface, this.system).subscribe(res => {\n        this.TopONt = res ? res : [];\n        //this.totalRate=parseInt(res?.ontUpstreamUsage?.rate) + parseInt(res?.ontDownstreamUsage?.rate) \n        if (this.tableFasn) {\n          this.rerender();\n        } else {\n          this.tableFasn = true;\n          this.dtTrigger1.next();\n        }\n        this.loading = false;\n      }, err => {\n        this.loading = false;\n        this.pageErrorHandle(err);\n      });\n      this.modalRef = this.modalService.open(modal, {\n        centered: true,\n        backdrop: 'static',\n        windowClass: 'vid-med-modal'\n      });\n    }\n    pageErrorHandle(err) {\n      this.error = true;\n      if (err.status == 401) {\n        this.errorInfo = this.language['Access Denied'];\n      } else {\n        this.errorInfo = this.commonOrgService.pageErrorHandle(err);\n      }\n      //this.closeAlert();  \n    }\n  }\n\n  PonFsanComponent.ɵfac = function PonFsanComponent_Factory(t) {\n    return new (t || PonFsanComponent)(i0.ɵɵdirectiveInject(i1.TranslateService), i0.ɵɵdirectiveInject(i2.CcochartService), i0.ɵɵdirectiveInject(i3.DateUtilsService), i0.ɵɵdirectiveInject(i4.NgbModal), i0.ɵɵdirectiveInject(i5.CommonService), i0.ɵɵdirectiveInject(i6.ShortnumberPipe), i0.ɵɵdirectiveInject(i7.Router), i0.ɵɵdirectiveInject(i7.ActivatedRoute));\n  };\n  PonFsanComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PonFsanComponent,\n    selectors: [[\"app-pon-fsan\"]],\n    viewQuery: function PonFsanComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n        i0.ɵɵviewQuery(DataTableDirective, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.showTopONTs = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.datatableElement = _t.first);\n      }\n    },\n    decls: 2,\n    vars: 0,\n    consts: [[\"class\", \"\"], [\"showTopONTs\", \"\"], [\"class\", \"modal-content\", 4, \"ngIf\"], [1, \"modal-content\"], [1, \"modal-header\", \"mb-3\"], [1, \"d-flex\", \"justify-content-between\", \"mb-3\"], [1, \"btn-default\", \"btn-dft\", \"mr-4\", 3, \"click\"], [\"src\", \"assets/img/ic_chevronleft_grey.svg\", \"alt\", \"\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-title\"], [1, \"modal-body\"], [1, \"user-name\"], [1, \"text-muted\", \"f-size-16px\", \"mb-2\"], [\"datatable\", \"\", 1, \"w-100\", \"border-bottom-none\", 3, \"dtOptions\", \"dtTrigger\"], [\"table2\", \"\"], [1, \"\"], [1, \"after-dnone\"], [\"class\", \"loader\", 4, \"ngIf\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [1, \"loader\"], [1, \"d-flex\", \"justify-content-center\"], [\"role\", \"\", 1, \"spinner-border\", \"text-primary\"], [1, \"sr-only\"], [\"colspan\", \"4\"], [1, \"row\"], [1, \"w-100\", \"alert\", \"alert-danger\", \"fade\", \"show\", \"my-3\"], [1, \"error-img\"], [\"src\", \"./assets/img/ic_error-36px.svg\"], [\"type\", \"button\", 1, \"close\", 3, \"click\"], [1, \"d-inline-flex\", 3, \"innerHtml\"]],\n    template: function PonFsanComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, PonFsanComponent_ng_template_0_Template, 1, 1, \"ng-template\", 0, 1, i0.ɵɵtemplateRefExtractor);\n      }\n    },\n    directives: [i8.NgIf, i9.DataTableDirective, i8.NgForOf],\n    styles: [\"\"]\n  });\n  return PonFsanComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}