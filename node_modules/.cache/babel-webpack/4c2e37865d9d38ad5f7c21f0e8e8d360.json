{"ast":null,"code":"import { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/platform-browser\";\nimport * as i2 from \"src/app/marketing/marketing-home/marketing-home-Apiservice\";\nimport * as i3 from \"src/app/shared/services/sso-auth.service\";\nimport * as i4 from \"src/app-services/translate.service\";\nimport * as i5 from \"@angular/common\";\nfunction MarketingCustomtabComponent_iframe_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"iframe\", 1);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"src\", ctx_r0.iframeUrl, i0.ɵɵsanitizeResourceUrl);\n  }\n}\nexport let MarketingCustomtabComponent = /*#__PURE__*/(() => {\n  class MarketingCustomtabComponent {\n    constructor(sanitizer, marketingHomeApiService, sso, translateService, titleService) {\n      this.sanitizer = sanitizer;\n      this.marketingHomeApiService = marketingHomeApiService;\n      this.sso = sso;\n      this.translateService = translateService;\n      this.titleService = titleService;\n      this.baseUrl_TS = `${environment.QLIK_TS_BASEURL}`;\n      this.Ts_TokenURL = `${environment.QLIK_TS_TOKEN_URL}`;\n      this.Ts_RedirectUrl = `${environment.QLIK_TS_REDIRECT}`;\n    }\n    ngOnInit() {\n      this.language = this.translateService.defualtLanguage;\n      this.languageSubject = this.translateService.selectedLanguage.subscribe(data => {\n        this.language = data;\n        this.titleService.setTitle(`Custom Tab - ${this.language[\"Explore_Data\"]}- ${this.language[\"Marketing_Cloud\"]}- ${this.language[\"Calix Cloud\"]}`);\n      });\n      if (this.language) {\n        this.titleService.setTitle(`Custom Tab - ${this.language[\"Explore_Data\"]}- ${this.language[\"Marketing_Cloud\"]}- ${this.language[\"Calix Cloud\"]}`);\n      }\n      this.qlikTicketURL();\n    }\n    qlikTicketURL() {\n      return new Promise((resolve, reject) => {\n        this.marketingHomeApiService.getTsAuthToken().subscribe(res => {}, err => {\n          let ticket = err.error.text ? err.error.text : '';\n          if (ticket.includes(\"~~\")) {\n            var stringArray = ticket.split(\"~~\");\n            this.ticketId = stringArray[0];\n            this.ticketIdUser = stringArray[1];\n          } else {\n            this.ticketId = ticket;\n            this.ticketIdUser = '';\n          }\n          if (this.ticketId) this.formFrameUrl();\n          resolve(err.error.text);\n          //this.getList();\n        });\n      });\n      // this.marketingHomeApiService.getTsAuthToken().subscribe((res: any) => {\n      //   this.ticketId = res ? res : '';\n      //   console.log(res,'res')\n      //   if (this.ticketId) this.formFrameUrl();\n      // })\n    }\n\n    formFrameUrl() {\n      this.iframeUrl = this.sanitizer.bypassSecurityTrustResourceUrl(`${this.baseUrl_TS}${this.Ts_TokenURL}?auth_token=${this.ticketId}&username=${this.ticketIdUser}&redirect_url=${this.Ts_RedirectUrl}/custom_dashboard`);\n    }\n  }\n  MarketingCustomtabComponent.ɵfac = function MarketingCustomtabComponent_Factory(t) {\n    return new (t || MarketingCustomtabComponent)(i0.ɵɵdirectiveInject(i1.DomSanitizer), i0.ɵɵdirectiveInject(i2.MarketingHomeApiService), i0.ɵɵdirectiveInject(i3.SsoAuthService), i0.ɵɵdirectiveInject(i4.TranslateService), i0.ɵɵdirectiveInject(i1.Title));\n  };\n  MarketingCustomtabComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MarketingCustomtabComponent,\n    selectors: [[\"app-marketing-customtab\"]],\n    inputs: {\n      segmentId: \"segmentId\"\n    },\n    decls: 1,\n    vars: 1,\n    consts: [[\"frameborder\", \"0\", \"width\", \"100%\", \"height\", \"100%\", \"style\", \"min-height: 1200px;\", 3, \"src\", 4, \"ngIf\"], [\"frameborder\", \"0\", \"width\", \"100%\", \"height\", \"100%\", 2, \"min-height\", \"1200px\", 3, \"src\"]],\n    template: function MarketingCustomtabComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, MarketingCustomtabComponent_iframe_0_Template, 1, 1, \"iframe\", 0);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.iframeUrl);\n      }\n    },\n    directives: [i5.NgIf],\n    styles: [\"\"]\n  });\n  return MarketingCustomtabComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}