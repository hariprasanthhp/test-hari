{"ast":null,"code":"import { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/common.service\";\nimport * as i2 from \"../services/organization-api.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app-services/translate.service\";\nimport * as i5 from \"src/app/shared/services/sso-auth.service\";\nimport * as i6 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i7 from \"@angular/platform-browser\";\nimport * as i8 from \"src/app/shared/services/common-functions.service\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"@angular/forms\";\nimport * as i11 from \"../../shared/directives/trim-space.directive\";\nconst _c0 = [\"deleteModal\"];\nconst _c1 = [\"infoModal\"];\nconst _c2 = [\"updateModal\"];\nconst _c3 = [\"errorModal\"];\nfunction SsoConfigurationComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵelementStart(1, \"div\", 23);\n    i0.ɵɵelementStart(2, \"div\", 24);\n    i0.ɵɵelementStart(3, \"span\", 25);\n    i0.ɵɵtext(4, \"Loading...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SsoConfigurationComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵelementStart(1, \"span\", 27);\n    i0.ɵɵelement(2, \"img\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_div_2_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.closeAlert();\n    });\n    i0.ɵɵelement(4, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"div\", 30);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"innerHtml\", ctx_r1.errorInfo, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction SsoConfigurationComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 31);\n    i0.ɵɵelementStart(1, \"div\", 32);\n    i0.ɵɵelementStart(2, \"div\", 33);\n    i0.ɵɵelement(3, \"img\", 34);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 35);\n    i0.ɵɵelement(5, \"span\", 36);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 37);\n    i0.ɵɵelementStart(7, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_div_3_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.closeAlert();\n    });\n    i0.ɵɵelement(8, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"innerHtml\", ctx_r2.successInfo, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction SsoConfigurationComponent_ng_template_46_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 38);\n    i0.ɵɵelementStart(1, \"h4\", 39);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 40);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_ng_template_46_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return ctx_r15.closeModal();\n    });\n    i0.ɵɵelement(4, \"span\", 41);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 42);\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 43);\n    i0.ɵɵelementStart(11, \"button\", 44);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_ng_template_46_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.confirmDeleteSecleted();\n    });\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"button\", 45);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_ng_template_46_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return ctx_r18.closeModal();\n    });\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r4.modalTitle);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r4.modalInfo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r4.modalInfocontent);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r4.language.yes);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r4.language.no);\n  }\n}\nfunction SsoConfigurationComponent_ng_template_48_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 38);\n    i0.ɵɵelementStart(1, \"h4\", 39);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 40);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_ng_template_48_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return ctx_r21.closeModal();\n    });\n    i0.ɵɵelement(4, \"span\", 41);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 42);\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 43);\n    i0.ɵɵelementStart(11, \"button\", 44);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_ng_template_48_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return ctx_r23.closeModal();\n    });\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r6.modalTitle);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r6.modalInfo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r6.modalInfocontent);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r6.language.ok);\n  }\n}\nfunction SsoConfigurationComponent_ng_template_50_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 38);\n    i0.ɵɵelementStart(1, \"h4\", 39);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 40);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_ng_template_50_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r26 = i0.ɵɵnextContext();\n      return ctx_r26.closeModal();\n    });\n    i0.ɵɵelement(4, \"span\", 41);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 42);\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 43);\n    i0.ɵɵelementStart(11, \"button\", 44);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_ng_template_50_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r28 = i0.ɵɵnextContext();\n      return ctx_r28.updateSSO();\n    });\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"button\", 45);\n    i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_ng_template_50_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r29 = i0.ɵɵnextContext();\n      return ctx_r29.closeModal();\n    });\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r8.modalTitle);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r8.modalInfo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r8.modalInfocontent);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r8.language.yes);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r8.language.no);\n  }\n}\nexport let SsoConfigurationComponent = /*#__PURE__*/(() => {\n  class SsoConfigurationComponent {\n    constructor(commonOrgService, organizationApiService, router,\n    // private customTranslateService: CustomTranslateService,\n    translateService, sso, dialogService, titleService, common) {\n      this.commonOrgService = commonOrgService;\n      this.organizationApiService = organizationApiService;\n      this.router = router;\n      this.translateService = translateService;\n      this.sso = sso;\n      this.dialogService = dialogService;\n      this.titleService = titleService;\n      this.common = common;\n      this.pageAvailable = false;\n      this.formError = false;\n      this.add = {\n        _id: \"\",\n        domain: \"\",\n        orgId: \"\",\n        type: \"saml\",\n        config: {\n          sp_options: {\n            entity_id: \"https://cloud-stg.calix.com/sso-metadata\",\n            assert_endpoint: \"https://cloud-stg.calix.com/sso-acs?samlid=nEtmrw7czte5eDmv4\"\n          },\n          idp_options: {\n            sso_login_url: \"\",\n            sso_logout_url: \"\",\n            certificates: \"\"\n          }\n        }\n      };\n      this.languages = [{\n        name: \"English\"\n      }, {\n        name: \"French Canadian\"\n      }];\n      this.errorTitle = '';\n      this.errorBody = '';\n      this.loading = true;\n      let url = this.router.url;\n      this.ORG_ID = this.sso.getOrganizationID(url);\n      this.commonOrgService.currentPageAdder('sso');\n      this.orgData = JSON.parse(sessionStorage.getItem('calixAdminOrgDetail'));\n      this.getHostData();\n      this.MODULE = this.sso.getRedirectModule(url);\n    }\n    ngOnInit() {\n      this.language = this.translateService.defualtLanguage;\n      if (this.language) {\n        this.pageAvailable = true;\n      }\n      this.translateSubscribe = this.translateService.selectedLanguage.subscribe(data => {\n        this.language = data;\n        this.titleService.setTitle(`${this.language['ssoconfig']} - ${this.MODULE === 'systemAdministration' ? this.language['System Administration'] : this.language['administration']} - ${this.language['Calix Cloud']}`);\n      });\n      this.titleService.setTitle(`${this.language['ssoconfig']} - ${this.MODULE === 'systemAdministration' ? this.language['System Administration'] : this.language['administration']} - ${this.language['Calix Cloud']}`);\n      this.success = false;\n      this.error = false;\n      this.logoutFieldHide = true;\n      this.reset();\n      //this.getSSOConfigData();\n    }\n\n    ngOnDestroy() {\n      if (this.translateSubscribe) {\n        this.translateSubscribe.unsubscribe();\n      }\n      if (this.getConfigSubs) {\n        this.getConfigSubs.unsubscribe();\n      }\n      if (this.ssoUpdateSubs) {\n        this.ssoUpdateSubs.unsubscribe();\n      }\n      if (this.ssoAddSubs) {\n        this.ssoAddSubs.unsubscribe();\n      }\n      if (this.ssoDeleteSubs) {\n        this.ssoDeleteSubs.unsubscribe();\n      }\n    }\n    getHostData() {\n      this.organizationApiService.GetHostData('assets/config/config.json').subscribe(res => {\n        this.HOSTDATA = res;\n        this.getSSOConfigData();\n      });\n    }\n    getSSOConfigData() {\n      this.getConfigSubs = this.organizationApiService.SSOConfigGet(this.ORG_ID).subscribe(res => {\n        if (res && typeof res == 'object' && res._id != undefined) {\n          this.SSOconfigData = res;\n          this.configId = res._id;\n          this.entity = this.SSOconfigData.config.sp_options.entity_id ? this.SSOconfigData.config.sp_options.entity_id : '';\n          this.acs = this.SSOconfigData.config.sp_options.assert_endpoint ? this.SSOconfigData.config.sp_options.assert_endpoint : '';\n          this.emaildomainname = this.SSOconfigData.domain;\n          this.idp = this.SSOconfigData.config.idp_options.certificates;\n          this.ssologin = this.SSOconfigData.config.idp_options.sso_login_url;\n          this.ssologout = this.SSOconfigData.config.idp_options.sso_logout_url;\n          this.deletebuttonDisabled = false;\n          this.savebuttonDisabled = true;\n          this.loading = false;\n        } else {\n          this.showDefaultData();\n        }\n      }, err => {\n        this.deletebuttonDisabled = true;\n        this.showDefaultData();\n        if (err.status != 404) {\n          this.pageErrorHandle(err);\n        }\n      }, () => {\n        setTimeout(() => {\n          this.loading = false;\n        }, 1000);\n      });\n    }\n    showDefaultData() {\n      //this.domain = window.location.origin ? window.location.origin : `https://cloud-dev.calix.com`;\n      this.domain = this.HOSTDATA.apiURL ? this.HOSTDATA.apiURL : environment['SSO_API_URL'];\n      this.generatedId = this.makeid(17);\n      this.entity = `${this.domain}/sso-metadata`;\n      if (this.HOSTDATA.isCAInstance) {\n        this.acs = `${this.domain}/v1/authentication/samlcacallback?samlid=${this.generatedId}`;\n      } else {\n        this.acs = `${this.domain}/v1/authentication/samlcallback?samlid=${this.generatedId}`;\n      }\n      this.loading = false;\n    }\n    makeid(length) {\n      var result = '';\n      var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n      var charactersLength = characters.length;\n      for (var i = 0; i < length; i++) {\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\n      }\n      return result;\n    }\n    uuidv4() {\n      return 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = Math.random() * 16 | 0,\n          v = c == 'x' ? r : r & 0x3 | 0x8;\n        return v.toString(16);\n      });\n    }\n    save() {\n      if (this.configId) {\n        this.updateConfirmModal();\n      } else {\n        this.addSSO();\n      }\n    }\n    updateConfirmModal() {\n      this.modalInfocontent = undefined;\n      if (this.emaildomainname == undefined || this.emaildomainname == '' || !this.validateDomain(this.emaildomainname)) {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['Domain Name Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.idp == undefined || this.idp.trim() == '') {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['Certificate Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.ssologin == undefined || this.ssologin.trim() == '' || !this.validateURL(this.ssologin.trim())) {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['SSO Login URL Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.ssologout == undefined || this.ssologout.trim() == '') {\n        // || !this.validateURL(this.ssologout.trim())\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['SSO Logout URL Not Valid'];\n        this.openErrorModal();\n        return;\n      }\n      this.modalTitle = this.language['Warning'];\n      this.modalInfo = this.language['Current SSO settings will be overwritten.'];\n      this.modalInfocontent = this.language['Are you sure you want to continue?'];\n      this.openUpdateModal();\n    }\n    updateSSO() {\n      if (this.emaildomainname == undefined || this.emaildomainname == '' || !this.validateDomain(this.emaildomainname)) {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['Domain Name Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.idp == undefined || this.idp.trim() == '') {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['Certificate Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.ssologin == undefined || this.ssologin.trim() == '' || !this.validateURL(this.ssologin.trim())) {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['SSO Login URL Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.ssologout == undefined || this.ssologout.trim() == '') {\n        // || !this.validateURL(this.ssologout.trim())\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['SSO Logout URL Not Valid'];\n        this.openErrorModal();\n        return;\n      }\n      let params = this.add;\n      params._id = this.configId;\n      params.orgId = this.ORG_ID;\n      params.type = \"saml\";\n      if (this.SSOconfigData && this.SSOconfigData.config.sp_options) {\n        params.config.sp_options.entity_id = this.SSOconfigData.config.sp_options.entity_id;\n        params.config.sp_options.assert_endpoint = this.SSOconfigData.config.sp_options.assert_endpoint;\n      } else {\n        params.config.sp_options.entity_id = this.entity;\n        params.config.sp_options.assert_endpoint = this.acs;\n      }\n      // params.config.sp_options.entity_id = this.entity;\n      // params.config.sp_options.assert_endpoint = this.acs;\n      params.domain = this.emaildomainname;\n      params.config.idp_options.certificates = this.idp;\n      params.config.idp_options.sso_login_url = this.ssologin;\n      params.config.idp_options.sso_logout_url = this.ssologout;\n      this.loading = true;\n      this.closeModal();\n      this.ssoUpdateSubs = this.organizationApiService.SSOConfigUpdate(params, this.configId).subscribe(json => {\n        this.closeAlert();\n        this.successInfo = this.language['SSO Configuration Updated Successfully'];\n        this.success = true;\n        this.loading = false;\n        this.commonOrgService.pageScrollTop();\n        setTimeout(() => {\n          this.closeAlert();\n        }, 2500);\n        this.getSSOConfigData();\n      }, err => {\n        this.pageErrorHandle(err);\n        this.loading = false;\n      });\n    }\n    // ** Update SSO configuration Field ** //\n    addSSO() {\n      let params = this.add;\n      if (this.emaildomainname == undefined || this.emaildomainname == '' || !this.validateDomain(this.emaildomainname)) {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['Domain Name Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.idp == undefined || this.idp.trim() == '') {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['Certificate Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.ssologin == undefined || this.ssologin.trim() == '' || !this.validateURL(this.ssologin.trim())) {\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['SSO Login URL Not Valid'];\n        this.openErrorModal();\n        return;\n      } else if (this.ssologout == undefined || this.ssologout.trim() == '') {\n        // || !this.validateURL(this.ssologout.trim())\n        this.modalTitle = this.language['Error'];\n        this.modalInfo = this.language['SSO Logout URL Not Valid'];\n        this.openErrorModal();\n        return;\n      } else {\n        params._id = this.generatedId;\n        params.orgId = this.ORG_ID;\n        params.type = \"saml\";\n        if (this.SSOconfigData && this.SSOconfigData.config.sp_options) {\n          params.config.sp_options.entity_id = this.SSOconfigData.config.sp_options.entity_id;\n          params.config.sp_options.assert_endpoint = this.SSOconfigData.config.sp_options.assert_endpoint;\n        } else {\n          params.config.sp_options.entity_id = this.entity;\n          params.config.sp_options.assert_endpoint = this.acs;\n        }\n        params.domain = this.emaildomainname;\n        params.config.idp_options.certificates = this.idp;\n        params.config.idp_options.sso_login_url = this.ssologin;\n        params.config.idp_options.sso_logout_url = this.ssologout;\n        this.loading = true;\n        this.closeModal();\n        this.ssoAddSubs = this.organizationApiService.SSOConfigAdd(params).subscribe(json => {\n          this.closeAlert();\n          this.successInfo = this.language['SSO Configuration added Successfully'];\n          this.success = true;\n          this.loading = false;\n          this.commonOrgService.pageScrollTop();\n          setTimeout(() => {\n            this.closeAlert();\n          }, 2500);\n          this.getSSOConfigData();\n        }, err => {\n          this.pageErrorHandle(err);\n          this.loading = false;\n        });\n      }\n    }\n    on_ChangeInput() {\n      if (this.emaildomainname != undefined && this.emaildomainname.length || this.idp != undefined && this.idp.length || this.ssologin != undefined && this.ssologin.length || this.ssologout != undefined && this.ssologout.length) {\n        this.savebuttonDisabled = false;\n      } else {\n        this.savebuttonDisabled = true;\n      }\n    }\n    domainChange() {\n      if (this.SSOconfigData == undefined) {\n        this.on_ChangeInput();\n      } else {\n        if (this.emaildomainname == this.SSOconfigData.domain) {\n          this.savebuttonDisabled = true;\n        } else {\n          this.savebuttonDisabled = false;\n        }\n      }\n    }\n    idpChange() {\n      if (this.SSOconfigData == undefined) {\n        this.on_ChangeInput();\n      } else {\n        if (this.idp == this.SSOconfigData.config.idp_options.certificates) {\n          this.savebuttonDisabled = true;\n        } else {\n          this.savebuttonDisabled = false;\n        }\n      }\n    }\n    ssoLoginChange() {\n      if (this.SSOconfigData == undefined) {\n        this.on_ChangeInput();\n      } else {\n        if (this.ssologin == this.SSOconfigData.config.idp_options.sso_login_url) {\n          this.savebuttonDisabled = true;\n        } else {\n          this.savebuttonDisabled = false;\n        }\n      }\n    }\n    ssoLogoutChange() {\n      if (this.SSOconfigData == undefined) {\n        this.on_ChangeInput();\n      } else {\n        if (this.ssologout == this.SSOconfigData.config.idp_options.sso_logout_url) {\n          this.savebuttonDisabled = true;\n        } else {\n          this.savebuttonDisabled = false;\n        }\n      }\n    }\n    // ** Delete SSO Page Info Starts** //\n    deleteSSOinfo() {\n      this.modalTitle = this.language['Warning'];\n      this.modalInfo = this.language['Current SSO settings will be deleted.'];\n      this.modalInfocontent = this.language['Are you sure you want to continue?'];\n      this.openDeleteModal();\n    }\n    confirmDeleteSecleted() {\n      if (this.configId == undefined) {\n        return;\n      }\n      this.loading = true;\n      this.closeModal();\n      this.ssoDeleteSubs = this.organizationApiService.SSOConfigDelete(this.configId).subscribe(json => {\n        this.closeAlert();\n        this.successInfo = this.language['SSO Configuration Deleted Successfully'];\n        this.success = true;\n        this.loading = false;\n        this.commonOrgService.pageScrollTop();\n        setTimeout(() => {\n          this.closeAlert();\n        }, 2500);\n        this.reset();\n        this.getSSOConfigData();\n      }, err => {\n        this.pageErrorHandle(err);\n        this.loading = false;\n      });\n    }\n    // ** Delete SSO Page Info Ends ** //\n    reset() {\n      this.entity = '';\n      this.acs = '';\n      this.emaildomainname = \"\";\n      this.idp = \"\";\n      this.ssologin = \"\";\n      this.ssologout = \"\";\n      this.SSOconfigData = undefined;\n      this.configId = undefined;\n      this.savebuttonDisabled = true;\n      this.deletebuttonDisabled = true;\n    }\n    closeAlert() {\n      this.error = false;\n      this.success = false;\n    }\n    languageChange(language) {\n      sessionStorage.setItem('defaultLanguage', language);\n      this.translateService.changeLanguage(language);\n    }\n    openDeleteModal() {\n      this.closeModal();\n      this.modalRef = this.dialogService.open(this.deleteModal, {\n        backdrop: 'static',\n        keyboard: false\n      });\n    }\n    openUpdateModal() {\n      this.closeModal();\n      this.modalRef = this.dialogService.open(this.updateModal, {\n        backdrop: 'static',\n        keyboard: false\n      });\n    }\n    openErrorModal() {\n      this.closeModal();\n      this.modalRef = this.dialogService.open(this.infoModal, {\n        backdrop: 'static',\n        keyboard: false\n      });\n    }\n    validateDomain(str) {\n      //return /^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,}$/.test(str);\n      return /(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/ig.test(str) && this.notEndsWithDot(str); // to fix CCL-39315\n    }\n\n    validateURL(str) {\n      return /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/.test(str);\n    }\n    closeModal() {\n      if (this.modalRef) {\n        this.modalRef.close();\n      }\n    }\n    pageErrorHandle(err) {\n      if (err.status == 401) {\n        this.errorInfo = this.language['Access Denied'];\n      } else {\n        this.errorInfo = this.commonOrgService.pageErrorHandle(err);\n      }\n      this.closeAlert();\n      this.error = true;\n      this.commonOrgService.pageScrollTop();\n    }\n    notEndsWithDot(str) {\n      str = str ? str.trim() : '';\n      if (str && str.length > 1 && str.substring(str.length - 1, str.length) !== '.') {\n        return true;\n      }\n      return false;\n    }\n    removeUnwantedSpace(input, value) {\n      this[input] = this.common.trimSpaceFromNonObjectInputs(value);\n    }\n  }\n  SsoConfigurationComponent.ɵfac = function SsoConfigurationComponent_Factory(t) {\n    return new (t || SsoConfigurationComponent)(i0.ɵɵdirectiveInject(i1.CommonService), i0.ɵɵdirectiveInject(i2.OrganizationApiService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.TranslateService), i0.ɵɵdirectiveInject(i5.SsoAuthService), i0.ɵɵdirectiveInject(i6.NgbModal), i0.ɵɵdirectiveInject(i7.Title), i0.ɵɵdirectiveInject(i8.CommonFunctionsService));\n  };\n  SsoConfigurationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SsoConfigurationComponent,\n    selectors: [[\"app-sso-configuration\"]],\n    viewQuery: function SsoConfigurationComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n        i0.ɵɵviewQuery(_c1, 7);\n        i0.ɵɵviewQuery(_c2, 7);\n        i0.ɵɵviewQuery(_c3, 7);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.deleteModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.infoModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.updateModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.errorModal = _t.first);\n      }\n    },\n    decls: 52,\n    vars: 20,\n    consts: [[1, \"container\", \"position-relative\"], [\"class\", \"loader\", 4, \"ngIf\"], [\"class\", \"w-100 alert alert-danger  fade show\", 4, \"ngIf\"], [\"class\", \"w-100 alert alert-success fade show\", 4, \"ngIf\"], [1, \"row\", \"mb-1\"], [1, \"col-md-12\", \"ccl-title\"], [1, \"row\", \"mb-3\"], [1, \"col-md-12\", \"ccl-form\"], [\"type\", \"text\", \"readonly\", \"\", \"name\", \"entity\", \"value\", \"\", \"id\", \"entity\", \"autocomplete\", \"new-password\", 1, \"\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"acs\", \"readonly\", \"\", \"value\", \"\", \"id\", \"acs\", \"autocomplete\", \"new-password\", 1, \"\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"emaildomainname\", \"id\", \"emaildomainname\", \"autocomplete\", \"new-password\", \"trimSpace\", \"\", 1, \"\", 3, \"ngModel\", \"placeholder\", \"keyup\", \"ngModelChange\", \"blur\"], [1, \"col-md-12\"], [\"name\", \"idp\", \"rows\", \"3\", \"id\", \"idp\", \"trimSpace\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"keyup\", \"blur\"], [\"type\", \"text\", \"name\", \"ssologin\", \"placeholder\", \"\", \"id\", \"ssologin\", \"autocomplete\", \"new-password\", \"trimSpace\", \"\", 1, \"\", 3, \"ngModel\", \"keyup\", \"ngModelChange\", \"blur\"], [\"type\", \"text\", \"name\", \"ssologout\", \"placeholder\", \"\", \"id\", \"ssologout\", \"autocomplete\", \"new-password\", \"trimSpace\", \"\", 1, \"\", 3, \"ngModel\", \"keyup\", \"ngModelChange\", \"blur\"], [1, \"row\"], [1, \"col-md-12\", \"text-right\"], [\"type\", \"submit\", 1, \"btn-default\", \"primary\", \"mr-3\", 3, \"disabled\", \"click\"], [\"type\", \"submit\", 1, \"btn-default\", \"primary\", 3, \"disabled\", \"click\"], [\"deleteModal\", \"\"], [\"infoModal\", \"\"], [\"updateModal\", \"\"], [1, \"loader\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"spinner-border\", \"text-primary\"], [1, \"sr-only\"], [1, \"w-100\", \"alert\", \"alert-danger\", \"fade\", \"show\"], [1, \"error-img\"], [\"src\", \"./assets/img/ic_error-36px.svg\"], [\"type\", \"button\", 1, \"close\", 3, \"click\"], [1, \"d-inline-flex\", 3, \"innerHtml\"], [1, \"w-100\", \"alert\", \"alert-success\", \"fade\", \"show\"], [1, \"success-alert-wrapper\"], [1, \"success-alert-icon\"], [\"src\", \"../../../assets/img/success-icon.svg\", \"alt\", \"\"], [1, \"success-alert-msg\"], [3, \"innerHtml\"], [1, \"success-alert-close\"], [1, \"modal-header\"], [\"id\", \"modal-basic-title\", 1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn-default\", \"primary\", \"px-3\", 3, \"click\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn-default\", \"btn-dft\", \"py-1\", \"px-3\", 3, \"click\"]],\n    template: function SsoConfigurationComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, SsoConfigurationComponent_div_1_Template, 5, 0, \"div\", 1);\n        i0.ɵɵtemplate(2, SsoConfigurationComponent_div_2_Template, 6, 1, \"div\", 2);\n        i0.ɵɵtemplate(3, SsoConfigurationComponent_div_3_Template, 9, 1, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵtext(6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 6);\n        i0.ɵɵelementStart(8, \"div\", 7);\n        i0.ɵɵelementStart(9, \"input\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function SsoConfigurationComponent_Template_input_ngModelChange_9_listener($event) {\n          return ctx.entity = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 4);\n        i0.ɵɵelementStart(11, \"div\", 5);\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 6);\n        i0.ɵɵelementStart(14, \"div\", 7);\n        i0.ɵɵelementStart(15, \"input\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function SsoConfigurationComponent_Template_input_ngModelChange_15_listener($event) {\n          return ctx.acs = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 4);\n        i0.ɵɵelementStart(17, \"div\", 5);\n        i0.ɵɵtext(18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 6);\n        i0.ɵɵelementStart(20, \"div\", 7);\n        i0.ɵɵelementStart(21, \"input\", 10);\n        i0.ɵɵlistener(\"keyup\", function SsoConfigurationComponent_Template_input_keyup_21_listener() {\n          return ctx.domainChange();\n        })(\"ngModelChange\", function SsoConfigurationComponent_Template_input_ngModelChange_21_listener($event) {\n          return ctx.emaildomainname = $event;\n        })(\"blur\", function SsoConfigurationComponent_Template_input_blur_21_listener() {\n          return ctx.removeUnwantedSpace(\"emaildomainname\", ctx.emaildomainname);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 4);\n        i0.ɵɵelementStart(23, \"div\", 5);\n        i0.ɵɵtext(24);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 6);\n        i0.ɵɵelementStart(26, \"div\", 11);\n        i0.ɵɵelementStart(27, \"textarea\", 12);\n        i0.ɵɵlistener(\"ngModelChange\", function SsoConfigurationComponent_Template_textarea_ngModelChange_27_listener($event) {\n          return ctx.idp = $event;\n        })(\"keyup\", function SsoConfigurationComponent_Template_textarea_keyup_27_listener() {\n          return ctx.idpChange();\n        })(\"blur\", function SsoConfigurationComponent_Template_textarea_blur_27_listener() {\n          return ctx.removeUnwantedSpace(\"idp\", ctx.idp);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"div\", 4);\n        i0.ɵɵelementStart(29, \"div\", 5);\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"div\", 6);\n        i0.ɵɵelementStart(32, \"div\", 7);\n        i0.ɵɵelementStart(33, \"input\", 13);\n        i0.ɵɵlistener(\"keyup\", function SsoConfigurationComponent_Template_input_keyup_33_listener() {\n          return ctx.ssoLoginChange();\n        })(\"ngModelChange\", function SsoConfigurationComponent_Template_input_ngModelChange_33_listener($event) {\n          return ctx.ssologin = $event;\n        })(\"blur\", function SsoConfigurationComponent_Template_input_blur_33_listener() {\n          return ctx.removeUnwantedSpace(\"ssologin\", ctx.ssologin);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"div\", 4);\n        i0.ɵɵelementStart(35, \"div\", 5);\n        i0.ɵɵtext(36);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"div\", 6);\n        i0.ɵɵelementStart(38, \"div\", 7);\n        i0.ɵɵelementStart(39, \"input\", 14);\n        i0.ɵɵlistener(\"keyup\", function SsoConfigurationComponent_Template_input_keyup_39_listener() {\n          return ctx.ssoLogoutChange();\n        })(\"ngModelChange\", function SsoConfigurationComponent_Template_input_ngModelChange_39_listener($event) {\n          return ctx.ssologout = $event;\n        })(\"blur\", function SsoConfigurationComponent_Template_input_blur_39_listener() {\n          return ctx.removeUnwantedSpace(\"ssologout\", ctx.ssologout);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"div\", 15);\n        i0.ɵɵelementStart(41, \"div\", 16);\n        i0.ɵɵelementStart(42, \"button\", 17);\n        i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_Template_button_click_42_listener() {\n          return ctx.save();\n        });\n        i0.ɵɵtext(43);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(44, \"button\", 18);\n        i0.ɵɵlistener(\"click\", function SsoConfigurationComponent_Template_button_click_44_listener() {\n          return ctx.deleteSSOinfo();\n        });\n        i0.ɵɵtext(45);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(46, SsoConfigurationComponent_ng_template_46_Template, 15, 5, \"ng-template\", null, 19, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(48, SsoConfigurationComponent_ng_template_48_Template, 13, 4, \"ng-template\", null, 20, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(50, SsoConfigurationComponent_ng_template_50_Template, 15, 5, \"ng-template\", null, 21, i0.ɵɵtemplateRefExtractor);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.error);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.success);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.language.entityID);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.entity);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\", ctx.language.acs, \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.acs);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.language.emaildomainname);\n        i0.ɵɵadvance(3);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.language.domainnametext);\n        i0.ɵɵproperty(\"ngModel\", ctx.emaildomainname);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.language.idp);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.idp);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.language.ssologin);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.ssologin);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.language.ssologout);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.ssologout);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", ctx.savebuttonDisabled);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.language[\"saveEnregistrer\"]);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"disabled\", ctx.deletebuttonDisabled);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.language.delete);\n      }\n    },\n    directives: [i9.NgIf, i10.DefaultValueAccessor, i10.NgControlStatus, i10.NgModel, i11.TrimSpaceDirective],\n    styles: [\"\"]\n  });\n  return SsoConfigurationComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}